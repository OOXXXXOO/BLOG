<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>leap motion  core asstet 2.3 full analyse | Winshare</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
  <meta name="keywords" content="Gesture tracking" />
  
  
  
  
  <meta name="description" content="本系列文章将会从一个初学者的脚步去讲解unity和leapmotion协同开发的一系列问题：  基础   环境搭建  场景创建    核心组件使用   sdk使用   脚本编写与功能实现方法   代码优化   UI交互部分">
<meta name="keywords" content="Gesture tracking">
<meta property="og:type" content="article">
<meta property="og:title" content="LEAP MOTION  Core Asstet 2.3 Full Analyse">
<meta property="og:url" content="http://winshare.tech/2017/05/06/LEAP2.3_Core_analyse/index.html">
<meta property="og:site_name" content="Winshare">
<meta property="og:description" content="本系列文章将会从一个初学者的脚步去讲解unity和leapmotion协同开发的一系列问题：  基础   环境搭建  场景创建    核心组件使用   sdk使用   脚本编写与功能实现方法   代码优化   UI交互部分">
<meta property="og:image" content="https://developer-china-cdn.leapmotion.com/documentation/images/Leap_horizontalViewAngle.png">
<meta property="og:image" content="http://img.blog.csdn.net/20151129160059249">
<meta property="og:image" content="http://img.blog.csdn.net/20151129160123533">
<meta property="og:image" content="http://img.blog.csdn.net/20151129160203161">
<meta property="og:image" content="http://img.blog.csdn.net/20151129160217473">
<meta property="og:image" content="http://img.blog.csdn.net/20151129160240349">
<meta property="og:image" content="http://img.blog.csdn.net/20151208181219171">
<meta property="og:image" content="http://img.blog.csdn.net/20151208181853700">
<meta property="og:image" content="http://img.blog.csdn.net/20151208182959282">
<meta property="og:image" content="http://img.blog.csdn.net/20151208183056443">
<meta property="og:image" content="http://img.blog.csdn.net/20151208201852420">
<meta property="og:image" content="http://img.blog.csdn.net/20151208205029247">
<meta property="og:image" content="http://img.blog.csdn.net/20151208210218188">
<meta property="og:image" content="http://img.blog.csdn.net/20151208212129717">
<meta property="og:image" content="http://img.blog.csdn.net/20151208212213463">
<meta property="og:image" content="http://img.blog.csdn.net/20151224151423578">
<meta property="og:image" content="http://img.blog.csdn.net/20151224152016075">
<meta property="og:image" content="http://img.blog.csdn.net/20151224152031781">
<meta property="og:image" content="http://img.blog.csdn.net/20151224152220792">
<meta property="og:image" content="http://img.blog.csdn.net/20151224160816739">
<meta property="og:image" content="http://img.blog.csdn.net/20151224161330716">
<meta property="og:image" content="http://img.blog.csdn.net/20151224174029066">
<meta property="og:image" content="http://img.blog.csdn.net/20151224174830116">
<meta property="og:image" content="http://img.blog.csdn.net/20151224181508995">
<meta property="og:image" content="http://img.blog.csdn.net/20151224182317587">
<meta property="og:image" content="http://img.blog.csdn.net/20160402140510351">
<meta property="og:image" content="http://img.blog.csdn.net/20160402143737067">
<meta property="og:image" content="http://img.blog.csdn.net/20160402144717758">
<meta property="og:image" content="http://img.blog.csdn.net/20160402145227994">
<meta property="og:image" content="http://img.blog.csdn.net/20160402150248795">
<meta property="og:image" content="http://img.blog.csdn.net/20160402201855668">
<meta property="og:image" content="http://img.blog.csdn.net/20160402202048263">
<meta property="og:image" content="http://img.blog.csdn.net/20160402204623538">
<meta property="og:image" content="http://img.blog.csdn.net/20160404172408789">
<meta property="og:image" content="http://img.blog.csdn.net/20160404173501246">
<meta property="og:image" content="http://img.blog.csdn.net/20160406123735485">
<meta property="og:image" content="http://img.blog.csdn.net/20160406132608755">
<meta property="og:image" content="http://img.blog.csdn.net/20160406135032436">
<meta property="og:image" content="http://img.blog.csdn.net/20160406135603454">
<meta property="og:image" content="http://img.blog.csdn.net/20160406141206710">
<meta property="og:image" content="http://img.blog.csdn.net/20160406142121526">
<meta property="og:image" content="http://img.blog.csdn.net/20160406144504223">
<meta property="og:image" content="http://img.blog.csdn.net/20160518152045320">
<meta property="og:image" content="http://img.blog.csdn.net/20160518153740720">
<meta property="og:image" content="http://img.blog.csdn.net/20160518155344160">
<meta property="og:image" content="http://img.blog.csdn.net/20160518155625164">
<meta property="og:image" content="http://img.blog.csdn.net/20160518160830061">
<meta property="og:image" content="http://img.blog.csdn.net/20160518161600190">
<meta property="og:image" content="http://img.blog.csdn.net/20160518164452635">
<meta property="og:image" content="http://img.blog.csdn.net/20160518164514982">
<meta property="og:image" content="http://img.blog.csdn.net/20160518171954133">
<meta property="og:image" content="http://img.blog.csdn.net/20160518172424139">
<meta property="og:image" content="http://img.blog.csdn.net/20160518172803520">
<meta property="og:image" content="http://img.blog.csdn.net/20160518173715723">
<meta property="og:image" content="http://img.blog.csdn.net/20160518181646115">
<meta property="og:image" content="http://img.blog.csdn.net/20160518182537164">
<meta property="og:updated_time" content="2017-11-25T14:08:50.642Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="LEAP MOTION  Core Asstet 2.3 Full Analyse">
<meta name="twitter:description" content="本系列文章将会从一个初学者的脚步去讲解unity和leapmotion协同开发的一系列问题：  基础   环境搭建  场景创建    核心组件使用   sdk使用   脚本编写与功能实现方法   代码优化   UI交互部分">
<meta name="twitter:image" content="https://developer-china-cdn.leapmotion.com/documentation/images/Leap_horizontalViewAngle.png">
  
    <link rel="alternate" href="/atom.xml" title="Winshare" type="application/atom+xml">
  

  

  <link rel="icon" href="/css/images/mylogo.jpg">
  <link rel="apple-touch-icon" href="/css/images/mylogo.jpg">
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link href="https://fonts.googleapis.com/css?family=Open+Sans|Montserrat:700" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Roboto:400,300,300italic,400italic" rel="stylesheet" type="text/css">
  <link href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">
  <style type="text/css">
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/9749f0/00000000000000000001008f/27/l?subset_id=2&fvd=n5) format("woff2");font-weight:500;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/90cf9f/000000000000000000010091/27/l?subset_id=2&fvd=n7) format("woff2");font-weight:500;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/8a5494/000000000000000000013365/27/l?subset_id=2&fvd=n4) format("woff2");font-weight:lighter;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/d337d8/000000000000000000010095/27/l?subset_id=2&fvd=i4) format("woff2");font-weight:400;font-style:italic;}</style>
  <link rel="stylesheet" href="/css/style.css">

  <script src="/js/jquery-3.1.1.min.js"></script>
  <script src="/js/bootstrap.js"></script>

  <!-- Bootstrap core CSS -->
  <link rel="stylesheet" href="/css/bootstrap.css" >

  
    <link rel="stylesheet" href="/css/dialog.css">
  

  

  
    <link rel="stylesheet" href="/css/header-post.css" >
  

  
  
  

</head>



  <body data-spy="scroll" data-target="#toc" data-offset="50">


  
  <div id="container">
    <div id="wrap">
      
        <header>

    <div id="allheader" class="navbar navbar-default navbar-static-top" role="navigation">
        <div class="navbar-inner">
          
          <div class="container"> 
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
              <span class="sr-only">Toggle navigation</span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>

            
              <a class="brand" style="
                 margin-top: 0px;"  
                href="#" data-toggle="modal" data-target="#myModal" >
                  <img width="124px" height="124px" alt="Hike News" src="/css/images/mylogo.jpg">
              </a>
            
            
            <div class="navbar-collapse collapse">
              <ul class="hnav navbar-nav">
                
                  <li> <a class="main-nav-link" href="/">首页</a> </li>
                
                  <li> <a class="main-nav-link" href="/archives">归档</a> </li>
                
                  <li> <a class="main-nav-link" href="/categories">分类</a> </li>
                
                  <li> <a class="main-nav-link" href="/tags">标签</a> </li>
                
                  <li> <a class="main-nav-link" href="/about">关于</a> </li>
                
                  <li><div id="search-form-wrap">

    <form class="search-form">
        <input type="text" class="ins-search-input search-form-input" placeholder="" />
        <button type="submit" class="search-form-submit"></button>
    </form>
    <div class="ins-search">
    <div class="ins-search-mask"></div>
    <div class="ins-search-container">
        <div class="ins-input-wrapper">
            <input type="text" class="ins-search-input" placeholder="请输入关键词..." />
            <span class="ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: '文章',
            PAGES: '页面',
            CATEGORIES: '分类',
            TAGS: '标签',
            UNTITLED: '(无标题)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>
<script src="/js/insight.js"></script>

</div></li>
            </div>
          </div>
                
      </div>
    </div>

</header>



      
            
      <div id="content" class="outer">
        
          <section id="main" style="float:none;"><article id="post-LEAP2.3_Core_analyse" style="width: 75%; float:left;" class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" class="article-title" itemprop="name">
      LEAP MOTION  Core Asstet 2.3 Full Analyse
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2017/05/06/LEAP2.3_Core_analyse/" class="article-date">
	  <time datetime="2017-05-06T10:44:48.247Z" itemprop="datePublished">2017-05-06</time>
	</a>

      
      
	<a class="article-views">
	<span id="busuanzi_container_page_pv">
		阅读量<span id="busuanzi_value_page_pv"></span>
	</span>
	</a>

    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="本系列文章将会从一个初学者的脚步去讲解unity和leapmotion协同开发的一系列问题："><a href="#本系列文章将会从一个初学者的脚步去讲解unity和leapmotion协同开发的一系列问题：" class="headerlink" title="本系列文章将会从一个初学者的脚步去讲解unity和leapmotion协同开发的一系列问题："></a>本系列文章将会从一个初学者的脚步去讲解unity和leapmotion协同开发的一系列问题：</h3><hr>
<ul>
<li><a href="http://blog.csdn.net/admintan/article/details/49980029" target="_blank" rel="external">基础</a></li>
</ul>
<ul>
<li><p><a href="http://blog.csdn.net/admintan/article/details/50097061" target="_blank" rel="external">环境搭建</a></p>
</li>
<li><p><a href="#3">场景创建</a></p>
</li>
</ul>
<ul>
<li><a href="#4">核心组件使用</a></li>
</ul>
<ul>
<li><a href="#5">sdk使用</a></li>
</ul>
<ul>
<li><a href="#6">脚本编写与功能实现方法</a></li>
</ul>
<ul>
<li><a href="#7">代码优化</a></li>
</ul>
<ul>
<li><a href="#8">UI交互部分</a></li>
</ul>
<hr>
<a id="more"></a>
<blockquote>
<p>特：本人水平有限所以有错误请指正<br>本人也会引用一些代码  如果有所侵犯请联系删除</p>
<p>自2015.11.22开始周更</p>
</blockquote>
<h2 id="第一部分基-基础"><a href="#第一部分基-基础" class="headerlink" title="第一部分基-基础"></a>第一部分基-基础</h2><p>首先，关于leapmotion 我想会看此类文章的应该都知道这是什么，无关将来这个产品的发展会如何，它作为虚拟现实或现实增强开发的练手是非常合适的。因为他有着非常舒适的开发环境，简单而成熟的SDK。最最重要的是结合unity/unreal，更是一种让你能在短时间之内通过引擎完成高质量手势识别应用的方法。</p>
<p>关于原理，和底层算法，因为代码封装完善，你根本不可能窥探到什么（当然肯定有人可以）。所以我的评价仅仅从实际效果出发先对leapmotion做出一个评价。</p>
<p><strong>下图为leapmotion传感器的识别区域：</strong></p>
<p><img src="https://developer-china-cdn.leapmotion.com/documentation/images/Leap_horizontalViewAngle.png" alt="识别"></p>
<p>我们可以看到在y轴也就是高度上  leapmotion的识别距离真的是小的可怜（根据我实际测试不会超过50cm）也就是说如果不和其他硬件搭配<br>leapmotion的使用范围很窄</p>
<p>单单的桌面使用的话，基本没有什么实用价值原因有二：</p>
<p>1.桌面使用场景下，手势识别很累低效</p>
<p>2.leap仅仅依靠景深画面和算法得出的手势识别精度高，但是精确度差。也就是说可以识别你手势动作很微小的变化，但是对这些变化的呈现又表现出很大的偏差。</p>
<p>在和oculus dk2结合之后，leapmotion的实用性总算提高了一些，但是效果仍然不理想。</p>
<p>因此，后续leap在不推出新硬件的条件下，我十分不看好这个传感器的发展，未来的leap，要么被OVR等厂家收购，要么倒闭。</p>
<p><strong>ok 有点跑题，绕回来。虽然他这不好那不好，但这是我们在市场上能获取到的最优秀的性价比最高的手势识别设备。以他和oculus来学习虚拟现实开发，是最合适不过的了</strong></p>
<p><strong>那废话说够了，开始吧</strong></p>
<h1 id="first-基础"><a href="#first-基础" class="headerlink" title="first  基础"></a>first  基础</h1><hr>
<p>准备阶段：</p>
<p><a href="https://developer.leapmotion.com/getting-started/unity" title="start" target="_blank" rel="external">https://developer.leapmotion.com/getting-started/unity</a></p>
<p>当然是download everything<em>_</em><br>准备工具包括:</p>
<p>unity（最好5.0以上版本）</p>
<p><a href="http://unity3d.com/cn/get-unity/download" title="unity 下载" target="_blank" rel="external">http://unity3d.com/cn/get-unity/download</a></p>
<p>leapmotion应用&amp;SDK</p>
<p><a href="https://developer.leapmotion.com/" title="leap" target="_blank" rel="external">https://developer.leapmotion.com/</a></p>
<p>leapmotion unity core asset</p>
<p><a href="https://developer.leapmotion.com/downloads/unity" title="coreasset" target="_blank" rel="external">https://developer.leapmotion.com/downloads/unity</a><br>（有朋友反应找不到leap core asset2.3下载地址在<a href="http://pan.baidu.com/s/1mifDTos" target="_blank" rel="external">这里</a>）</p>
<p>以上下载完毕之后接入leap使用visualizer检视和利用控制面板校准的过程我就不再赘述了，都有详细的引导。</p>
<p>那么既然是unity开发，c#自然是非常合适的了。所以对于刚刚接触unity的同学。了解unity的构成，以及c#脚本语言是非常重要的。</p>
<p>但是相比起来c#脚本教学可就多了去了，因此我只是做归纳总结。不作深入探究</p>
<p><strong>下面我们简单的从leap的视角来看看unity/c#的一些特性：</strong></p>
<p>头文件篇：</p>
<pre><code>using UnityEngine;
using System.Collections;
using System;
using Leap;
</code></pre><p>命名空间类似其他语言中的库，所有脚本代码都要写在命名空间的类中。命名空间leap就是整个leapmotion脚本运作的核心。但是这和传统的c#有一些不同，例如在vs环境中的c#新建后<br>会产生以下引用：</p>
<pre><code>using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
</code></pre><p>从两段引用中我们也可以看出，c#语言在库上和某些早期的语言思路不太一致。至于详细的应用我们会在以后的更新中完整的介绍</p>
<p>正式代码篇：</p>
<p>unity：</p>
<pre><code>public class NewBehaviourScript : MonoBehaviour {


//初始化函数，在游戏开始时系统自动调用。一般用来创建变量之类的东西。
void Awake () {

}
// 在所有Update函数前系统自动条用。一般用来给变量赋值。
void Start () {

}

// 每帧调用一次
void Update () {

}

//固定时间间隔调用一次
void FixedUpdate（）
{

}

//每一个Update执行之后执行一次

void LateUpdate（）
{

}

}
</code></pre><p>vs：</p>
<pre><code>namespace ConsoleApplication1
{
class Program
{
    static void Main(string[] args)//相当于c++中等main函数
    {
       //____code___//
    }
}
}
</code></pre><p>我们看到 vs中需要自己定义命名空间  再以类的形式组织代码<br>而unity cs中只能继承于 MonoBehaviour这个命名空间，至于mono~是一种框架，鉴于初学贴的定位我们就不深入了。在此原则之下，只要没有碰到的C#script和传统的c#的区别我就一概不讲了。以免喧宾夺主。</p>
<p><strong>至于unity的界面以及使用的教程有人写的水平比我高很多于是我就转载啦：</strong></p>
<p><a href="http://www.cnblogs.com/fortomorrow/archive/2012/10/28/unity01.html" title="莫拓柔" target="_blank" rel="external">http://www.cnblogs.com/fortomorrow/archive/2012/10/28/unity01.html</a></p>
<p>总的来说，如果你有其他面对对象语言的基础。那么学习c#的成本将会非常低。如果你以前熟悉javascript/java，那么C#特性的异同在大多数情况下甚至可以忽略。</p>
<p>unity开发如果对实现效果不是极为苛刻那么开发的效率是非常高的。</p>
<p><strong>如果你是个初学者，我会贴一段代码供大家熟悉c#特性的代码。供大家调试，修改。当然这些特性很多不会直接出现在脚本的编写中，但熟悉他们对于初学者来说对之后的工作有着非常大的好处</strong></p>
<p>：</p>
<p>1.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">using System;</div><div class="line">using System.Collections.Generic;</div><div class="line">using System.Linq;</div><div class="line">using System.Text;</div><div class="line"></div><div class="line">namespace _11</div><div class="line">&#123;</div><div class="line">class Program</div><div class="line">&#123;</div><div class="line">    static void Main(string[] args)</div><div class="line">    &#123;</div><div class="line">        Person p1 = new Person();</div><div class="line">        p1.Hello();</div><div class="line">        p1.Age = 21;</div><div class="line">        p1.Name =&quot;Kungge&quot;;</div><div class="line">        //p1.Nickname = &quot;Dogegg&quot;;// 注意这个外部不能使用</div><div class="line">        Console.WriteLine(p1.Name );</div><div class="line">        //p1.Hello2();//这个外部也不可使用</div><div class="line">        p1.GiveNn(&quot;Gumzhep&quot;);</div><div class="line">        Console.ReadKey();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    class Person</div><div class="line">    &#123;</div><div class="line">        public int Age;</div><div class="line">        public string Name;</div><div class="line">        private string Nickname;</div><div class="line"></div><div class="line">        public void GiveNn(string nickname)</div><div class="line">        &#123;</div><div class="line">            if (nickname == &quot;Dogegg&quot;)</div><div class="line">            &#123;</div><div class="line">                return;</div><div class="line">            &#125;</div><div class="line">            this.Nickname = nickname;</div><div class="line">        &#125;</div><div class="line">        private void Hello2()</div><div class="line">        &#123;</div><div class="line"></div><div class="line">        &#125;</div><div class="line">        public void Hello()</div><div class="line">        &#123;</div><div class="line">            Console.WriteLine(&quot;HelloWorld&quot;);</div><div class="line">            Console.WriteLine(&quot;&#123;0&#125; &#123;1&#125; &#123;2&#125;&quot;,this.Age,this.Name,this.Nickname);//this.是我自己的</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>2.属性：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div></pre></td><td class="code"><pre><div class="line">using System;</div><div class="line">using System.Collections.Generic;</div><div class="line">using System.Linq;</div><div class="line">using System.Text;</div><div class="line"></div><div class="line">namespace _11</div><div class="line">&#123;</div><div class="line">class Program</div><div class="line">&#123;</div><div class="line">    static void Main(string[] args)</div><div class="line">    &#123;</div><div class="line">        Person p = new Person();</div><div class="line">        p.Age = 20;</div><div class="line">        Console.WriteLine(p.Age);</div><div class="line">        p.Age = -1;//非法值 无用</div><div class="line">        Console.WriteLine(p.Age);</div><div class="line"></div><div class="line">        p.Nage = 20;</div><div class="line">        Console.WriteLine(p.Nage);</div><div class="line"></div><div class="line">        /*p.Dage = 20;</div><div class="line">        Console.WriteLine(p.Dage );*/</div><div class="line">        //这将出现死循环</div><div class="line"></div><div class="line">       /* Person2 p2 = new Person2();</div><div class="line">        p2.Age = 20;//其是只读的</div><div class="line">        Console.WriteLine(p2 .Age);*/</div><div class="line"></div><div class="line">        Person3 p3 = new Person3();</div><div class="line">        p3.Age = 21;</div><div class="line">        Console.WriteLine(p3.Age);</div><div class="line">        Console.ReadKey();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    class Person</div><div class="line">    &#123;</div><div class="line">        private int age;</div><div class="line">        public int Age</div><div class="line">        &#123;</div><div class="line">            set//set用来赋值</div><div class="line">            &#123;</div><div class="line">                if (value &lt; 0)//public字段和属性的区别 ：属性可以进行非法设置值的判断</div><div class="line">                &#123;</div><div class="line">                    return;</div><div class="line">                &#125;</div><div class="line">                this.age = value;//value是用户赋过来的值</div><div class="line">            &#125;</div><div class="line">            get//get用来取值</div><div class="line">            &#123;</div><div class="line">                return this.age;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        private int nage;</div><div class="line">        public int Nage</div><div class="line">        &#123;</div><div class="line">            set</div><div class="line">            &#123;</div><div class="line">                this.nage = value;</div><div class="line">            &#125;</div><div class="line">            get</div><div class="line">            &#123;</div><div class="line">                return 18;//返回值是多少就是多少</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        private int dage;</div><div class="line">        public int Dage</div><div class="line">        &#123;</div><div class="line">            set</div><div class="line">            &#123;</div><div class="line">                this.Dage = value;//将出现死循环</div><div class="line"></div><div class="line">            &#125;</div><div class="line">            get</div><div class="line">            &#123;</div><div class="line">                return this.Dage;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">   /* class Person2</div><div class="line">    &#123;</div><div class="line">        public int Age</div><div class="line">        &#123;</div><div class="line">            get//这是只读的</div><div class="line">            &#123;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;*/</div><div class="line">    class Person3</div><div class="line">    &#123;</div><div class="line">        public int Age//编译器自动生成私有字段和set get代码块</div><div class="line">        &#123;</div><div class="line">            get;</div><div class="line">            set;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>3.练习一：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">using System;</div><div class="line">using System.Collections.Generic;</div><div class="line">using System.Linq;</div><div class="line">using System.Text;</div><div class="line"></div><div class="line">namespace _11</div><div class="line">&#123;</div><div class="line">class Program</div><div class="line">&#123;</div><div class="line">    static void Main(string[] args)</div><div class="line">    &#123;</div><div class="line">        Robot r1 = new Robot();</div><div class="line">        r1.Name = &quot;K1&quot;;</div><div class="line">        Robot r2 = new Robot();</div><div class="line">        r2.Name = &quot;K2&quot;;</div><div class="line">        Robot r;</div><div class="line">        Console.WriteLine(&quot;请选择1：r1,2:r2&quot;);</div><div class="line">        string s = Console.ReadLine();</div><div class="line">        if (s == &quot;1&quot;)</div><div class="line">        &#123;</div><div class="line">            r = r1;</div><div class="line">        &#125;</div><div class="line">        else</div><div class="line">        &#123;</div><div class="line">            r = r2;</div><div class="line">        &#125;</div><div class="line">        Console.WriteLine(&quot;Hello,I&apos;m robot.&quot;);</div><div class="line">        r.Eat(5);</div><div class="line">        while (true)</div><div class="line">        &#123;</div><div class="line">            string str = Console.ReadLine();</div><div class="line">            r.Speak(str);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        Console.ReadKey();</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">class Robot</div><div class="line">&#123;</div><div class="line">    public string Name &#123; set; get; &#125;</div><div class="line">    private int full &#123; set; get; &#125;</div><div class="line">    public void SayHello()</div><div class="line">    &#123;</div><div class="line">        Console.WriteLine(&quot;Hello,my name is &#123;0&#125;&quot;, Name);</div><div class="line">    &#125;</div><div class="line">    public void Speak(string str)</div><div class="line">    &#123;</div><div class="line">        if (str.Contains(&quot;你&quot;) &amp;&amp; (str.Contains(&quot;名字&quot;) || str.Contains(&quot;姓名&quot;)))</div><div class="line">        &#123;</div><div class="line">            this.SayHello();</div><div class="line">        &#125;</div><div class="line">        else if (str.Contains(&quot;你&quot;) &amp;&amp; str.Contains(&quot;女朋友&quot;))</div><div class="line">        &#123;</div><div class="line">            Console.WriteLine(&quot;我还没有了，要不你给我介绍一个&quot;);</div><div class="line">        &#125;</div><div class="line">        else if (str.Contains(&quot;今天&quot;) &amp;&amp; str.Contains(&quot;天气&quot;))</div><div class="line">        &#123;</div><div class="line">            Console.WriteLine(&quot;天气很好&quot;);</div><div class="line">        &#125;</div><div class="line">        else if (str.Contains(&quot;你&quot;) &amp;&amp; str.Contains(&quot;吃饭&quot;))</div><div class="line">        &#123;</div><div class="line">            Console.WriteLine(&quot;我已经吃过了&quot;);</div><div class="line">        &#125;</div><div class="line">        else if (str.Contains(&quot;再见&quot;) || str.Contains(&quot;拜&quot;) || str.Contains(&quot;8&quot;))</div><div class="line">        &#123;</div><div class="line">            Console.WriteLine(&quot;拜，下次聊&quot;);</div><div class="line">            return;</div><div class="line">        &#125;</div><div class="line">        else if (full &lt;= 0)</div><div class="line">        &#123;</div><div class="line">            Console.WriteLine(&quot;I&apos;m hungry! Give some food.Please input the number.&quot;);</div><div class="line">            string str1 = Console.ReadLine();</div><div class="line">            this.Eat(Convert.ToInt32(str1));</div><div class="line"></div><div class="line">        &#125;</div><div class="line">        else</div><div class="line">        &#123;</div><div class="line">            Console.WriteLine(&quot;听不懂&quot;);</div><div class="line">        &#125;</div><div class="line">        full--;</div><div class="line"></div><div class="line">    &#125;</div><div class="line">    public void Eat(int food)</div><div class="line">    &#123;</div><div class="line">        full = full + food;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>4.对象的引用：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line">using System;</div><div class="line">using System.Collections.Generic;</div><div class="line">using System.Linq;</div><div class="line">using System.Text;</div><div class="line"></div><div class="line">namespace _11</div><div class="line">&#123;</div><div class="line">class Program</div><div class="line">&#123;</div><div class="line">    static void Main(string[] args)</div><div class="line">    &#123;</div><div class="line">        int i = 10;//int,char,bool,datetime等类型都是值类型（value type），赋值的时候是传递拷贝</div><div class="line">        int j = i;</div><div class="line">        i++;</div><div class="line">        Console.WriteLine(j);</div><div class="line"></div><div class="line"></div><div class="line">        Person p1 = new Person(10);//普通的对象则是引用类型，赋值的时候是传递引用</div><div class="line">        Person p2 = p1;</div><div class="line">        p1.Age++;</div><div class="line">        Console.WriteLine(p2.Age);</div><div class="line"></div><div class="line">        IncAge(p2);</div><div class="line">        Console.WriteLine(p2.Age);//传递给函数也是引用传递</div><div class="line">        static void IncAge(Person p)</div><div class="line">        &#123;</div><div class="line">             p.Age++;</div><div class="line">         &#125;</div><div class="line">        Console.ReadKey();</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">class Person</div><div class="line">&#123;</div><div class="line">    public int Age</div><div class="line">    &#123;</div><div class="line">        get;</div><div class="line">        set;</div><div class="line">    &#125;</div><div class="line">    public Person(int age)</div><div class="line">    &#123;</div><div class="line">        this.Age = age;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>5.构造函数：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line">using System;</div><div class="line">using System.Collections.Generic;</div><div class="line">using System.Linq;</div><div class="line">using System.Text;</div><div class="line"></div><div class="line">namespace _11</div><div class="line">&#123;</div><div class="line">class Program</div><div class="line">&#123;</div><div class="line">    static void Main(string[] args)</div><div class="line">    &#123;</div><div class="line">        Person p1 = new Person();</div><div class="line">        Person p2 = new Person(&quot;K1&quot;);</div><div class="line">        Person p3 = new Person(&quot;K2&quot;,20);</div><div class="line">        Console.WriteLine(&quot;&#123;0&#125; &#123;1&#125;&quot;,p1 .Name,p1 .Age);</div><div class="line">        Console.WriteLine(&quot;&#123;0&#125; &#123;1&#125;&quot;, p2.Name, p2.Age);</div><div class="line">        Console.WriteLine(&quot;&#123;0&#125; &#123;1&#125;&quot;, p3.Name, p3.Age);</div><div class="line">        Console.ReadKey();</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">class Person</div><div class="line">&#123;</div><div class="line">    public int Age &#123; set; get; &#125;</div><div class="line">    public string Name &#123; set; get; &#125;</div><div class="line">    public Person()//构造函数和类名相同 可以重载</div><div class="line">    &#123;</div><div class="line">        Name = &quot;unknown&quot;;</div><div class="line">        Age = 1;</div><div class="line">    &#125;</div><div class="line">    public Person(string name)</div><div class="line">    &#123;</div><div class="line">        this.Name = name;</div><div class="line">    &#125;</div><div class="line">    public Person(string name, int age)</div><div class="line">    &#123;</div><div class="line">        this.Name = name;</div><div class="line">        this.Age = age;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>6.继承：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div></pre></td><td class="code"><pre><div class="line">using System;</div><div class="line">using System.Collections.Generic;</div><div class="line">using System.Linq;</div><div class="line">using System.Text;</div><div class="line"></div><div class="line">namespace 继承</div><div class="line">&#123;</div><div class="line">class Program</div><div class="line">&#123;</div><div class="line">    static void Main(string[] args)</div><div class="line">    &#123;</div><div class="line">        Chinese c1 = new Chinese();</div><div class="line">        c1.Name = &quot;张三&quot;;</div><div class="line">        c1 .Age =21;</div><div class="line">        c1.Say();</div><div class="line">        c1.HaveTea();</div><div class="line"></div><div class="line">        American a1 = new American();</div><div class="line">        a1.Name = &quot;Gump&quot;;</div><div class="line"></div><div class="line">        Japaniese j1=new Japaniese ();</div><div class="line"></div><div class="line">        //American a4=new Person ();//错误</div><div class="line">        Person p1 = c1;//这是正确的</div><div class="line">        //American a2=p1;//错误的</div><div class="line">        //American a3 =(American) p1;//强制转换错误</div><div class="line"></div><div class="line">        Person p2 = j1;</div><div class="line">        Person p3 = new Person();</div><div class="line">        Chinese c2 = (Chinese)p3;//想想为什么强制转换没有成功</div><div class="line">        Console.ReadKey();</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">class Person//所有的类都直接或间接继承Object类 其是所有类的基类</div><div class="line">&#123;</div><div class="line">    public int Age &#123; set; get; &#125;</div><div class="line">    public string Name &#123; set; get; &#125;</div><div class="line">    public void Say()</div><div class="line">    &#123;</div><div class="line">        Console.WriteLine(&quot;&#123;0&#125;&quot;,Name);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">class Chinese : Person</div><div class="line">&#123;</div><div class="line">    public string Tea &#123; set; get; &#125;</div><div class="line">    public void HaveTea()</div><div class="line">    &#123;</div><div class="line">        Console.WriteLine(&quot;Chinese Tea is good!&quot;);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">class American : Person</div><div class="line">&#123;</div><div class="line">    public void Westmeal()</div><div class="line">    &#123;</div><div class="line">        Console.WriteLine(&quot;Make a difference.&quot;);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">class Japaniese : Person</div><div class="line">&#123;</div><div class="line">&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>7.异常及异常处理<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div></pre></td><td class="code"><pre><div class="line">using System;</div><div class="line">using System.Collections.Generic;</div><div class="line">using System.Linq;</div><div class="line">using System.Text;</div><div class="line"></div><div class="line">namespace 异常</div><div class="line">&#123;</div><div class="line">class Program</div><div class="line">&#123;</div><div class="line">    static void Main(string[] args)</div><div class="line">    &#123;</div><div class="line">        try</div><div class="line">        &#123;</div><div class="line">            int i = Convert.ToInt32(&quot;asd&quot;);</div><div class="line">            Console.WriteLine(&quot;Convert 之后&quot;);</div><div class="line">        &#125;</div><div class="line">        catch(Exception ex)</div><div class="line">        &#123;</div><div class="line">            Console.WriteLine(&quot;数据错误：&quot;+ex.Message +ex.StackTrace);</div><div class="line">            Console.WriteLine(&quot;数据错误之后&quot;);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        try</div><div class="line">        &#123;</div><div class="line">            string str = DescAge(200);</div><div class="line">        &#125;</div><div class="line">        catch(Exception ex)</div><div class="line">        &#123;</div><div class="line">            Console.WriteLine(&quot;数据错误：&quot;+ex.Message);</div><div class="line">        &#125;</div><div class="line">        Console.ReadKey();</div><div class="line">    &#125;</div><div class="line">    static string DescAge(int age)</div><div class="line">    &#123;</div><div class="line">        if (age &gt;= 0 &amp;&amp; age &lt;= 150)</div><div class="line">        &#123;</div><div class="line">         return &quot;正常&quot;;</div><div class="line">        &#125;</div><div class="line">        else if (age &gt; 150)</div><div class="line">        &#123;</div><div class="line">            throw new Exception(&quot;神人啊&quot;);</div><div class="line">        &#125;</div><div class="line">        else</div><div class="line">        &#123;</div><div class="line">            throw new Exception(&quot;不正常&quot;);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>8.常量,变量及static成员</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div></pre></td><td class="code"><pre><div class="line">using System;</div><div class="line">using System.Collections.Generic;</div><div class="line">using System.Linq;</div><div class="line">using System.Text;</div><div class="line"></div><div class="line">namespace 常量,变量及static成员</div><div class="line">&#123;</div><div class="line">class Program</div><div class="line">&#123;</div><div class="line">    public const int Week = 7;//const常量 常量名要大写</div><div class="line">    static void Main(string[] args)</div><div class="line">    &#123;</div><div class="line">        const int Pi = 3;//不可变的量 注意这种用法</div><div class="line">       // Pi = 4;//</div><div class="line">        Console.WriteLine(3*Pi);</div><div class="line"></div><div class="line">        Person.height = 172;//注意</div><div class="line">        Person.Say();//不用new就能使用的方法static方法</div><div class="line">        Horse.Run();</div><div class="line"></div><div class="line">        //Person.Sing();//</div><div class="line">        Person p = new Person();</div><div class="line">        p.Sing();</div><div class="line">        p.Age =20;</div><div class="line"></div><div class="line">        //Rabbit r = new Rabbit();//</div><div class="line">        Rabbit .Weigth =8;</div><div class="line">        //Rabbit.Walk();</div><div class="line">        Rabbit.Eat();</div><div class="line">        Console.ReadKey();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div><div class="line">public class Person</div><div class="line">&#123;</div><div class="line">    public static int height;</div><div class="line">    public int Age;</div><div class="line">    public static void Say()</div><div class="line">    &#123;</div><div class="line">        Console.WriteLine(height);</div><div class="line">        //Console.WriteLine(Age);//在static成员中不能直接调用非static成员</div><div class="line">        //Person.Sing();</div><div class="line">    &#125;</div><div class="line">    public void Sing()</div><div class="line">    &#123;</div><div class="line">        Console.WriteLine(height);</div><div class="line">        Console.WriteLine(Age);</div><div class="line">        Person.Say();//在非static方法中可以调用static方法中的字段 方法</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">public class Horse</div><div class="line">&#123;</div><div class="line">    public static int Size;</div><div class="line">    public int Ability;</div><div class="line">    public static void Run()</div><div class="line">    &#123;</div><div class="line">        Console.WriteLine(Person.height);</div><div class="line">       // Console.WriteLine(Person.Age);//</div><div class="line">        Person.Say();//在static方法中可以调用其它static方法的字段，属性，但不能调用非static的</div><div class="line">        //Person.Sing();</div><div class="line"></div><div class="line">    &#125;</div><div class="line">    public void Leap()</div><div class="line">    &#123;</div><div class="line">        Console.WriteLine(Person.height);</div><div class="line">       // Console.WriteLine(Person.Age);</div><div class="line">        Person.Say();</div><div class="line">        //Person.Sing();</div><div class="line"></div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">static class Rabbit//这是一个静态类</div><div class="line">&#123;</div><div class="line">    public static int Weigth;</div><div class="line">    public string Name;</div><div class="line">    public static void Eat()</div><div class="line">    &#123;</div><div class="line">        Console.WriteLine(Horse.Size);</div><div class="line">       // Console.WriteLine(Horse.Ability);</div><div class="line">    &#125;</div><div class="line">    public void Walk()</div><div class="line">    &#123;</div><div class="line">        Console.WriteLine(Horse.Size);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>9.命名空间</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">using System;</div><div class="line">using System.Collections.Generic;</div><div class="line">using System.Linq;</div><div class="line">using System.Text;</div><div class="line">using 命名空间.hr;</div><div class="line"></div><div class="line">namespace 命名空间</div><div class="line">&#123;</div><div class="line">class Program</div><div class="line">&#123;</div><div class="line">    static void Main(string[] args)</div><div class="line">    &#123;</div><div class="line">        Person p = new Person();//这是本命名空间的类</div><div class="line">        命名空间.wk.Person p2 = new 命名空间.wk.Person();</div><div class="line">        p2.Say();</div><div class="line"></div><div class="line">        Dog d = new Dog();//using 命名空间.hr</div><div class="line"></div><div class="line">        Convert.ToInt32(&quot;12&quot;);//using System</div><div class="line">        Console.ReadKey();</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">class Person</div><div class="line">&#123;</div><div class="line">&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">using System;</div><div class="line">using System.Collections.Generic;</div><div class="line">using System.Linq;</div><div class="line">using System.Text;</div><div class="line"></div><div class="line">namespace 命名空间.wk</div><div class="line">&#123;</div><div class="line">class Person</div><div class="line">&#123;</div><div class="line">    public void Say()</div><div class="line">    &#123;</div><div class="line">        Console.WriteLine(&quot;Hello&quot;);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">using System;</div><div class="line">using System.Collections.Generic;</div><div class="line">using System.Linq;</div><div class="line">using System.Text;</div><div class="line"></div><div class="line">namespace 命名空间.hr</div><div class="line">&#123;</div><div class="line">class Dog</div><div class="line">&#123;</div><div class="line">&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p> 10.索引<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div></pre></td><td class="code"><pre><div class="line">using System;</div><div class="line">using System.Collections.Generic;</div><div class="line">using System.Linq;</div><div class="line">using System.Text;</div><div class="line"></div><div class="line">namespace 索引</div><div class="line">&#123;</div><div class="line">class Program</div><div class="line">&#123;</div><div class="line">    static void Main(string[] args)</div><div class="line">    &#123;</div><div class="line">        Person p = new Person();</div><div class="line">        p[1]=172;</div><div class="line">        Console.WriteLine(&quot;&#123;0&#125; &#123;1&#125;&quot;,p[1],p[2]);</div><div class="line">        Console.WriteLine(p[&quot;Tom&quot;,1,2]);</div><div class="line">        Console.ReadKey();</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">class Person</div><div class="line">&#123;</div><div class="line">    public int Num1=168;</div><div class="line">    public int Num2=173;</div><div class="line">    public int this[int index]</div><div class="line">    &#123;</div><div class="line">        set</div><div class="line">        &#123;</div><div class="line">            if (index == 1)</div><div class="line">            &#123;</div><div class="line">                Num1 = value;</div><div class="line">            &#125;</div><div class="line">            else if (index == 2)</div><div class="line">            &#123;</div><div class="line">                Num2 = value;</div><div class="line">            &#125;</div><div class="line">            else</div><div class="line">            &#123;</div><div class="line">                throw new Exception (&quot;数据错误&quot;);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        get</div><div class="line">        &#123;</div><div class="line">            if (index == 1)</div><div class="line">            &#123;</div><div class="line">                return Num1;</div><div class="line">            &#125;</div><div class="line">            else if (index == 2)</div><div class="line">            &#123;</div><div class="line">                return Num2;</div><div class="line">            &#125;</div><div class="line">            else</div><div class="line">            &#123;</div><div class="line">                throw new Exception(&quot;数据错误&quot;);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    public string this[string name,int i1,int i2]</div><div class="line">    &#123;</div><div class="line">        get</div><div class="line">        &#123;</div><div class="line">            return name + i1 + i2;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p><strong>动手是最重要的，在调试这些代码的过程中。你会深入的了解c#中的一些特性。</strong></p>
<h2 id="Now，just-do-it"><a href="#Now，just-do-it" class="headerlink" title="Now，just do it."></a>Now，just do it.</h2><blockquote>
<p>goodbye next week~</p>
<h3 id="第二部分：环境搭建"><a href="#第二部分：环境搭建" class="headerlink" title="第二部分：环境搭建"></a>第二部分：环境搭建</h3></blockquote>
<p> <strong>本周我们将着重介绍unity&amp;leapmotion协同开发中的环境搭建，场景创建问题</strong></p>
<p>这章内容和核心组件使用有着很强的关系所以作为先导请务必认真阅读</p>
<p>首先我们需要认识一下(xxxx.unitypackage)文件的应用</p>
<p>unitypackage格式的文件可以直接import到unity中,<strong>记住最好是在打开unity的情况下</strong>,在project面板里右击,然后在import packages-&gt;custom package中选中你要导入的资源。</p>
<p>那么我们先来看看 core Asset中都有些什么吧</p>
<p><img src="http://img.blog.csdn.net/20151129160059249" alt="asset"></p>
<p>可以说  leap对这个SDK做了很好的梳理Gizmos中仅存储着传感器在场景中的贴图</p>
<p>而leapmotion下的东西才是我们真正要用到的东西</p>
<p><img src="http://img.blog.csdn.net/20151129160123533" alt="lp"></p>
<p>也就是说如果你只进行桌面的应用开发的话  那么leapmotion+ovr还有OVR这两个文件夹<strong>几乎</strong>可以删除了。</p>
<p>那么我们怎么才在场景中看到手呢？</p>
<p>此时unity强大之处就来了 接下来跟我做：</p>
<p>为了让大家能尽快的获取（运行）一些能看得东西</p>
<p>now 我们在文件视图中看到了搜索框是吧在里面搜索  HandController</p>
<p>将蓝色的prefab（预制体）拖入Hierarchy</p>
<p>于是我们可以看到一个这样的场景</p>
<p><img src="http://img.blog.csdn.net/20151129160203161" alt="sennce"></p>
<p>现在可以运行啦！！！（不要告诉我不知道怎么运行）</p>
<p>是不是看到了两个小小的手！！！！</p>
<p>是这样  unity和各个三维文件之间的单位换算有着区别因此我们如果想看见一双正常的手  要么把摄像机拉近拉的离控制器更近<br>要么把   控制器的scale参数调大  （为了方便计算，十的整数倍的倍率比较好）</p>
<p>OK我们终于能看到了写一个unity程序的<strong>入门之法</strong>了</p>
<p>&lt;/id=3&gt;</p>
<p><img src="http://img.blog.csdn.net/20151129160217473" alt="sandbox"></p>
<p>在unity的core  Asset下我们可以看到很多的demo 。这些demo给我们提供了很多思路，其下的脚本也很有参考性。<br>其中某些写法对我们构建程序来说，有着很强大的指导意义。</p>
<p>甚至对于一些代码经验贫乏的童鞋来说 根本不用自己写代码  仅仅靠ctrl+c&amp;ctrl+v就可以创建一个demo来完成某些功能</p>
<p>但是说实在的我并不鼓励这样做  毕竟我们的目标是学习一些技能  一些知识来为以后的虚拟现实开发奠基</p>
<p>下周我们将正式开始讲解unity&amp;leap的程序开发的初章  因此我们需要知道unity中一些重要的事情</p>
<ul>
<li><span id="2">预制体（prefab）model</span></li>
</ul>
<p><img src="http://img.blog.csdn.net/20151129160240349" alt="prefab"></p>
<p>上图中我们可以看到 handcontroller 就是一个预制体 它包含了脚本 预设置 模型等等  可以说成是一个集合 里面装着这个元素在场景中得以运行所需要的所有文件。可以被复制，重用，使得游戏的编写，场景创建变得高效。比如我们可以把一栋房子，他所有的组件，脚本，模型等等打包为预制体 然后在场景中复制粘贴为更多的房子 成为一个小区等等</p>
<p>此外我们看到handcontroller sandbox当我们把他点开以后发现它是由一个个平面拼接而成的</p>
<p>当我们点进prefab下更多的预制体 会发现更多手的模型 其中文件夹的命名也让你能清楚地理解内容</p>
<p>而在scenes文件夹下你也可以找到更多的工程从而进入更多的脚本去预先了解一些代码的写法。</p>
<ul>
<li>坐标系</li>
</ul>
<p> 你可能会想 这有什么问题 ？</p>
<p> 但是这说起来是个大问题，因为unity中存在着多种坐标判断体系</p>
<p>——视口坐标</p>
<p>——世界坐标</p>
<p>——屏幕坐标</p>
<p>——GUI坐标</p>
<p>1、World Space（世界坐标）：我们在场景中添加物体（如：Cube），他们都是以世界坐标显示在场景中的。transform.position可以获得该位置坐标。</p>
<p>2、Screen Space（屏幕坐标）:以像素来定义的，以屏幕的左下角为（0，0）点，右上角为（Screen.width，Screen.height），Z的位置是以相机的世界单位来衡量的。注：鼠标位置坐标属于屏幕坐标，Input.mousePosition可以获得该位置坐标，手指触摸屏幕也为屏幕坐标，</p>
<pre><code>Input.GetTouch(0).position//可以获得单个手指触摸屏幕坐标。
Screen.width = Camera.pixelWidth
Screen.height = Camera.pixelHeigth
</code></pre><p>3、ViewPort Space（视口坐标）:视口坐标是标准的和相对于相机的。相机的左下角为（0，0）点，右上角为（1，1）点，Z的位置是以相机的世界单位来衡量的。</p>
<p>4、绘制GUI界面的坐标系：这个坐标系与屏幕坐标系相似，不同的是该坐标系以屏幕的左上角为（0，0）点，右下角为</p>
<pre><code>（Screen.width，Screen.height）
</code></pre><p><strong>在此仅仅是粗略介绍， 今后在具体问题下  我们才能更好地认识和学习</strong></p>
<blockquote>
<p>此周务必多进行探索，下周将进行大量内容的讲解。</p>
</blockquote>
<h1 id="1，核心组件的使用。"><a href="#1，核心组件的使用。" class="headerlink" title="1，核心组件的使用。"></a>1，核心组件的使用。</h1><p>在unity的官方文档中中很明显并没有给出如何去怎样很好的去使用给出的资源那我们先来明确一下  core asset中的资源都是用来干什么的</p>
<h2 id="（1）-handcontroller（以下简化为hc）"><a href="#（1）-handcontroller（以下简化为hc）" class="headerlink" title="（1）.handcontroller（以下简化为hc）"></a>（1）.handcontroller（以下简化为hc）</h2><p>这个组件的目的就是在空间具象化出传感器检测到的手，以及传感器本身的检测范围，我们可以在inspector 面板中清楚地看到他的构成<br><img src="http://img.blog.csdn.net/20151208181219171" alt="这里写图片描述"></p>
<p>这里的命名十分清楚，在hc的脚本中包含了左右手的模型，包括</p>
<p>图像模型<br>物理模型<br>工具模型<br>是否头戴的选项（主要用于协同oculus的开发）<br>以及其他一些可供调整的选项</p>
<p>让我们点进图像模型去看又会发现一些更有意思的问题<br><img src="http://img.blog.csdn.net/20151208181853700" alt="prefab"></p>
<p>首先我们会发现这些图像模型都是一些预制体他们由统一的skeletalhand脚本控制  这是他们的灵魂所在</p>
<p>是这个脚本把一些零散的模型组合在一起成为一个手  统一之下既然会有skeletalhand  那么skeletalfinger  这些脚本共同控制着在场景中手的运动是符合人体规律，也符合数据的（虽然在具体过程中还是会出现偏差和bug）</p>
<p><strong>了解了由骨骼拼成的图像化手的模型，再来了解物理模型</strong><br>与图像模型进行比较<br><img src="http://img.blog.csdn.net/20151208182959282" alt="phy"><br><img src="http://img.blog.csdn.net/20151208183056443" alt="rigi"></p>
<p>我们会发现从中发现很大的不同  物理模型的网格为了减少计算提高性能<br>仅仅用一些粗略的网格去勾绘触发区域    但是  这也基本足够用  因为触发本身就是不精确的 且此种网格因为涉及了很多计算本身就是极为耗费性能的。</p>
<p>在这套物理系统中  我们可以轻松方便的设计触发 ，碰撞<br>当你新建了一个预设的cube或者其他物体且使用他们的collider的话可以用下面一段代码轻松地检测碰撞以及触发<br>：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">void OnTriggerEnter(Collider collider)</div><div class="line">    &#123;</div><div class="line">        print(collider.gameObject.name + &quot;:&quot; + Time.time);</div><div class="line"></div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>当然你也可能发现  我们在选择图形模型的时候出现了很多预制体，实际上这里出现的预制体也就都是手的不同的图形模型  我们可以根据左右手分别选择左右手的图形模型  其中包括了机器，仿真，纯白，为了达到更高的调试效果  我们推荐使用白色基础模型  因为他的渲染需求小很多  能够更清晰的反馈问题<br><img src="http://img.blog.csdn.net/20151208201852420" alt="window"></p>
<p>此外工具模式<strong>可用性极低</strong>  在我的测试中即使工具异常明显  识别率成功率几乎是不可用的   因此我们在程序中几乎不需要考虑工具模式。</p>
<h2 id="（2）-SCENCE"><a href="#（2）-SCENCE" class="headerlink" title="（2）.SCENCE"></a>（2）.SCENCE</h2><p>在scence文件夹中  存在着很多leap用作演示的工程   他们统一基于core asset中的公用资源编写  所以所有文件都是可见的  都是可重用的  他们为我们的开发带来了很多思路  以及方法<br>比如我们以其中的imagine hand 就可以清晰的看出  leapmotion的工作进程以及识别算法的思路<br>：在正常的识别模式之下  采用了高噪点的模式同时蓝色边沿就是景深图像经过算法处理后  形成单帧的手势运算图形</p>
<p><img src="http://img.blog.csdn.net/20151208205029247" alt="imagine"></p>
<hr>
<p><strong>我们如果直接采集图像和图形化检视面板作比较的话  就不难发现  这种描边+景深处理的形式</strong></p>
<hr>
<p><img src="http://img.blog.csdn.net/20151208210218188" alt="这里写图片描述"></p>
<hr>
<p><strong>在这写预置的场景中甚至有一些解决了我们无从下手的设计问题</strong></p>
<p><img src="http://img.blog.csdn.net/20151208212129717" alt="这里写图片描述"><br><img src="http://img.blog.csdn.net/20151208212213463" alt="这里写图片描述"></p>
<p>在这些设计工作上我们可以根据这些例子  这些demo直接去设计从而省去了很多的探索过程</p>
<p><strong>鉴于下一章直接要讲一些功能的实现方式  我们在此直接贴出一些unity中物体操作的代码供大家调试</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div></pre></td><td class="code"><pre><div class="line">using UnityEngine;</div><div class="line">using System.Collections;</div><div class="line"></div><div class="line">public class mover : MonoBehaviour &#123;</div><div class="line"></div><div class="line">	// Use this for initialization</div><div class="line">	void Start () &#123;</div><div class="line"></div><div class="line">		//x轴坐标</div><div class="line">		//float xPostion = -5f;</div><div class="line">		//z轴坐标</div><div class="line">		//float zPostion = 10f;</div><div class="line">		//直接将当前物体移动到x轴为xPostion，y轴为0，z轴为zPostion的三维空间位置。</div><div class="line">		transform.position = new Vector3(0.1f,0.1f,0.1f);//初始化坐标</div><div class="line"></div><div class="line">	&#125;</div><div class="line"></div><div class="line">	// Update is called once per frame</div><div class="line">	/*</div><div class="line">void Update () &#123;</div><div class="line">		/*</div><div class="line">		//移动速度</div><div class="line">		float TranslateSpeed = 0.1f;</div><div class="line"></div><div class="line">		//Vector3.forward 表示“向前”</div><div class="line">		transform.Translate(Vector3.forward *TranslateSpeed);</div><div class="line">         //单方向移动*/</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">		/*</div><div class="line">		//轴移动速度移动速度</div><div class="line">		float xSpeed = 0.01f;</div><div class="line"></div><div class="line">		//z轴移动速度移动速度</div><div class="line">		float  zSpeed = 0.01f;</div><div class="line">		float ySpeed = 0.01f;</div><div class="line"></div><div class="line">		//向x轴移动xSpeed，同时想z轴移动zSpeed，y轴不动</div><div class="line">		transform.Translate(xSpeed,ySpeed,zSpeed);</div><div class="line">		*/</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">	/*</div><div class="line"></div><div class="line">		//按下键盘“上方向键”控制cube的位置</div><div class="line"></div><div class="line">		if(Input.GetKey(KeyCode.UpArrow))</div><div class="line">		&#123;</div><div class="line">			Debug.Log (&quot;up&quot;);</div><div class="line">			transform.Translate(0.1f,0f,0f);&#125;</div><div class="line">		if(Input.GetKey(KeyCode.LeftArrow))</div><div class="line">		&#123;</div><div class="line">			Debug.Log(&quot;left&quot;);</div><div class="line">			transform.Translate(0f,0.1f,0f);&#125;</div><div class="line">		if(Input.GetKey(KeyCode.DownArrow))</div><div class="line">		&#123;   </div><div class="line">			Debug.Log(&quot;down&quot;);</div><div class="line">			transform.Translate(-0.1f,0f,0f);&#125;</div><div class="line">		if(Input.GetKey(KeyCode.RightArrow))</div><div class="line">		&#123;   </div><div class="line">			Debug.Log(&quot;right&quot;);</div><div class="line">			transform.Translate(0f,-0.1f,0f);&#125;</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">		//按下鼠标左键（0对应左键 ， 1对应右键 ， 2对应中键）</div><div class="line">		/*</div><div class="line">		if(Input.GetMouseButton(0))</div><div class="line">			Debug.Log (&quot;mouse down&quot;);</div><div class="line">		Input.GetAxis(&quot;Mouse X&quot;);//鼠标横向增量（横向移动）</div><div class="line">		Input.GetAxis(&quot;Mouse Y&quot;);//鼠标纵向增量（纵向移动）</div><div class="line">        */</div><div class="line"></div><div class="line">	/*</div><div class="line">		//旋转</div><div class="line">		this.transform.Rotate (Vector3.up, 0.3f);</div><div class="line">		this.transform.Rotate (Vector3.right, 0.3f);</div><div class="line">		this.transform.Rotate (Vector3.forward, 0.3F);</div><div class="line">*/</div><div class="line">	/*</div><div class="line">		//缩放</div><div class="line">		float speed = 0.1f;</div><div class="line">		float x;</div><div class="line">		float z;</div><div class="line">		x = Input.GetAxis(&quot;Horizontal&quot;) * Time.deltaTime * speed;    //水平           </div><div class="line">		z = Input.GetAxis(&quot;Vertical&quot;) * Time.deltaTime * speed;      //垂直//&quot;Fire1&quot;，&quot;Fine2&quot;，&quot;Fine3&quot;映射到Ctrl，Alt，Cmd键和鼠标的三键或腰杆按钮。新的输入轴可以在Input Manager中添加。</div><div class="line">		transform.localScale += new Vector3(x, 0, z);</div><div class="line"></div><div class="line"></div><div class="line">	*/</div><div class="line"></div><div class="line">		//鼠标按着左键移动</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">/*</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">	void Update()</div><div class="line">	&#123;</div><div class="line"></div><div class="line">		move ();</div><div class="line"></div><div class="line">	&#125;</div><div class="line">	void move()//move函数可复用</div><div class="line">	&#123;   float speed = 0.1f;</div><div class="line">		float y;</div><div class="line">		float x;</div><div class="line">		if (Input.GetMouseButton (0))&#123;</div><div class="line">			y = Input.GetAxis (&quot;Mouse X&quot;) * Time.deltaTime * speed;</div><div class="line">			x = Input.GetAxis (&quot;Mouse Y&quot;) * Time.deltaTime * speed;</div><div class="line">			transform.Translate(x*5,y*5,0);</div><div class="line">			Debug.Log(&quot;x=&quot;+x);</div><div class="line">			Debug.Log(&quot;y=&quot;+y);</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">*/</div><div class="line">/*</div><div class="line">	float speed = 100.0f;</div><div class="line">	float x;</div><div class="line">	float z;</div><div class="line">	float y;</div><div class="line">  //鼠标控制旋转</div><div class="line"></div><div class="line">	void Update () &#123;</div><div class="line">		if(Input.GetMouseButton(0))&#123;//鼠标按着左键移动</div><div class="line">			y = Input.GetAxis(&quot;Mouse X&quot;) * Time.deltaTime * speed;</div><div class="line">			x = Input.GetAxis(&quot;Mouse Y&quot;) * Time.deltaTime * speed;</div><div class="line">			Debug.Log(&quot;X=&quot;+x);</div><div class="line">			Debug.Log(&quot;y=&quot;+y);</div><div class="line"></div><div class="line"></div><div class="line">		&#125;</div><div class="line">		else&#123;x = y = 0 ;&#125;//检测鼠标如果没有在按压状态下移动的话，返回坐标归零</div><div class="line">		transform.Rotate(new Vector3(x,y,0));</div><div class="line">		/**---------------其它旋转方式----------------**///transform.Rotate(Vector3.up *Time.deltaTime * speed);//绕Y轴 旋转//用于平滑旋转至自定义目标</div><div class="line"></div><div class="line">	/*	pinghuaxuanzhuan();&#125;</div><div class="line"></div><div class="line">			//平滑旋转至自定义角度</div><div class="line">	void OnGUI()&#123;if(GUI.Button(new Rect(Screen.width - 110,10,100,50),&quot;set Rotation&quot;))&#123;//自定义角度</div><div class="line">			targetRotation = Quaternion.Euler(45.0f,45.0f,45.0f);// 直接设置旋转角度</div><div class="line">        iszhuan = true;&#125;</div><div class="line">		&#125;</div><div class="line"></div><div class="line">		bool iszhuan= false;</div><div class="line">		Quaternion targetRotation;</div><div class="line"></div><div class="line">		void pinghuaxuanzhuan()&#123;if(iszhuan)&#123;</div><div class="line">				transform.rotation = Quaternion.Slerp(transform.rotation, targetRotation, Time.deltaTime * 3);//平缓旋转函数可复用</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">       */</div><div class="line">		/*</div><div class="line">		 * 脚本bug处理总结：</div><div class="line">		 * 1，情况一：官方样板如果出现bug，则为编译框架问题改正方法：project-&gt;assembly csoption-&gt;build/general-&gt;target framework由3.5改为4.5</div><div class="line">		 * 2，情况二：如果提示符号问题，很可能是空格所带来的问题，mono对编辑区空格宽容度较低，提示脚本中某行的问题，如果确定语法没错，很可能是因为空格的问题</div><div class="line">		 * 3，情况三：单精度后必须加f  1.0 错  1.0f对</div><div class="line">		 * 4，情况四：复制粘贴的代码需要大量精力来重新对格式进行debug，因此如果不是两三百行以上，尽量自己重写</div><div class="line">		 * 5，情况五：如果编译错误很可能是因为空白区域留有字符</div><div class="line">		 * /</div><div class="line"></div><div class="line"></div><div class="line">*/</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<blockquote>
<p>注：以上代码均为不同功能片段凑成  不是直接复制粘贴运行就能完成功能  至于怎么修改和去除注释  我想就不用我教了</p>
</blockquote>
<p>此外我们需要对摄像机的位置进行调整的话  可以用以下代码  用以保证摄像机永远对着物体拍摄<br>以下代码的脚本需附在摄像机上  以此摄像机的轨迹就是以物体为球心的球面</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line">using UnityEngine;</div><div class="line">using System.Collections;</div><div class="line"></div><div class="line">public class camral : MonoBehaviour &#123;</div><div class="line">	public Vector3 v1, v2;</div><div class="line">	public GameObject cube;</div><div class="line"></div><div class="line">	// Use this for initialization</div><div class="line">	void Start () &#123;</div><div class="line">		cube =  GameObject.Find(&quot;House N251015&quot;);//house xxxx为物体的名字</div><div class="line"></div><div class="line">	&#125;</div><div class="line"></div><div class="line">	// Update is called once per frame</div><div class="line">	void Update () &#123;</div><div class="line">		if (Input.GetKey (KeyCode.UpArrow))</div><div class="line">			this.transform.RotateAround (cube.transform.position, Vector3.right, Time.deltaTime*10f);</div><div class="line">		if (Input.GetKey (KeyCode.DownArrow))</div><div class="line">			this.transform.RotateAround (cube.transform.position, Vector3.left, Time.deltaTime * 10f);</div><div class="line">		if (Input.GetKey (KeyCode.LeftArrow))</div><div class="line">			this.transform.RotateAround (cube.transform.position, Vector3.down, Time.deltaTime * 10f);</div><div class="line">		if (Input.GetKey (KeyCode.RightArrow))</div><div class="line">			this.transform.RotateAround (cube.transform.position, Vector3.up, Time.deltaTime * 10f);</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>在后期的开发中我们还需要对物体的坐标进行世界坐标化  以免旋转过后因为自身坐标的变化而引起方向的混乱  因此  我们物体的操作  都要有基于世界坐标的版本</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div></pre></td><td class="code"><pre><div class="line">using UnityEngine;</div><div class="line">using System.Collections;</div><div class="line"></div><div class="line">public class world_v : MonoBehaviour &#123;</div><div class="line">	public GameObject cube;</div><div class="line">	// Use this for initialization</div><div class="line">	void Start () &#123;</div><div class="line">		this.cube.transform.position = new Vector3 (0f, 0f, 0f);</div><div class="line"></div><div class="line">	&#125;</div><div class="line"></div><div class="line">	// Update is called once per frame</div><div class="line">	void Update () &#123;</div><div class="line"></div><div class="line"></div><div class="line">		if(Input.GetKey(KeyCode.UpArrow))</div><div class="line">		&#123;</div><div class="line">			Debug.Log (&quot;up&quot;);</div><div class="line">			this.cube.transform.Translate(Vector3.up * Time.deltaTime, Space.World);</div><div class="line"></div><div class="line">		//	this.cube.transform.Translate(0f,0.1f,0f);</div><div class="line">		&#125;</div><div class="line">		if(Input.GetKey(KeyCode.LeftArrow))</div><div class="line">		&#123;</div><div class="line">			Debug.Log(&quot;left&quot;);</div><div class="line">			this.cube.transform.Translate(Vector3.left * Time.deltaTime, Space.World);</div><div class="line">		&#125;</div><div class="line">			//this.cube.transform.Translate(-0.1f,0f,0f);&#125;</div><div class="line">		if(Input.GetKey(KeyCode.DownArrow))</div><div class="line">		&#123;   </div><div class="line">			Debug.Log(&quot;down&quot;);</div><div class="line">			this.cube.transform.Translate(Vector3.down * Time.deltaTime, Space.World);</div><div class="line">		//this.cube.transform.Translate(0f,-0.1f,0f);</div><div class="line">		&#125;</div><div class="line">		if(Input.GetKey(KeyCode.RightArrow))</div><div class="line">		&#123;   </div><div class="line">			Debug.Log(&quot;right&quot;);</div><div class="line">			this.cube.transform.Translate(Vector3.right * Time.deltaTime, Space.World);</div><div class="line">			//this.cube.transform.Translate(0.1f,0f,0f);</div><div class="line">		&#125;</div><div class="line">		if (Input.GetKey (KeyCode.W)) &#123;</div><div class="line">			Debug.Log (&quot;z+&quot;);</div><div class="line">			this.cube.transform.Translate(Vector3.forward * Time.deltaTime, Space.World);</div><div class="line">		//	this.cube.transform.Translate (0f, 0f, 0.1f);</div><div class="line">		&#125;</div><div class="line">		if (Input.GetKey (KeyCode.S)) &#123;</div><div class="line">			Debug.Log(&quot;z-&quot;);</div><div class="line">			this.cube.transform.Translate(Vector3.back* Time.deltaTime, Space.World);</div><div class="line">			//this.cube.transform.Translate(0f,0f,-0.1f);</div><div class="line"></div><div class="line"></div><div class="line">//________________________________________________________________</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">		&#125;</div><div class="line">		if (Input.GetKey (KeyCode.Y)) &#123;</div><div class="line">			//this.cube.transform.Rotate(new Vector3(1,0,0));</div><div class="line">			this.cube.transform.Rotate(Vector3.up *1f, Space.World);</div><div class="line">		&#125;</div><div class="line">		if(Input.GetKey(KeyCode.U))</div><div class="line">		&#123;</div><div class="line">			//this.cube.transform.Rotate(new Vector3(0,1,0));</div><div class="line">			this.cube.transform.Rotate(Vector3.left *1f, Space.World);</div><div class="line">		&#125;</div><div class="line">		if(Input.GetKey(KeyCode.I))</div><div class="line">		&#123;</div><div class="line">			//this.cube.transform.Rotate(new Vector3(0,0,1));</div><div class="line">			this.cube.transform.Rotate(Vector3.forward *1f, Space.World);</div><div class="line">		&#125;</div><div class="line">		if (Input.GetKey (KeyCode.H)) &#123;</div><div class="line">			//this.cube.transform.Rotate(new Vector3(-1,0,0));</div><div class="line">			this.cube.transform.Rotate(Vector3.down *1f, Space.World);</div><div class="line">		&#125;</div><div class="line">		if (Input.GetKey (KeyCode.J)) &#123;</div><div class="line">			//this.cube.transform.Rotate(new Vector3(0,-1,0));</div><div class="line">			this.cube.transform.Rotate(Vector3.right *1f, Space.World);</div><div class="line">		&#125;</div><div class="line">		if (Input.GetKey (KeyCode.K)) &#123;</div><div class="line">			//this.cube.transform.Rotate(new Vector3(0,0,-1));</div><div class="line">			this.cube.transform.Rotate(Vector3.back *1f, Space.World);</div><div class="line">		 &#125;</div><div class="line"></div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>描述了以上一些操作  在unity中你就可以让物体动起来了并且按照一定的路线去规定物体怎么去运动  也为我们的进一步交互打好了基础</strong></p>
<p>下周的内容将是真正意义上开发的开始  请仔细完成以上代码的功能</p>
<h3 id="本周着重开始讲解leap开发中的实际问题"><a href="#本周着重开始讲解leap开发中的实际问题" class="headerlink" title="本周着重开始讲解leap开发中的实际问题"></a>本周着重开始讲解leap开发中的实际问题</h3><hr>
<p><strong>首先我们必须对一些核心的脚本进行熟悉  明白他们的工作原理  ：</strong></p>
<p><strong>1.重中之重simple.cs</strong></p>
<p>作为官方编写的文档  几乎出现了所有的api 函数所有的返回数据  所有的方法  除去一些需要自己经验的写法  基本全部囊括其中了 但是 以下代码 基本见不到了simple.cs的影子   </p>
<p>鉴于是教程  那我的定位是代码讲解 采取分立介绍最后汇总 不是铺陈代码<br>tip ：</p>
<p>以下代码片段都不是直接复制粘贴就能运行的  小白还是回去看我之前的内容<br>以下代码片段都不是直接复制粘贴就能运行的  小白还是回去看我之前的内容<br>以下代码片段都不是直接复制粘贴就能运行的  小白还是回去看我之前的内容  </p>
<p><strong>头文件部分</strong>  因为设计到了一些list 或是一些UI绘制  所以头文件显得多了一些（当然以后会更多)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">using UnityEngine;</div><div class="line">using UnityEngine.UI;</div><div class="line">using System.Collections;</div><div class="line">using System;</div><div class="line">using Leap;</div><div class="line">using System.Collections.Generic;</div></pre></td></tr></table></figure>
<p><strong>在脚本类中的定义工作</strong>  （以后的脚本基本基于以下定义工作，如不作特殊说明则默认为以下定义）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">   public HandController  hc;      //控制器    </div><div class="line">private HandModel  hm;          //手部模型</div><div class="line">public GameObject cubePrefab;   //可不定义</div><div class="line">public Vector squizehand;      //紧握得手vector</div><div class="line">private GameObject cube = null;</div><div class="line">Frame currentFrame = null;//定义当前帧</div><div class="line">Frame lastFrame = null;//上一帧</div></pre></td></tr></table></figure>
<p><strong>函数部分</strong><br>借助返回的数据  我们可以设计更多的手势  比如在大量测试后  我们发现35左右的值在leap设计中是关键的参数所以：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">bool squize(float radius)//判断手势是否为握持  阀值为35</div><div class="line">	&#123;</div><div class="line">		if (radius &lt; 37)</div><div class="line">			return true;</div><div class="line">		else</div><div class="line">			return false;</div><div class="line">	&#125;</div></pre></td></tr></table></figure>
<p>另外  如果你有自己的想法  或是对返回值有所要求or不想用官方给的东西  那么可以自己写一个判断双手距离的函数：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">double distance(Vector a,Vector b)//双手距离判断  退出机制触发阀值为35</div><div class="line">	&#123;</div><div class="line"></div><div class="line">		double c=Math.Sqrt (Math.Pow ((a.x-b.x), 2) + Math.Pow ((a.y-b.y), 2) + Math.Pow ((a.z-b.z), 2));</div><div class="line">		Debug.Log (&quot;TWO hand distance=&quot;+c);</div><div class="line">		return c;</div><div class="line">	&#125;</div></pre></td></tr></table></figure>
<p>以上两个<strong>非常简单</strong>的函数共同使用  就诞生了更多的用法 <strong>我们后续会介绍</strong> 并且经过测试  其稳定性甚至要高于某些官方的预制手势<br>那好既然说道预制手势  下面我们就来讨论一下  预制手势的用法：<br><strong>首先</strong>需要在start()中定义  打开预制手势：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">hc.GetLeapController().EnableGesture(Gesture.GestureType.TYPECIRCLE);  //环绕</div><div class="line">hc.GetLeapController().EnableGesture(Gesture.GestureType.TYPESWIPE); //挥动</div><div class="line">hc.GetLeapController().EnableGesture(Gesture.GestureType.TYPE_SCREEN_TAP); // ？</div><div class="line">hc.GetLeapController ().EnableGesture (Gesture.GestureType.TYPEKEYTAP);   //点击</div><div class="line">hc.GetLeapController ().EnableGesture (Gesture.GestureType.TYPEINVALID);  //无效</div></pre></td></tr></table></figure>
<p>在此之后我们就可以通过<strong>foreach</strong>来调用各种预制手势 但说实话  相比起来  预制手势能完成的工作实在是太少了</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">foreach (Gesture g in gestures) &#123;</div><div class="line">			Debug.Log (g.Type);</div><div class="line"></div><div class="line">			//----code----//</div><div class="line">			//此中循环为调取手势列表中预制的手势</div><div class="line">			//leap在API中预置了手势即：</div><div class="line">			//Gesture.GestureType.TYPESWIPE</div><div class="line">			//Gesture.GestureType.TYPE_SCREEN_TAP</div><div class="line">			//Gesture.GestureType.TYPEKEYTAP</div><div class="line">			//Gesture.GestureType.TYPECIRCLE</div><div class="line">			//等</div><div class="line">			//以此预制手势来实现操作则在此编码</div><div class="line"></div><div class="line">		&#125;</div></pre></td></tr></table></figure>
<p>以上为预制手势使用的基本框架  下面就是预制手势完成的小demo ： 返回发生keytap手势时手的位置<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">foreach (Hand hand in frame.Hands) &#123;</div><div class="line">		foreach (Gesture g in gestures) &#123;</div><div class="line">			Debug.Log (g.Type);</div><div class="line">			if (g.Type == Gesture.GestureType.TYPEKEYTAP) &#123;</div><div class="line">				Debug.Log(&quot;tip position&quot;+hand.PalmPosition);</div><div class="line"></div><div class="line">				&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;</div></pre></td></tr></table></figure></p>
<h4 id="（其中值得注意的是：-swipe-和keytap这两个手势互相干扰非常严重-所以我们需要注意-这两个预制手势的共同使用是相当糟糕的）"><a href="#（其中值得注意的是：-swipe-和keytap这两个手势互相干扰非常严重-所以我们需要注意-这两个预制手势的共同使用是相当糟糕的）" class="headerlink" title="（其中值得注意的是：  swipe 和keytap这两个手势互相干扰非常严重  所以我们需要注意  这两个预制手势的共同使用是相当糟糕的）"></a><strong><em>（其中值得注意的是</em></strong>：  swipe 和keytap这两个手势互相干扰非常严重  所以我们需要注意  这两个预制手势的共同使用是相当糟糕的<strong>）</strong></h4><hr>
<p>那么讲完了预制手势，我们来讲讲返回值。首先，既然要完成手势的设计，能获取各种方法的返回值才是<strong>最重要</strong>的：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">public  void OnFrame (HandController controller)</div><div class="line">	&#123;</div><div class="line">		//获取基本信息</div><div class="line">		Frame frame = controller.GetFrame();    //当前帧</div><div class="line">		Frame lastframe = controller.getlastframe ();//之前帧 星标1后续会重点讲这里记住</div><div class="line"></div><div class="line">		Debug.Log (&quot;Frame id: &quot; + frame.Id                              //帧ID</div><div class="line">		           + &quot;, timestamp: &quot; + frame.Timestamp                  //帧时间戳：从捕捉开始经过了多少毫秒</div><div class="line">		           + &quot;, hands: &quot; + frame.Hands.Count                    //有几只手</div><div class="line">		           + &quot;, fingers: &quot; + frame.Fingers.Count                //有几只手指</div><div class="line">		           + &quot;, tools: &quot; + frame.Tools.Count                    //有几个工具</div><div class="line">		           + &quot;, gestures: &quot; + frame.Gestures ().Count);         //手势计数</div><div class="line">		Debug.Log (&quot;lastFrame id: &quot; + lastframe.Id</div><div class="line">		           + &quot;, lasttimestamp: &quot; + lastframe.Timestamp</div><div class="line">		           + &quot;, lasthands: &quot; + lastframe.Hands.Count</div><div class="line">		           + &quot;, lastfingers: &quot; + lastframe.Fingers.Count</div><div class="line">		           + &quot;, lasttools: &quot; + lastframe.Tools.Count</div><div class="line">		           + &quot;, lastgestures: &quot; + lastframe.Gestures ().Count);</div><div class="line"></div><div class="line"></div><div class="line">	&#125;</div></pre></td></tr></table></figure>
<p>以上这个方法清楚的显示了leap代码构建的逻辑：</p>
<p><strong>控制器下有一个记录每帧数据的容器 我们从每个数据帧中获得我们想要的信息  通过和之前帧对比来达到我们的目的</strong><br>如果我们想启用以上函数打印一些基本信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">OnFrame(hc);//平时不必调用</div></pre></td></tr></table></figure>
<blockquote>
<p>（至于怎么修改获取容器中的值  我们稍后就会讲到  所以大家先看我讲的东西）</p>
</blockquote>
<p><strong>frame ：</strong>就是我们所说的帧  之下的方法也就是在一帧之内我们能得到的  所有工作基本基于 frame展开  那么就是说  基本工作的展开都是从定义帧开始</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">      Frame frame = hc.GetFrame ();</div><div class="line">Frame lastframe = hc.getlastframe ();</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">      this.currentFrame = hc.GetFrame ();</div><div class="line">GestureList gestures = this.currentFrame.Gestures ();</div></pre></td></tr></table></figure>
<p>在此基础上我们后续的工作才能展开  以下为在左手右手基础上的  代码框架</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div></pre></td><td class="code"><pre><div class="line">      Vector lefthand = null;</div><div class="line">Vector righthand = null;</div><div class="line">bool lefthandexist = false;//判断左右手是否在场景中存在</div><div class="line">bool righthandexist = false;</div><div class="line"></div><div class="line">foreach (var h in hc.GetFrame().Hands) &#123;</div><div class="line"></div><div class="line">	if (h.IsLeft) &#123;</div><div class="line">		lefthandexist=true;</div><div class="line">		Debug.Log (&quot;lefthand exist? =&quot; + lefthandexist);</div><div class="line">		lefthand = h.PalmPosition;</div><div class="line">		//____code____//</div><div class="line">		/*</div><div class="line">	         此中h即为左手，可按照手的一切操作方式来编码</div><div class="line">	          */</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">	&#125;</div><div class="line">	if (h.IsRight) &#123;</div><div class="line">		righthandexist=true;</div><div class="line">		Debug.Log (&quot;righthandexist? =&quot; + righthandexist);</div><div class="line">		righthand=h.PalmPosition;</div><div class="line"></div><div class="line">		foreach (Finger finger in righthand.Fingers) &#123;</div><div class="line"></div><div class="line">			Finger.FingerType type=finger.Type();</div><div class="line">         	Debug.Log (&quot;    Finger id: &quot; + finger.Id</div><div class="line">			               + &quot;, &quot; + finger.Type().ToString()</div><div class="line">			               + &quot;, length: &quot; + finger.Length</div><div class="line">			               + &quot;mm, width: &quot; + finger.Width + &quot;mm&quot;);</div><div class="line"></div><div class="line">			if(type==Finger.FingerType.TYPE_INDEX)// 手指类型的判断</div><div class="line">				Debug.Log(&quot;tip position=&quot;+finger.TipPosition+</div><div class="line">				          &quot;tip direction=&quot;+finger.Direction);</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">		//____code____//</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">	&#125;</div><div class="line">	if(lefthandexist&amp;&amp;righthandexist)</div><div class="line">	&#123;</div><div class="line">		//____code____//</div><div class="line">		//如果左右手同时存在情况下的代码放在如下</div><div class="line"></div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>以上基本为手势部分代码设计框架<br>还有很多内容没法全部细讲  那么我就直接贴上来代码了</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">/*控制台输出debug。log与using system之中  console。writeline用法相同</div><div class="line">		 * 代码使用foreach来循环以达到返回所有手部数据的要求因此设计中可以带来更多设计</div><div class="line">		 * keytap可用来点选</div><div class="line">		 * type circle可用来旋转目标</div><div class="line">		 * 挥舞可用来滑动菜单</div><div class="line">		 * UI检测方式可用跟踪手的位置  如果：palm_position&lt;e(UI模块范围)&amp;&amp;gesture==keytap  则生成交互</div><div class="line">		 *</div><div class="line">		 * 在此基础上改变交互规则：</div><div class="line">		 *</div><div class="line">		 * 以下为可收集数据中的注释 全可在以上对帧的循环下执行</div><div class="line">		 * WriteLine (&quot;Frame id: &quot; + frame.Id</div><div class="line">                    + &quot;, timestamp: &quot; + frame.Timestamp</div><div class="line">                    + &quot;, hands: &quot; + frame.Hands.Count</div><div class="line">                    + &quot;, fingers: &quot; + frame.Fingers.Count</div><div class="line">                    + &quot;, tools: &quot; + frame.Tools.Count</div><div class="line">                    + &quot;, gestures: &quot; + frame.Gestures ().Count);</div><div class="line"></div><div class="line">		 * //pass</div><div class="line">		 * WriteLine (&quot;  Hand id: &quot; + hand.Id</div><div class="line">						+ &quot;, palm position: &quot; + hand.PalmPosition);</div><div class="line">			// Get the hand&apos;s normal vector and direction</div><div class="line">			Vector normal = hand.PalmNormal;</div><div class="line">			Vector direction = hand.Direction;</div><div class="line"></div><div class="line">			// 计算手的角度  翻滚，偏离角</div><div class="line">			WriteLine (&quot;  Hand pitch: &quot; + direction.Pitch * 180.0f / (float)Math.PI + &quot; degrees, &quot;</div><div class="line">                        + &quot;roll: &quot; + normal.Roll * 180.0f / (float)Math.PI + &quot; degrees, &quot;</div><div class="line">                        + &quot;yaw: &quot; + direction.Yaw * 180.0f / (float)Math.PI + &quot; degrees&quot;);</div><div class="line"></div><div class="line">			// 获得胳膊的骨骼</div><div class="line">            Arm arm = hand.Arm;</div><div class="line">			WriteLine (&quot;  Arm direction: &quot; + arm.Direction</div><div class="line">                        + &quot;, wrist position: &quot; + arm.WristPosition</div><div class="line">                        + &quot;, elbow position: &quot; + arm.ElbowPosition);</div><div class="line"></div><div class="line">			// 获得手指  foreach也可嵌套</div><div class="line">			foreach (Finger finger in hand.Fingers) &#123;</div><div class="line">				SafeWriteLine (&quot;    Finger id: &quot; + finger.Id</div><div class="line">					        + &quot;, &quot; + finger.Type().ToString()</div><div class="line">					        + &quot;, length: &quot; + finger.Length</div><div class="line">					        + &quot;mm, width: &quot; + finger.Width + &quot;mm&quot;);</div><div class="line"></div><div class="line">				// 获得手指的骨骼</div><div class="line">				Bone bone;</div><div class="line">				foreach (Bone.BoneType boneType in (Bone.BoneType[]) Enum.GetValues(typeof(Bone.BoneType)))</div><div class="line">				&#123;</div><div class="line">					bone = finger.Bone(boneType);</div><div class="line">					SafeWriteLine(&quot;      Bone: &quot; + boneType</div><div class="line">						        + &quot;, start: &quot; + bone.PrevJoint</div><div class="line">						        + &quot;, end: &quot; + bone.NextJoint</div><div class="line">						        + &quot;, direction: &quot; + bone.Direction);</div><div class="line">				&#125;</div><div class="line">			&#125;</div><div class="line">		 *</div><div class="line">		 *</div><div class="line">		 *</div><div class="line">		 * ——————————————————————————————————————————————————————————————————</div><div class="line">		 * 以下为prefab手势的扩展与详解</div><div class="line">		 *</div><div class="line">		 * 旋转手势  顺时针与逆时针的判断规则：</div><div class="line">		 * case Gesture.GestureType.TYPE_CIRCLE:</div><div class="line">				CircleGesture circle = new CircleGesture (gesture);</div><div class="line"></div><div class="line">                // Calculate clock direction using the angle between circle normal and pointable</div><div class="line">				String clockwiseness;</div><div class="line">				if (circle.Pointable.Direction.AngleTo (circle.Normal) &lt;= Math.PI / 2) &#123;</div><div class="line">					//Clockwise if angle is less than 90 degrees</div><div class="line">					clockwiseness = &quot;clockwise&quot;;</div><div class="line">				&#125; else &#123;</div><div class="line">					clockwiseness = &quot;counterclockwise&quot;;</div><div class="line">				&#125;</div><div class="line"></div><div class="line">		 * 计算旋转手势转过的角度：</div><div class="line">		 * float sweptAngle = 0;//初始化角度为零</div><div class="line"></div><div class="line">                // 计算从上一帧到这一帧的角度</div><div class="line">				if (circle.State != Gesture.GestureState.STATE_START) &#123;</div><div class="line">					CircleGesture previousUpdate = new CircleGesture (controller.Frame (1).Gesture (circle.Id));</div><div class="line">					sweptAngle = (circle.Progress - previousUpdate.Progress) * 360;</div><div class="line">				&#125;</div><div class="line"></div><div class="line">				WriteLine (&quot;  Circle id: &quot; + circle.Id</div><div class="line">                               + &quot;, &quot; + circle.State</div><div class="line">                               + &quot;, progress: &quot; + circle.Progress</div><div class="line">                               + &quot;, radius: &quot; + circle.Radius</div><div class="line">                               + &quot;, angle: &quot; + sweptAngle</div><div class="line">                               + &quot;, &quot; + clockwiseness);</div><div class="line"></div><div class="line">		 *</div><div class="line">		 *</div><div class="line">		 *</div><div class="line">		 */</div></pre></td></tr></table></figure>
<p><strong>手势脚本部分引路工作基本完成</strong></p>
<p>下面介绍另一个比较重要的脚本</p>
<p>2.HandController.cs<br>这个脚本是leapmotion核心之一  上面脚本中多数方法  从handcontroller这个脚本中调用所以<br>为了方便与满足我们的开发需求  对这个脚本的改动是最方便的  但是鉴于接近500line的体量  我不可能一一讲请  所以挑重点：也就是我们刚刚所提到的 frame</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">public Frame GetFrame() &#123;</div><div class="line">  if (enableRecordPlayback &amp;&amp; recorder_.state == RecorderState.Playing)</div><div class="line">    return recorder_.GetCurrentFrame();</div><div class="line"></div><div class="line">  return leap_controller_.Frame();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>也就是说  我们使用的get frame() 原型在这里  所做的也就是从更深层的leap_controller()中获取<br>但是  我们细心就会发现  这是个方法  所以  我们可以举一反三</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">public Frame getlastframe(int i)&#123;return leap_controller_.Frame (i);&#125;</div></pre></td></tr></table></figure>
<p>通过这个定义  我们就可以在今后的脚本中直接使用自己的getlastframe()获取自己想要的帧<br>如果想要上一帧  那就hc.getlastframe(1)就好了</p>
<blockquote>
<p>tips：  如果你想设计效果更好的手势建议去通读handcontroller 以及与之相关有继承关系的脚本</p>
</blockquote>
<hr>
<p><strong>基于本节所讲的设计框架：</strong><br>我们可以根据所给代码设计一系列的动作  去做一些触发 模拟  控制<br>至于剩下的内容  多着眼于  代码优化  动作设计<br>更多的是一些关于渲染器  着色器 触发器 等等的内容<br>本周内容较多  请多做练习</p>
<blockquote>
<p>good bye next week （or next year）</p>
<h4 id="本周-我们着重将讲解代码的优化问题"><a href="#本周-我们着重将讲解代码的优化问题" class="headerlink" title="本周  我们着重将讲解代码的优化问题"></a>本周  我们着重将讲解代码的优化问题</h4></blockquote>
<p>首先<br>经过了上周我们  讲解的代码框架  以及设计规则  我们都有了足够的手法去设计一些自己想要的动作  但是  在一番编写之后  你肯定会发现  有很多方面并不能达到你设想的那样  其中涉及的一些很隐性的问题  表述起来比较繁杂  因此  我将会更多的以图片来展示问题  那些比较动态的问题 将会很难理解  所以  你应该尝试着跟着我的描述去做  </p>
<hr>
<p>其次<br> 一些有问题的代码  因为我们的开发过程没有版本更替  所以一些有问题的代码没有保存  我只能从比较显眼的问题入手</p>
<hr>
<h3 id="第一点："><a href="#第一点：" class="headerlink" title="第一点："></a>第一点：</h3><p><strong>世界坐标</strong><br>我们之前提到过的世界坐标的问题  我也附上了代码  想了解的可以去看之前的博客   但是没有细讲  下面着重来说这个问题</p>
<p>根据上次提供的脚本  新建一个脚本将代码复制附在摄像机上  然后新建一个cube  将物体与代码重定义的物体绑定<br>我们将两个方块一个初始化在（000）点，一个初始化在（020）点<br><img src="http://img.blog.csdn.net/20151224151423578" alt="reset"></p>
<hr>
<p>下面我们修改脚本</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">if(Input.GetKey(KeyCode.UpArrow))</div><div class="line">&#123;</div><div class="line">	Debug.Log (&quot;up&quot;);</div><div class="line">	//this.cube.transform.Translate(0,0.1f,0,Space.World);</div><div class="line"></div><div class="line">		this.cube.transform.Translate(0f,0.1f,0f);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>以此类推  将带space.world的脚本注释  将不带spac.world的语句取消注释</p>
<p>下面我们根据所定义的按键来操作  发现上下左右都没问题  下面来旋转</p>
<p>同样的旋转系数  同样的操作  </p>
<p><img src="http://img.blog.csdn.net/20151224152016075" alt="cube"><br><img src="http://img.blog.csdn.net/20151224152031781" alt="cube1"></p>
<p>他们的坐标系根本不一致！！！这时候  我们再去操纵他们前后左右</p>
<p><img src="http://img.blog.csdn.net/20151224152220792" alt="看"></p>
<p>我们分别点选坐标系就能看出端倪    世界坐标的作用是统一采用世界的坐标系来规定物体的旋转   如果不指定  物体的变换则是根据自身的坐标来的  所以经过旋转的物体  他们的运动在自己的坐标系内  很可能出现和你的坐标系相反  你输入的指令  是左  他却往右跑  正所以  世界坐标是规范物体运动的最好方法</p>
<h3 id="第二点："><a href="#第二点：" class="headerlink" title="第二点："></a>第二点：</h3><h4 id="awake"><a href="#awake" class="headerlink" title="awake"></a>awake</h4><p> 这点其实没什么好展示  因为这是unity开发中常会遇到的问题<br> 脚本执行顺序说明：<br>    先执行所有子脚本中的awake();<br>    在执行所有脚本中的start();<br>    然后执行所有update();<br>    当所有脚本中的update();执行一遍之后，则执行fixupdate();和lateupdate();<br>    即unity中没有多线程概念<br>    且如果在awake中掺杂了关于获取对象的定义<br>    那么脚本之间执行顺序不同就有可能出现空指针</p>
<h3 id="第三点-："><a href="#第三点-：" class="headerlink" title="第三点 ："></a>第三点 ：</h3><h4 id="触发网格"><a href="#触发网格" class="headerlink" title="触发网格"></a>触发网格</h4><p><img src="http://img.blog.csdn.net/20151224160816739" alt="middle"><br>我们从图片上可知  仅仅是触发网格  也是有一个一个简单的网格拼凑而成  </p>
<hr>
<p><strong>与之相比较我们再来看看 模型的网格的结构</strong></p>
<hr>
<p><img src="http://img.blog.csdn.net/20151224161330716" alt="mesh"></p>
<p>所以当我们设计捏取这个动作的时候  触发网格的误差足以让你发疯   所以  如果你想设计捏取动作  那么最好不要牵扯捏取的手指对物体做误差触发<br>否则  就和官方程序里  那个下国际象棋的demo和  把头拼在机器人身上那个demo体验一样差</p>
<p>我的做法是  每当捏取的两个手指  发生捏取手势的时候  在捏取点生成一个半径固定（不能太大）球体触发网格   每当物体与球体发生触发  求出触发列表  把列表中每一个物体的触发点到球心的距离  求出<br>最后把最距离最小的那个  物体设为  捏取物体<br>至于代码 ：</p>
<blockquote>
<p>nothing ~  i can’t  show that</p>
</blockquote>
<h3 id="第三点："><a href="#第三点：" class="headerlink" title="第三点："></a>第三点：</h3><h4 id="UI"><a href="#UI" class="headerlink" title="UI"></a>UI</h4><p>相信这点困扰了一些人  因为鼠标键盘 体系的UI  乃至触屏体系的UI  都是直接集成在unity的<br>我们可以方便的调用  但是  如果设计这种三维空间内的交互设计还是比较复杂的  如果没有相关文档支持  或者例子来借鉴   那么设计工作确实有些  难以展开  </p>
<p>但是我们自己探索中就会发现wight这个东西：<br>在搜索框中搜索 wight然后加载其中的设置<br>当我们运行了wight之后就可以发现两种可手势交互的组件  一个是按钮  一个是滑动条</p>
<hr>
<p><img src="http://img.blog.csdn.net/20151224174029066" alt="wight"></p>
<hr>
<p>我们仔细观察他们的组织结构  就能清晰的发现  手势设计和 UI的组织结构  设计方法  组织方法</p>
<p><em>**</em><img src="http://img.blog.csdn.net/20151224174830116" alt="组织结构"></p>
<p>经过观察</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">using UnityEngine;</div><div class="line">using System.Collections;</div><div class="line">using LMWidgets;</div></pre></td></tr></table></figure>
<p>我们可以首先发现  这个系列的脚本有着多层的继承关系</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">protected override void Start()</div><div class="line">&#123;</div><div class="line">  base.Start();</div><div class="line">&#125;</div><div class="line"></div><div class="line">protected override void FixedUpdate()</div><div class="line">&#123;</div><div class="line">  base.FixedUpdate();</div><div class="line">  UpdateGraphics();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>再往源头去</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">using UnityEngine;</div><div class="line">using System;</div><div class="line">using System.Collections;</div><div class="line"></div><div class="line">namespace LMWidgets</div><div class="line">&#123;</div><div class="line">  public abstract class SliderBase : LeapPhysicsSpring, AnalogInteractionHandler&lt;float&gt;, IDataBoundWidget&lt;SliderBase, float&gt;</div><div class="line">  &#123;</div><div class="line">    protected DataBinderSlider m_dataBinder;</div><div class="line"></div><div class="line">    // Binary Interaction Handler - Fires when interaction with the widget starts.</div><div class="line">    public event EventHandler&lt;LMWidgets.EventArg&lt;float&gt;&gt; StartHandler;</div><div class="line">    // Analog Interaction Handler - Fires while widget is being interacted with.</div><div class="line">    public event EventHandler&lt;LMWidgets.EventArg&lt;float&gt;&gt; ChangeHandler;</div><div class="line">    // Binary Interaction Handler - Fires when interaction with the widget ends.</div><div class="line">    public event EventHandler&lt;LMWidgets.EventArg&lt;float&gt;&gt; EndHandler;</div><div class="line"></div><div class="line">    public GameObject upperLimit;</div><div class="line">    public GameObject lowerLimit;</div><div class="line"></div><div class="line">    protected float m_localTriggerDistance;</div></pre></td></tr></table></figure>
<p>源头上LMxxxx的这些代码  的含义其实我们不必去细究  如果你没有涉及高层次的变动  复制粘贴 就好了    这种UI设计工作  说起来是个繁杂的工作  因此往往脚本的编写更加要求成体系  结构明了   所以要比功能编写付出充分的耐心  这些问题  不难  但是极其细致  繁复</p>
<p>我们要掌握的是设计思想  即  我们需要  熟悉button/slider的脚本   以及相关UI元素的使用</p>
<p>我们以button为例看一下这个设计该怎么展开</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line">using UnityEngine;</div><div class="line">using UnityEngine.UI;</div><div class="line">using System.Collections;</div><div class="line"></div><div class="line"></div><div class="line">public class ButtonDemoGraphics : MonoBehaviour</div><div class="line">&#123;</div><div class="line">	public void SetActive(bool status)</div><div class="line">	&#123;</div><div class="line">		Renderer[] renderers = GetComponentsInChildren&lt;Renderer&gt;();</div><div class="line">		Text[] texts = GetComponentsInChildren&lt;Text&gt;();</div><div class="line">		Image[] GUIimages = GetComponentsInChildren&lt;Image&gt;();</div><div class="line"></div><div class="line">		foreach (Renderer renderer in renderers)</div><div class="line">		&#123;</div><div class="line">			renderer.enabled = status;</div><div class="line">		&#125;</div><div class="line">		foreach(Text text in texts)&#123;</div><div class="line">			text.enabled = status;</div><div class="line">		&#125;</div><div class="line">		foreach(Image image in GUIimages)&#123;</div><div class="line">			image.enabled = status;</div><div class="line">		&#125;</div><div class="line"></div><div class="line">	&#125;</div><div class="line"></div><div class="line">	public void SetColor(Color color)//这个不用我说了吧</div><div class="line">	&#123;</div><div class="line">		Renderer[] renderers = GetComponentsInChildren&lt;Renderer&gt;();</div><div class="line">		Text[] texts = GetComponentsInChildren&lt;Text&gt;();</div><div class="line">		Image[] GUIimages = GetComponentsInChildren&lt;Image&gt;();</div><div class="line">		//获取组件  </div><div class="line">		foreach (Renderer renderer in renderers)</div><div class="line">		&#123;</div><div class="line">			renderer.material.color = color;</div><div class="line">		&#125;</div><div class="line">		foreach (Text text in texts)&#123;</div><div class="line">			text.color = color;</div><div class="line">		&#125;</div><div class="line">		foreach(Image image in GUIimages)&#123;</div><div class="line">			image.color = color;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>在以上这个命名空间里  我们可以看出  他的思路是  这个脚本中完成和定义的工作  都是为了  button的绘图做准备  设置颜色  设置样式如何如何<br>再看下一个</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div></pre></td><td class="code"><pre><div class="line">using UnityEngine;</div><div class="line">using System.Collections;</div><div class="line">using LMWidgets;</div><div class="line"></div><div class="line">public class ButtonDemoToggle : ButtonToggleBase</div><div class="line">&#123;</div><div class="line">  public ButtonDemoGraphics onGraphics;</div><div class="line">  public ButtonDemoGraphics offGraphics;</div><div class="line">  public ButtonDemoGraphics midGraphics;</div><div class="line">  public ButtonDemoGraphics botGraphics;</div><div class="line"></div><div class="line">  public Color MidGraphicsOnColor = new Color(0.0f, 0.5f, 0.5f, 1.0f);</div><div class="line">  public Color BotGraphicsOnColor = new Color(0.0f, 1.0f, 1.0f, 1.0f);</div><div class="line">  public Color MidGraphicsOffColor = new Color(0.0f, 0.5f, 0.5f, 0.1f);</div><div class="line">  public Color BotGraphicsOffColor = new Color(0.0f, 0.25f, 0.25f, 1.0f);</div><div class="line"></div><div class="line"></div><div class="line">  public override void ButtonTurnsOn()</div><div class="line">  &#123;</div><div class="line">    TurnsOnGraphics();</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  public override void ButtonTurnsOff()</div><div class="line">  &#123;</div><div class="line">    TurnsOffGraphics();</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  private void TurnsOnGraphics()</div><div class="line">  &#123;</div><div class="line">    onGraphics.SetActive(true);</div><div class="line">    offGraphics.SetActive(false);</div><div class="line">	midGraphics.SetColor(MidGraphicsOnColor);</div><div class="line">	botGraphics.SetColor(BotGraphicsOnColor);</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  private void TurnsOffGraphics()</div><div class="line">  &#123;</div><div class="line">    onGraphics.SetActive(false);</div><div class="line">    offGraphics.SetActive(true);</div><div class="line">	midGraphics.SetColor(MidGraphicsOffColor);</div><div class="line">	botGraphics.SetColor(BotGraphicsOffColor);</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  private void UpdateGraphics()</div><div class="line">  &#123;</div><div class="line">    Vector3 position = transform.localPosition;</div><div class="line">    position.z = Mathf.Min(position.z, m_localTriggerDistance);</div><div class="line">    onGraphics.transform.localPosition = position;</div><div class="line">    offGraphics.transform.localPosition = position;</div><div class="line">    Vector3 bot_position = position;</div><div class="line">    bot_position.z = Mathf.Max(bot_position.z, m_localTriggerDistance - m_localCushionThickness);</div><div class="line">    botGraphics.transform.localPosition = bot_position;</div><div class="line">    Vector3 mid_position = position;</div><div class="line">    mid_position.z = (position.z + bot_position.z) / 2.0f;</div><div class="line">    midGraphics.transform.localPosition = mid_position;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  protected override void Start()</div><div class="line">  &#123;</div><div class="line">    base.Start();//</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  protected override void FixedUpdate()</div><div class="line">  &#123;</div><div class="line">    base.FixedUpdate();//</div><div class="line">    UpdateGraphics();//</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><img src="http://img.blog.csdn.net/20151224181508995" alt="button1"></p>
<p>我们通过鼠标停留就可以发现  这些继承关系的源头</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">protected override void Start() &#123;</div><div class="line">     if ( m_dataBinder != null ) &#123;</div><div class="line">       setButtonState(m_dataBinder.GetCurrentData(), true); // Initilize widget value</div><div class="line">     &#125;</div><div class="line">     else &#123;</div><div class="line">       setButtonState(false, true);</div><div class="line">     &#125;</div><div class="line">   &#125;</div></pre></td></tr></table></figure>
<p>所以我们可以用这种方法探究整个UIwight的工作机制   在这种情况下  我们可以清楚的认识到   整个UI的脚本资源之间的组织形式   和生动了解  总结编写方法  甚至官方这些  方法可以被我们复用以达到  真正的设计我们的新的  手势交互UI<br><img src="http://img.blog.csdn.net/20151224182317587" alt="这里写图片描述"></p>
<p>以上图来看   在世界坐标视野中  我们可以看到  UI都被拥有box cllider 不同形式的UI设计  有着 不同的触发器样式  思路一下子就变得很清晰     在  三维的组织形式下  触发器的  工作形式需要好好调整   普遍是一个拥有冗余度的触发器  并且触发器的位置可以被推动  很好的模拟了现实世界的情况</p>
<hr>
<blockquote>
<p>在2016年三月  左右  我会写一套  手势识别 UI设计框架  所以一些 代码能力稍弱的童鞋 尽请期待</p>
</blockquote>
<p>因为这个问题是个可以无限被讨论的问题  所以剩下的  更多的探索工作留给读者   我只是  指引一条方向供大家参考因此   如果有更好的方式也请加入qq群我们一起讨论</p>
<blockquote>
<p>343074971</p>
</blockquote>
<h3 id="第四点："><a href="#第四点：" class="headerlink" title="第四点："></a>第四点：</h3><h4 id="缩放手势"><a href="#缩放手势" class="headerlink" title="缩放手势"></a>缩放手势</h4><p>我对这个功能的编写出现了很多延伸版本<br>一开始的想法是  调用上一帧  和这一帧的双手位置进行计算    差值为正则放大  差值为负则缩小<br>但是我显然高估了我对执行顺序的把控能力  基本上这个思路需要脚本的控制能力达到炉火纯青的地步才会写对  后期  对数据的检查发现   这个差距实在是太小以及上一帧的数据重复性导致的判断进程根本无法控制</p>
<p>后来又想了一个双手向量相加取模的类似的想法  但是也因为精度等等  原因  失败</p>
<p>经过多次的 实验  测试  记录   我发现  270是一个比较合适的  取值<br>因此 针对双手的绝对距离  来设计这个缩放手势</p>
<p>最后又发现  这个方式不符合人的操作 又返回对比相对值的思路   最后  更改了  leap的传值方式   在当前帧  计算   前一帧得手的距离   和当前帧  手的距离  进行对比  最后实现了一个  比较好的结果</p>
<p>定义</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">Hand lefthand=null;</div><div class="line">Hand righthand = null;</div><div class="line">Hand last_lefthand = null;</div><div class="line">Hand last_righthand = null;</div><div class="line">bool lefthandexist = false;//判断左右手是否在场景中存在</div><div class="line">bool righthandexist = false;</div><div class="line">double scale=0f;</div><div class="line">double dis=0f;</div><div class="line">double last_dis= 0f;</div><div class="line">double handdis(Hand a,Hand b)</div><div class="line">&#123;</div><div class="line">	double c=Math.Sqrt (Math.Pow ((a.PalmPosition.x-b.PalmPosition.x), 2) + Math.Pow ((a.PalmPosition.y-b.PalmPosition.y), 2) + Math.Pow ((a.PalmPosition.z-b.PalmPosition.z), 2));</div><div class="line">	return c;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div></pre></td><td class="code"><pre><div class="line">//左右手模块_________________________________________________________________________________________________________</div><div class="line"></div><div class="line"></div><div class="line">		foreach (var h in hc.GetFrame().Hands) &#123;</div><div class="line"></div><div class="line">			if (h.IsLeft) &#123;</div><div class="line">				lefthandexist = true;</div><div class="line">				lefthand = h;</div><div class="line">				Debug.Log (&quot;lefthand exist? =&quot; + lefthandexist);</div><div class="line">				Debug.Log (&quot;lefthand position=&quot; + lefthand.PalmPosition);</div><div class="line">				Debug.Log (&quot;lefthand squize?=&quot; + squize (lefthand.SphereRadius));</div><div class="line"></div><div class="line"></div><div class="line">			&#125;</div><div class="line">			if (h.IsRight) &#123;</div><div class="line">				righthandexist = true;</div><div class="line">				righthand = h;</div><div class="line">				Debug.Log (&quot;righthandexist? =&quot; + righthandexist);</div><div class="line">				Debug.Log (&quot;righthand position=&quot; + righthand.PalmPosition);</div><div class="line">				Debug.Log (&quot;righthand squize?=&quot; + squize (righthand.SphereRadius));</div><div class="line"></div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line"></div><div class="line">			if((lefthandexist)&amp;&amp;(righthandexist))</div><div class="line">			&#123;</div><div class="line">				if((squize(lefthand.SphereRadius))&amp;&amp;(squize(righthand.SphereRadius)))</div><div class="line">				&#123;</div><div class="line"></div><div class="line">					foreach (Hand hand in frame.Hands)//当前帧的手</div><div class="line">					&#123;</div><div class="line">						foreach(Hand lastframe_hand in lastframe.Hands)</div><div class="line">						&#123;</div><div class="line"></div><div class="line"></div><div class="line">							if(hand.IsLeft)&#123;lefthand=hand;&#125;</div><div class="line">							if(hand.IsRight)&#123;righthand=hand;&#125;</div><div class="line">							if(lastframe_hand.IsLeft)&#123;last_lefthand=lastframe_hand;&#125;</div><div class="line">							if(lastframe_hand.IsRight)&#123;last_righthand=lastframe_hand;&#125;</div><div class="line"></div><div class="line"></div><div class="line">						&#125;</div><div class="line">				&#125;</div><div class="line">				dis=handdis(lefthand,righthand);</div><div class="line">				last_dis=handdis(last_lefthand,last_righthand);</div><div class="line">				if(dis&gt;last_dis)</div><div class="line">				&#123;Debug.Log(&quot;++++++++++&quot;);</div><div class="line">					this.cube.transform.localScale+=(new Vector3(1f,1f,1f));&#125;</div><div class="line">				if(dis&lt;last_dis)</div><div class="line">				&#123;Debug.Log(&quot;__________&quot;);</div><div class="line">					this.cube.transform.localScale+=(new Vector3(-1f,-1f,-1f));&#125;</div><div class="line">				&#125;</div><div class="line">			&#125;</div></pre></td></tr></table></figure>
<h2 id="最后："><a href="#最后：" class="headerlink" title="最后："></a>最后：</h2><p><strong>我想说一些总结的设计原则  能保证你  做出来的东西至少是有实用性的：</strong></p>
<ol>
<li>设计动作最好  符合直觉</li>
<li>如果你有着较好的  代码能力  尽量不要使用预制手势</li>
<li>不要使用识别有冲突的手势</li>
<li>不要使用工具（tool模式）</li>
<li>不要相信官方宣传的精度  shit~</li>
</ol>
<hr>
<h1 id="很"><a href="#很" class="headerlink" title="很"></a>很</h1><p>抱歉的是，之前说的LEAP/UI框架设计可能只有两篇   因为个人时间实在是不允许 这个问题如果展开去写的话  那么说写本书都是不为过的   且因为内容修改很是杂乱  所以我第一篇文章用来介绍LEAP预置ＵＩ的结构第二篇用来讲How to design&amp;build~</p>
<hr>
<p>鉴于直接涉及交互问题 因此这篇文章的受众显得很尴尬  但是相信   认真按照我之前博客学习的同学都能够理解其中的意思</p>
<blockquote>
<p>关于leap这个东西  我在第一篇文章中就提到过  ——just a toy.<br>所以只是用来开发的练手，根本别指望交互效果能够很好</p>
</blockquote>
<hr>
<p>根据我的经验来讲  手势识别的交互UI根据交互方式大概分为三种</p>
<h3 id="1，触发式操作"><a href="#1，触发式操作" class="headerlink" title="1，触发式操作"></a>1，触发式操作</h3><h3 id="2，手势操作（下一期）"><a href="#2，手势操作（下一期）" class="headerlink" title="2，手势操作（下一期）"></a>2，手势操作（下一期）</h3><h3 id="3，映射性操作（下一期）"><a href="#3，映射性操作（下一期）" class="headerlink" title="3，映射性操作（下一期）"></a>3，映射性操作（下一期）</h3><p>所以  我从最基本的触发操作ui开始入手</p>
<hr>
<h1 id="预警：这篇文章very-very-long"><a href="#预警：这篇文章very-very-long" class="headerlink" title="预警：这篇文章very very long~~"></a><strong>预警：这篇文章very very long~~</strong></h1><h1 id="入门："><a href="#入门：" class="headerlink" title="入门："></a>入门：</h1><p>从leap coreAsset当中找到</p>
<p>widght这个文件夹<br><img src="http://img.blog.csdn.net/20160402140510351" alt="widght"><br>那先找个demo运行一下吧  </p>
<h1 id="SENCES"><a href="#SENCES" class="headerlink" title="SENCES"></a>SENCES</h1><p>下的运行一下咯~</p>
<p><img src="http://img.blog.csdn.net/20160402143737067" alt="效果"></p>
<p>好  我们就由这个开始 unity UI和leap交互的前导<br>首先  我们来熟悉  官方预设的四种UI样式   分别是：</p>
<blockquote>
<p>dial\滚轮菜单</p>
<p>scrolltext\可滑动的字体</p>
<p>slider\滑动条</p>
<p>toggle button\按钮</p>
</blockquote>
<hr>
<p><img src="http://img.blog.csdn.net/20160402144717758" alt="sence"></p>
<hr>
<h3 id="当我们把这四种prefab拖入场景加以调整"><a href="#当我们把这四种prefab拖入场景加以调整" class="headerlink" title="当我们把这四种prefab拖入场景加以调整"></a><strong>当我们把这四种prefab拖入场景加以调整</strong></h3><p>再加上控制器  就算已经完整地展示了  所有的 官方预制形式</p>
<p>那么我们就来一个一个说吧</p>
<h3 id="1-最简单的scrolltext-可滑动的字体"><a href="#1-最简单的scrolltext-可滑动的字体" class="headerlink" title="1.最简单的scrolltext\可滑动的字体"></a>1.最简单的scrolltext\可滑动的字体</h3><p>这个组件的主要控制过程在这里<br>scrollhandle<br><img src="http://img.blog.csdn.net/20160402145227994" alt="scroll"></p>
<hr>
<p>我们可以看到他的结构相当简单 boxcollider检测触发  文本上下边界  和显示框上下边界  当text的上边界高于显示框的时候会以一个速度贴合回来  并且因为使用localposition 这个组件的工作不会因为坐标的颠倒而出错</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">protected virtual void ResetPivots()</div><div class="line">   &#123;</div><div class="line">     m_pivot = transform.localPosition;</div><div class="line">     if (m_target != null)</div><div class="line">       m_targetPivot = transform.parent.InverseTransformPoint(m_target.transform.position);</div><div class="line">   &#125;</div></pre></td></tr></table></figure>
<hr>
<p><img src="http://img.blog.csdn.net/20160402150248795" alt="text"></p>
<hr>
<p>针对 TEXT组件的修改  我们可以直接在inspectors中修改文字等等操作  而直接生成一个类似阅读器之类的应用</p>
<p>在脚本中我们可以看到<strong>来龙去脉</strong></p>
<p>首先是这个类<strong>LeapPhysicsBase</strong>：</p>
<p>相信有一定基础的小伙伴都知道  既然 设置了触发器  那么肯定会有  检测函数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">protected virtual void OnTriggerEnter(Collider collider)</div><div class="line">   &#123;</div><div class="line">   //检测是否是手</div><div class="line">     if (m_target == null &amp;&amp; IsHand(collider) &amp;&amp; State != LeapPhysicsState.Disabled)</div><div class="line">     &#123;</div><div class="line"></div><div class="line">       State = LeapPhysicsState.Interacting;</div><div class="line">       m_target = collider.gameObject;</div><div class="line">       ResetPivots();</div><div class="line">     &#125;</div><div class="line">   &#125;</div><div class="line"></div><div class="line"></div><div class="line">   protected virtual void OnTriggerExit(Collider collider)</div><div class="line">   &#123;</div><div class="line"></div><div class="line">     if (collider.gameObject == m_target)</div><div class="line">     &#123;</div><div class="line">       State = LeapPhysicsState.Reflecting;</div><div class="line">       m_target = null;</div><div class="line">     &#125;</div><div class="line">   &#125;</div></pre></td></tr></table></figure>
<p>以上两个函数清楚的写了<strong>触发执行</strong>的过程  那既然是检测不只是要判断是否出发  还要对造成出发的对象进行判断 是否为手于是调用了以下这个函数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">private bool IsHand(Collider collider)</div><div class="line">&#123;</div><div class="line">  return collider.transform.parent &amp;&amp; collider.transform.parent.parent &amp;&amp;       collider.transform.parent.parent.GetComponent&lt;HandModel&gt;();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>以上三个部分共同工作，就生成了最基本的触发事件</p>
<p>而整个组建的状态更改  控制  识别都放在一个FixedUpdate();里面</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">protected virtual void FixedUpdate()</div><div class="line">   &#123;</div><div class="line">     if (m_target == null &amp;&amp; State == LeapPhysicsState.Interacting)</div><div class="line">     &#123;</div><div class="line">       State = LeapPhysicsState.Reflecting;</div><div class="line">     &#125;</div><div class="line"></div><div class="line">     switch (State)</div><div class="line">     &#123;</div><div class="line">       case LeapPhysicsState.Interacting://交互</div><div class="line">         ApplyInteractions();</div><div class="line">         break;</div><div class="line">       case LeapPhysicsState.Reflecting://反映</div><div class="line">         ApplyPhysics();</div><div class="line">         break;</div><div class="line">       case LeapPhysicsState.Disabled://无</div><div class="line">         break;</div><div class="line">       default:</div><div class="line">         break;</div><div class="line">     &#125;</div><div class="line">     ApplyConstraints();</div><div class="line">   &#125;</div></pre></td></tr></table></figure>
<p>代码清晰易懂  对组件的3种状态做了规整的编写  代码结构十分清晰</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">public enum LeapPhysicsState</div><div class="line">  &#123;</div><div class="line">    Interacting, // Responsible for moving the widgets with the fingers</div><div class="line">    Reflecting, // Responsible for reflecting widget information and simulating the physics</div><div class="line">    Disabled // State in  which the widget is disabled</div><div class="line">  &#125;</div></pre></td></tr></table></figure>
<p>在不同的状态下  对应不同的执行过程  非常规整、  值得一提的是  leap官方的代码风格很适合我们去仔细钻研  其中不乏一些亮点   对于我们来说很值得借鉴  对于没有形成良好代码风格的新手来说十分值得学习</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">protected virtual void Awake()</div><div class="line">   &#123;</div><div class="line">     if (GetComponent&lt;Collider&gt;() == null)</div><div class="line">     &#123;</div><div class="line">       Debug.LogWarning(&quot;This Widget lacks a collider. Will not function as expected.&quot;);</div><div class="line">     &#125;//碰撞其检测与error/warning输出</div><div class="line">   &#125;</div></pre></td></tr></table></figure>
<p>在这个<strong>基类</strong>的脚本中  我们基本了解了这个组件的运行机理下面就来看第二个脚本<strong>ScrollBase</strong></p>
<p>这个脚本中有几个重要的常数<br>1，弹簧力（SnapSpringForce）；<br>2，阻力（drag）；<br>3，交互比例（InteractionScale）；</p>
<hr>
<p>这几个参数决定着你出发这个组件并滑动之后  多久能停下来  惯性运行的时间 等等效果<br>其中甚至运用到了一些公式运算</p>
<blockquote>
<p>m_dampingForce = Mathf.Sqrt(4.0f * SnapSpringForce);</p>
</blockquote>
<p>（阻尼/力）<br>类似这种运算 但最重要的还是定义了文本组件的上下界和显示框的上下界<br><img src="http://img.blog.csdn.net/20160402201855668" alt="text"></p>
<p>我们可以清晰地看到  在这个组件的下方  文明本下界要长的多</p>
<hr>
<p><img src="http://img.blog.csdn.net/20160402202048263" alt="特效t"></p>
<p>从<strong>文本的属性</strong>来看  我们也可以清楚地看到纵横比也可以修改文字</p>
<p>而从脚本层面我们可以看到更多的这种继承关系</p>
<p>这是基类中的</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">protected virtual void ResetPivots()</div><div class="line">   &#123;</div><div class="line">     m_pivot = transform.localPosition;</div><div class="line">     if (m_target != null)</div><div class="line">       m_targetPivot = transform.parent.InverseTransformPoint(m_target.transform.position);</div><div class="line">   &#125;</div></pre></td></tr></table></figure>
<p>这是scrollbase中的</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">protected override void ResetPivots() &#123;</div><div class="line">   base.ResetPivots();</div><div class="line">   m_contentPivot = ContentTransform.localPosition;</div><div class="line"> &#125;</div></pre></td></tr></table></figure>
<p>最后不得不佩服的是  为了实现  惯性这种细微的操作感代码的复杂程度高了不少  以至于催生了很多的计算方法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">//计算一维弹簧力</div><div class="line"> protected float calculate1DSpringForce(float offsetVector) &#123;</div><div class="line">  float springForce = offsetVector * SnapSpringForce;</div><div class="line">  float dampingForce = m_dampingForce * (m_velocity);</div><div class="line">  return springForce - dampingForce;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">protected float calculateOverrunMagnitude() &#123;</div><div class="line">//计算超过量（文本边界超过显示边界的量）</div><div class="line">   float overrunDistance = 0.0f;</div><div class="line"></div><div class="line">   // Put all positions in object space.</div><div class="line">   Vector3 localContentTop = transform.InverseTransformPoint(ContentTopBound.position);</div><div class="line">   Vector3 localContentBottom = transform.InverseTransformPoint(ContentBottomBound.position);</div><div class="line">   Vector3 localContainerTop = transform.InverseTransformPoint(ContainerTopBound.position);</div><div class="line">   Vector3 localContainerBottom = transform.InverseTransformPoint(ContainerBottomBound.position);</div><div class="line"></div><div class="line">   if (localContentTop.y &lt; localContainerTop.y) &#123;</div><div class="line">     overrunDistance = localContainerTop.y - localContentTop.y;</div><div class="line">   &#125;</div><div class="line">   else if (localContentBottom.y &gt; localContainerBottom.y) &#123;</div><div class="line">     overrunDistance = localContainerBottom.y - localContentBottom.y;</div><div class="line">   &#125;</div><div class="line"></div><div class="line">   return overrunDistance;</div><div class="line"> &#125;</div></pre></td></tr></table></figure>
<p>至于一些  基类中的状态判断循环所采用的应用方法  我只贴一个例子</p>
<blockquote>
<p> ApplyInteractions();</p>
</blockquote>
<p>基类中定义了它的抽象方法在状态循环中 当状态为</p>
<blockquote>
<p>case LeapPhysicsState.Interacting:</p>
</blockquote>
<p>时调用了ApplyInteractions();  而在scrollbase类中  整个重载了这个方法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">protected override void ApplyInteractions() &#123;</div><div class="line"></div><div class="line">  Vector3 targetInteractorPositionChange = transform.parent.InverseTransformPoint(m_target.transform.position) - m_targetPivot;</div><div class="line">  targetInteractorPositionChange *= InteractionScale;</div><div class="line">  targetInteractorPositionChange.x = 0.0f;</div><div class="line">  targetInteractorPositionChange.z = 0.0f;</div><div class="line">  Vector3 contentCurrentPosition = ContentTransform.localPosition;</div><div class="line">  Vector3 newContentPosition = m_contentPivot + targetInteractorPositionChange;</div><div class="line">  Vector3 velocity = (newContentPosition - contentCurrentPosition) / Time.deltaTime;</div><div class="line">  m_velocity = velocity.y;</div><div class="line"></div><div class="line">  ContentTransform.localPosition = newContentPosition;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>在这种结构下　　我们其实如果只是想实现一个交互　　那么还是很简单的　　但是如果想加强操控感受　改善交互效果　可以说难度非常大　已经超出了新手的能力范围　　因为其中涉及到了太多的　ＵＩ交互设计技巧　　经验和逻辑。</p>
<hr>
<p>OK~ NEXT</p>
<h1 id="2-按钮"><a href="#2-按钮" class="headerlink" title="2.按钮"></a>2.<strong>按钮</strong></h1><p><img src="http://img.blog.csdn.net/20160402204623538" alt="button"><br>照旧 我们先看他的构成  <strong>非常清晰</strong>有没有<br>四种图像分别对应</p>
<blockquote>
<p>打开状态<br>关闭状态<br>转移状态<br>通用元素</p>
</blockquote>
<p>接下来我们抛开他的素材去看代码<br>这两个类的规模就要小很多了  因为没有很复杂的交互优化  整个组件非常清爽<br>在<strong>ButtonDemoGraphics</strong>脚本中</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">public void SetActive(bool status)</div><div class="line">	&#123;</div><div class="line">		Renderer[] renderers = GetComponentsInChildren&lt;Renderer&gt;();</div><div class="line">		Text[] texts = GetComponentsInChildren&lt;Text&gt;();</div><div class="line">		Image[] GUIimages = GetComponentsInChildren&lt;Image&gt;();</div><div class="line">		foreach (Renderer renderer in renderers)</div><div class="line">		&#123;</div><div class="line">			renderer.enabled = status;</div><div class="line">		&#125;</div><div class="line">		foreach(Text text in texts)&#123;</div><div class="line">			text.enabled = status;</div><div class="line">		&#125;</div><div class="line">		foreach(Image image in GUIimages)&#123;</div><div class="line">			image.enabled = status;</div><div class="line">		&#125;</div><div class="line"></div><div class="line">	&#125;</div></pre></td></tr></table></figure>
<p>设置激活的方法显得非常干练包括对材质，图片，文字的遍历</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">public void SetColor(Color color)</div><div class="line">	&#123;</div><div class="line">		Renderer[] renderers = GetComponentsInChildren&lt;Renderer&gt;();</div><div class="line">		Text[] texts = GetComponentsInChildren&lt;Text&gt;();</div><div class="line">		Image[] GUIimages = GetComponentsInChildren&lt;Image&gt;();</div><div class="line">		foreach (Renderer renderer in renderers)</div><div class="line">		&#123;</div><div class="line">			renderer.material.color = color;</div><div class="line">		&#125;</div><div class="line">		foreach (Text text in texts)&#123;</div><div class="line">			text.color = color;</div><div class="line">		&#125;</div><div class="line">		foreach(Image image in GUIimages)&#123;</div><div class="line">			image.color = color;</div><div class="line">		&#125;</div><div class="line">	&#125;</div></pre></td></tr></table></figure>
<p>包括对颜色更改也是</p>
<p>而在对此基类调用的时候ButtonDemoToggle类这种代码结构异常的清晰明了（真的<strong>好棒！！</strong>啊）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">private void TurnsOnGraphics()</div><div class="line"> &#123;</div><div class="line">   onGraphics.SetActive(true);</div><div class="line">   offGraphics.SetActive(false);</div><div class="line">midGraphics.SetColor(MidGraphicsOnColor);</div><div class="line">botGraphics.SetColor(BotGraphicsOnColor);</div><div class="line"> &#125;</div><div class="line"></div><div class="line"> private void TurnsOffGraphics()</div><div class="line"> &#123;</div><div class="line">   onGraphics.SetActive(false);</div><div class="line">   offGraphics.SetActive(true);</div><div class="line">midGraphics.SetColor(MidGraphicsOffColor);</div><div class="line">botGraphics.SetColor(BotGraphicsOffColor);</div><div class="line"> &#125;</div></pre></td></tr></table></figure>
<p><strong>如果你想使用这个按钮  做一个状态判断的话</strong>  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">public override void ButtonTurnsOn()</div><div class="line">&#123;</div><div class="line">  TurnsOnGraphics();</div><div class="line">&#125;</div><div class="line"></div><div class="line">public override void ButtonTurnsOff()</div><div class="line">&#123;</div><div class="line">  TurnsOffGraphics();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>写在这两个方法下  的话 就能达成你的目的啦<br>比如  <strong>我想按钮显示关闭的时候的时候程序暂停运行</strong>  那就</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"></div><div class="line">public override void ButtonTurnsOff()</div><div class="line">&#123;</div><div class="line">  TurnsOffGraphics();</div><div class="line">  Debug.Break();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<p>至于替换原本的ON/OFF的UI纹理  那就不用我教了  相信  能看到这里的都会操作  我们去如何设计按键触发的过程<br>就有了一个<strong>清晰</strong>的方案</p>
<h3 id="自定义按钮样式替换元素-gt-继承以重用脚本设计-gt-自定义触发操作-gt-完成"><a href="#自定义按钮样式替换元素-gt-继承以重用脚本设计-gt-自定义触发操作-gt-完成" class="headerlink" title="自定义按钮样式替换元素 -&gt;继承以重用脚本设计-&gt;自定义触发操作-&gt;完成"></a>自定义按钮样式替换元素 -&gt;继承以重用脚本设计-&gt;自定义触发操作-&gt;完成</h3><h1 id="总结："><a href="#总结：" class="headerlink" title="总结："></a><strong>总结：</strong></h1><p>按钮为什么这里就总结了？<br>答：按钮的类继承关系非常复杂  但是  组件本身有着很好的可修改性 重用性 因此  对于这种良心 组件  我们也不用想着从 脚本角度去修改  替换按钮的外观  和样式  保留官方这种成熟的继承风格  对于我们生成  的软件的稳定性至关重要；</p>
<blockquote>
<p>public abstract class ButtonToggleBase : ButtonBase, BinaryInteractionHandler &lt; bool &gt; , IDataBoundWidget &lt; ButtonToggleBase, bool&gt;</p>
</blockquote>
<p>随意感受一下这个继承</p>
<h1 id="3-滑动条（slider）"><a href="#3-滑动条（slider）" class="headerlink" title="3.滑动条（slider）"></a>3.滑动条（slider）</h1><p>先看图<br><img src="http://img.blog.csdn.net/20160404172408789" alt="slider"></p>
<hr>
<p>我们可以看到  为了达成滑动条这个组件  所需要的 步骤  就多得多了<br>虽然在hierarchy里面全部展开以后很吓人的样子但是其实 只有三类</p>
<blockquote>
<p>1.top<br>2.line<br>3.dot</p>
</blockquote>
<p>我们先从top开始看<br>其实  他就是按键的马甲而已，SliderDemoGraphics负责控制这个按键的图像<br><img src="http://img.blog.csdn.net/20160404173501246" alt="top"></p>
<blockquote>
<p>top的结构从这个拆分能清楚的看清每个部分<br> toplayer：圆点按钮中心<br> midlayer：填充材质（slidersecondary）<br>botlayer：选定高亮边框</p>
</blockquote>
<p>所以在这个类当中  我们会看到按钮中出现过的套路</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">public void SetActive(bool status)</div><div class="line"> &#123;</div><div class="line">   Renderer[] renderers = GetComponentsInChildren&lt;Renderer&gt;();</div><div class="line">   foreach (Renderer renderer in renderers)</div><div class="line">   &#123;</div><div class="line">     renderer.enabled = status;</div><div class="line">   &#125;</div><div class="line"> &#125;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">public void SetColor(Color color)</div><div class="line"> &#123;</div><div class="line">   Renderer[] renderers = GetComponentsInChildren&lt;Renderer&gt;();</div><div class="line">   foreach (Renderer renderer in renderers)</div><div class="line">   &#123;</div><div class="line">     renderer.material.color = color;</div><div class="line">   &#125;</div><div class="line"> &#125;</div></pre></td></tr></table></figure>
<p>Top的构成很简单  但是整个滑动条还是比较复杂的  就是因为这个类SliderDemo的继承SliderBase又继承于 LeapPhysicsSpring 这种继承关系导致我们想从自上而下的修改功能变得不是那么容易<br>而我们只能从底层向上寻找<br>Sliderdemo：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">protected override void sliderPressed()</div><div class="line">&#123;</div><div class="line">//按下</div><div class="line">  base.sliderPressed();</div><div class="line">  PressedGraphics();</div><div class="line">&#125;</div><div class="line"></div><div class="line">protected override void sliderReleased()</div><div class="line">&#123;</div><div class="line">//释放</div><div class="line">  base.sliderReleased();</div><div class="line">  ReleasedGraphics();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>这两个函数描述了按下后和释放后的指令  所以从这里来看  我们可以把一切我们想要的滑动条的按钮触发释放 来激活的事件  写在这两个方法里</p>
<p>最重要的检查触发被放在了高一级的类Sliderbase中的CheckTrigger()方法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">private void CheckTrigger()</div><div class="line">    &#123;</div><div class="line">      if (State == LeapPhysicsState.Interacting) &#123;</div><div class="line">      //状态确定</div><div class="line">        fireSliderChanged (GetSliderFraction ());</div><div class="line">        if (m_dataBinder != null) &#123;</div><div class="line">          m_dataBinder.SetCurrentData (GetSliderFraction ());</div><div class="line">        &#125;</div><div class="line">      &#125;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>而最根本的监听来自于一个诡异的方法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">private void onStateChanged(object sender, EventArg&lt;LeapPhysicsState&gt; arg) &#123;</div><div class="line">      if ( arg.CurrentValue == LeapPhysicsState.Interacting ) &#123;</div><div class="line">        sliderPressed();//按下</div><div class="line">      &#125;</div><div class="line">      else if ( arg.CurrentValue == LeapPhysicsState.Reflecting ) &#123;</div><div class="line">        sliderReleased();//释放</div><div class="line">      &#125;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p><strong>EventArg</strong>是包含事件数据的类的基类，而onStateChanged()方法中前者是一个对象（<strong>其实这里传递的是对象的引用，如button的click事件则sender就是button，相信有过c#/xaml/winfrom/编程经验得同学都见到过这个用法</strong>），后面是包含事件数据的类的基类。<br>而在这个代码中sender就是leap中的一个对象  后面的基类将状态参数CurrentValue 表达出来</p>
<hr>
<p>讲完了触发那么现在该进一步了<br>arg.CurrentValue同时将修改State的值  这个值相当于整个类中的状态参量   代表按钮是否被按下</p>
<p>而在这个脚本中  还要根据state的值来进行更多的操作</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">public enum LeapPhysicsState</div><div class="line"> &#123;</div><div class="line">   Interacting, //手指等  触发按钮</div><div class="line">   Reflecting, //模拟物理特性 从触发被改变回到预置位置</div><div class="line">   Disabled // 关闭（正常）状态</div><div class="line"> &#125;</div></pre></td></tr></table></figure>
<p>.Enum 类型是所有枚举类型的抽象基类（它是一种与枚举类型的基础类型不同的独特类型）<br>这里用到enum来准确描述状态  使得代码清晰易懂 易于维护</p>
<p>所以  当我们找到FixedUpdate中的UpdateGraphics()方法后<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line">private void UpdateGraphics()</div><div class="line">  &#123;</div><div class="line">    float handleFraction = GetHandleFraction();</div><div class="line">    Vector3 topPosition = transform.localPosition;</div><div class="line">    topPosition.x = 0f;</div><div class="line">    topPosition.y = 0f;</div><div class="line">    topPosition.z -= (1.0f - handleFraction) * 0.25f;</div><div class="line">    topPosition.z = Mathf.Min(topPosition.z, -0.003f); // -0.003 为保证dots和top永不相交的中间层</div><div class="line">    topLayer.transform.localPosition = topPosition;</div><div class="line"></div><div class="line">    Vector3 botPosition = transform.localPosition;</div><div class="line">    botPosition.x = 0f;</div><div class="line">    topPosition.y = 0f;</div><div class="line">    botPosition.z = -0.001f;</div><div class="line">    botLayer.transform.localPosition = botPosition;</div><div class="line"></div><div class="line">    midLayer.transform.localPosition = (topPosition + botPosition) / 2.0f;</div><div class="line">//___________________________________________________________________</div><div class="line">    if (activeBar)</div><div class="line">    &#123;</div><div class="line">      UpdateActiveBar();//激活</div><div class="line">    &#125;</div><div class="line">    //______________________________________________________________________</div><div class="line">    if (numberOfDots &gt; 0)</div><div class="line">    &#123;</div><div class="line">      UpdateDots();//根据bot的位置判断</div><div class="line">    &#125;</div><div class="line">  &#125;</div></pre></td></tr></table></figure></p>
<hr>
<p>在此我们只从Dot展开去讲  因为其他的过程基本上是  八九不离十<br>在</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">private void UpdateDots()</div><div class="line">  &#123;</div><div class="line">    for (int i = 0; i &lt; dots.Count; ++i)</div><div class="line">    &#123;//dot的数量  根据此位置dot的x坐标 和 top的x轴自身坐标对比判断 来逐个绘制 小于高亮  大于常亮</div><div class="line">      if (dots[i].transform.localPosition.x &lt; transform.localPosition.x)</div><div class="line">      &#123;</div><div class="line">        Renderer[] renderers = dots[i].GetComponentsInChildren&lt;Renderer&gt;();</div><div class="line">        foreach (Renderer renderer in renderers)</div><div class="line">        &#123;</div><div class="line">		  renderer.material.color = DotsOnColor;</div><div class="line">          renderer.material.SetFloat(&quot;_Gain&quot;, 3.0f);//高亮</div><div class="line">        &#125;</div><div class="line">      &#125;</div><div class="line">      else</div><div class="line">      &#123;</div><div class="line">        Renderer[] renderers = dots[i].GetComponentsInChildren&lt;Renderer&gt;();</div><div class="line">        foreach (Renderer renderer in renderers)</div><div class="line">        &#123;</div><div class="line">          renderer.material.color = DotsOffColor;</div><div class="line">          renderer.material.SetFloat(&quot;_Gain&quot;, 1.0f);//常亮</div><div class="line">        &#125;</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  &#125;</div></pre></td></tr></table></figure>
<hr>
<p>而我们在先前的inspector中也看到了DotsOnColor/DotsOffColor<br><img src="http://img.blog.csdn.net/20160406123735485" alt="dot"></p>
<p>在其他部分的调用中  和Dots的绘制如出一辙  基本都是结合状态参量来进行判断  例如</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">public void SetWidgetValue(float value) &#123;</div><div class="line">     if ( State == LeapPhysicsState.Interacting || State == LeapPhysicsState.Disabled ) &#123; return; &#125; // 使得状态在交互过程中稳定</div><div class="line">     SetPositionFromFraction (value);</div><div class="line">   &#125;</div></pre></td></tr></table></figure>
<p>那么最后来看这个LeapPhysicsBase类中<strong>state</strong>的<strong>终极</strong>目的：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">protected virtual void FixedUpdate()</div><div class="line">&#123;</div><div class="line">  if (m_target == null &amp;&amp; State == LeapPhysicsState.Interacting)</div><div class="line">  &#123;</div><div class="line">    State = LeapPhysicsState.Reflecting;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  switch (State)</div><div class="line">  &#123;</div><div class="line">    case LeapPhysicsState.Interacting://交互状态</div><div class="line">      ApplyInteractions();</div><div class="line">      break;</div><div class="line">    case LeapPhysicsState.Reflecting://从交互状态返回正常状态</div><div class="line">      ApplyPhysics();</div><div class="line">      break;</div><div class="line">    case LeapPhysicsState.Disabled://关闭（正常）状态</div><div class="line">      break;</div><div class="line">    default:</div><div class="line">      break;</div><div class="line">  &#125;</div><div class="line">  ApplyConstraints();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>这是一个大写的清晰明了  之前对State枚举类型在这里一下就亮了<br>用Switch来确定状态执行相应状态的方法集</p>
<p>至此  总分总式的把Solider说完了  已经  洋洋洒洒的说了1w字了  那么  我就继续吧</p>
<h1 id="滚轮-表盘（Dial）"><a href="#滚轮-表盘（Dial）" class="headerlink" title="滚轮/表盘（Dial）"></a>滚轮/表盘（Dial）</h1><p>照例先看图：<br><img src="http://img.blog.csdn.net/20160406132608755" alt="dial"></p>
<hr>
<p>从trigger的网格来看就非常的复杂  所以要是自己想设计一个这种手势操作的UI组件  可以说难度<strong>非常</strong>大<br>并且  坦白说 这个组件如果不经过自定义或者修改非常的华而不实 因为  他的选项实在是太多了  多到你手退出操作区域的时候   都会产生误操作</p>
<p>那么我们就先从可见外观结构说起</p>
<p><img src="http://img.blog.csdn.net/20160406135032436" alt="dial2"></p>
<hr>
<blockquote>
<p>1.picker//选择器<br>2.maskpanel//荫罩面<br>3.backpanel //背景面</p>
</blockquote>
<p>更进一步：</p>
<p><img src="http://img.blog.csdn.net/20160406135603454" alt="dial3"></p>
<h3 id="从这开始就开始有意思了起来"><a href="#从这开始就开始有意思了起来" class="headerlink" title="从这开始就开始有意思了起来"></a>从这开始就开始有意思了起来</h3><p>首先 这是两个collider  小的这个被设置为滚轮上的字在这个区域被显示为高亮（HighLight）<br>HilightTextVolume这个类中  清晰的表明了这一点  通过  触发器trigger的三个函数  巧妙的控制了字体的高亮显示</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"> //进入</div><div class="line"> void OnTriggerEnter(Collider other) &#123;</div><div class="line"> 		Text text = other.GetComponentInChildren&lt;Text&gt;();</div><div class="line">    if (text == null) &#123; return; &#125;</div><div class="line">		text.color = Color.white;</div><div class="line">	&#125;</div><div class="line">//保持</div><div class="line">	void OnTriggerStay(Collider other)&#123;</div><div class="line">		Text text = other.GetComponentInChildren&lt;Text&gt;();</div><div class="line">    if (text == null) &#123; return; &#125;</div><div class="line">		text.color = Color.white;</div><div class="line">		CurrentHilightValue = text.text;</div><div class="line">	&#125;</div><div class="line">	//离开</div><div class="line">	void OnTriggerExit(Collider other) &#123;</div><div class="line">    Text text = other.GetComponentInChildren&lt;Text&gt; ();</div><div class="line">    if (text == null) &#123; return; &#125;</div><div class="line">    text.color = textColor;</div><div class="line">	&#125;</div></pre></td></tr></table></figure>
<p>这给我们提供了一个设计技巧  对于UI设计提升期的童鞋来说  是个相当有用的模式<br>进入-&gt;保持-&gt;离开<br>     |<strong><strong><strong><strong><strong><strong>__</strong></strong></strong></strong></strong></strong>|</p>
<p>而之后的用于隐藏的collider原理几乎一致在DatePickerHideVolume类中：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">void OnTriggerEnter(Collider other) &#123;</div><div class="line">   Text text = other.GetComponentInChildren&lt;Text&gt; ();</div><div class="line">   if (text == null) &#123; return; &#125;</div><div class="line">   text.enabled = false;//设置隐藏</div><div class="line">&#125;</div><div class="line"></div><div class="line">void OnTriggerExit(Collider other) &#123;</div><div class="line">   Text text = other.GetComponentInChildren&lt;Text&gt; ();</div><div class="line">   if (text == null) &#123; return; &#125;</div><div class="line">   text.enabled = true;//设置显示</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>那个大的collider  被放在转盘的圆心位置  所以转盘总有一半是被隐藏的  这样就保证了前视的时候后面的文字不会对前面的造成干扰</p>
<p>都是利用触发器来实现  但是还有个</p>
<h4 id="比较有趣"><a href="#比较有趣" class="headerlink" title="比较有趣"></a>比较有趣</h4><p>的问题  再来看图<br><img src="http://img.blog.csdn.net/20160406141206710" alt="fade"></p>
<p>我们发现  从下到上 文字的透明度越高这是怎么做到的呢？</p>
<p>首先  定义了一条曲线</p>
<blockquote>
<p> public AnimationCurve FadeCurve;</p>
</blockquote>
<p><img src="http://img.blog.csdn.net/20160406142121526" alt="curve"></p>
<hr>
<p>在曲线之后通过曲线来计算 透明值</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">float opacityMod = FadeCurve.Evaluate(referenceDotDirection);//计算不透明度模</div><div class="line">float goalOpacity = m_originalLabelOpacity * opacityMod;//目标透明度</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">  foreach(Text textComponent in m_textLabels) &#123;</div><div class="line">  //遍历设定</div><div class="line">  Color textColor = textComponent.color;</div><div class="line">  textColor.a = goalOpacity;//对文字颜色的Alpha通道进行修改</div><div class="line">  textComponent.color = textColor;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<p><strong>讲完了这个外在</strong>  再来讲内在的控制部分</p>
<blockquote>
<p>准备好受虐吧  这部分我也不太懂了  所以我尽量说我的理解  有错误请指出</p>
</blockquote>
<p>先是生成label</p>
<blockquote>
<p>public List&lt; string &gt; DialLabels;</p>
</blockquote>
<p><img src="http://img.blog.csdn.net/20160406144504223" alt="labe"></p>
<hr>
<p>根据字符串List的数量来生成label  这个数量我们当然可以确定  所以 我们想使用这个控件  的话<br>当然 应该使得这个list.count的数量趋近合理  这样不仅使得控件简洁明了  还是得交互变得更容易 准确性更高<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">private void generateAndLayoutLabels() &#123;</div><div class="line">     float currentLayoutXAngle = LabelAngleRangeStart;</div><div class="line"></div><div class="line">     for( int i=1; i&lt;=DialLabels.Count; i++ ) &#123;</div><div class="line">       Transform labelPrefab = Instantiate(LabelPrefab, DialCenter.transform.position, transform.rotation) as Transform;</div><div class="line"></div><div class="line">       //生成</div><div class="line"></div><div class="line">       labelPrefab.Rotate(currentLayoutXAngle, 0f, 0f);</div><div class="line">       LabelAngles.Add (-currentLayoutXAngle);     </div><div class="line">       labelPrefab.parent = DialCenter;</div><div class="line">       labelPrefab.localScale = new Vector3(1f, 1f, 1f);</div><div class="line">       Text labelText = labelPrefab.GetComponentInChildren&lt;Text&gt;();</div><div class="line">       labelText.text = DialLabels[i - 1];</div><div class="line">       DialLabelAngles.Add(DialLabels[i - 1], -currentLayoutXAngle);</div><div class="line">       labelText.transform.localPosition = new Vector3(0f, 0f, -DialRadius);</div><div class="line">       currentLayoutXAngle = ((Mathf.Abs(LabelAngleRangeStart) + Mathf.Abs(LabelAngleRangeEnd))/(DialLabels.Count)) * -i;</div><div class="line"></div><div class="line">       //调整</div><div class="line">     &#125;</div><div class="line"></div><div class="line">     LabelPrefab.gameObject.SetActive(false); // Turn off the original prefab that was copied.</div><div class="line">   &#125;</div></pre></td></tr></table></figure></p>
<blockquote>
<p>开始句柄<br>更改句柄<br>结束句柄<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">//模拟交互的句柄</div><div class="line">   public event EventHandler&lt;EventArg&lt;int&gt;&gt; ChangeHandler;</div><div class="line">   public event EventHandler&lt;EventArg&lt;int&gt;&gt; StartHandler;</div><div class="line">   public event EventHandler&lt;EventArg&lt;int&gt;&gt; EndHandler;</div></pre></td></tr></table></figure></p>
</blockquote>
<p>当然触发检测是必不可少的</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">   void OnTriggerEnter (Collider other)</div><div class="line">&#123;</div><div class="line">  if (target_ == null &amp;&amp; IsHand (other)) &#123;</div><div class="line">  //像之前一样确定触发体是手</div><div class="line">    target_ = other.gameObject;//旋转角</div><div class="line">    pivot_ = transform.InverseTransformPoint (target_.transform.position) - transform.localPosition;//旋转轴心</div><div class="line">    if (GetComponent&lt;Rigidbody&gt;().isKinematic == false)</div><div class="line">      transform.GetComponent&lt;Rigidbody&gt;().angularVelocity = Vector3.zero;</div><div class="line">    interacting_ = true;</div><div class="line">    if (dialGraphics)</div><div class="line">      dialGraphics.HilightDial ();</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">void OnTriggerExit (Collider other)</div><div class="line">&#123;</div><div class="line">  if (other.gameObject == target_) &#123;</div><div class="line">    EndInteraction ();//结束交互</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>从触发检测部分计算出的目标角度和旋转轴心  然后我们找到应用的方法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">protected virtual void ApplyRotations ()</div><div class="line">&#123;</div><div class="line">//旋转至目标角度</div><div class="line">  Vector3 curr_direction = transform.InverseTransformPoint (target_.transform.position) - transform.localPosition;</div><div class="line">  //轴心</div><div class="line">  transform.localRotation = Quaternion.FromToRotation (pivot_, curr_direction) * transform.localRotation;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>而这一切都在基类的FixedUpdate()中运行</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">void FixedUpdate ()</div><div class="line">&#123;</div><div class="line">  if (target_ == null &amp;&amp; interacting_) &#123;</div><div class="line">    // 当交互时手已经被销毁</div><div class="line"></div><div class="line">    EndInteraction ();//结束交互</div><div class="line">  &#125;</div><div class="line">  if (target_ != null) &#123;  </div><div class="line">    ApplyRotations ();//应用旋转</div><div class="line">  &#125;</div><div class="line">  ApplyConstraints ();//应用约束以保证交互结束后 返回相应位置</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<p>至此  一些零碎的约束我已经无力再写下去了  就来归纳一下组件共同拥有的一些特性：</p>
<blockquote>
<p><strong>1.触发检测用于检测手和组件的交互  同时一般返回 ：</strong><br> <strong>触发初始信息</strong><br> <strong>触发过程信息</strong><br> <strong>触发结束信息</strong></p>
<p><strong>2.约束条件：</strong><br><strong>一般含有交互产生的改变量</strong><br><strong>交互后根据规则的对改变量的判断</strong><br><strong>对判断结果的执行</strong></p>
<p><strong>3.静止状态：</strong><br><strong>一般含有系统用于初始化的初始量</strong><br><strong>对于不产生交互状态下的静态量</strong><br><strong>一般为产生触发后约束条件的结果</strong></p>
</blockquote>
<hr>
<h2 id="至此"><a href="#至此" class="headerlink" title="至此"></a>至此</h2><p>我们讲完了所有四个预置控件的结构与应用方法<br>为我们在unity3D引擎中设计 VR/AR环境下的交互逻辑铺平了道路；<br>但是很明显的是  在VR环境中设计交互操作明显有一定的方法论  触发设计，特效设计，逻辑设计每个部分单独拿出来都可以写一本书  并且在讲求经验的情况下  这和以前的UI设计相去甚远  平面UI的难度因为操控体系的健全而变得较为容易  但在三维环境下  无论是对手的模拟  还是对现实环境的模拟  都使得UI设计变得没有统一规则<br>你可以虚拟出一个平面实现来类触屏操作而套用平面UI的设计方法<br>更可以通过虚拟物体来体现虚拟现实技术的优势 这就使得设计变得无限可能<br>这两种方式并没有优劣之分  各个应用环境之下  恰当的采用  效果才是最佳的。</p>
<hr>
<p>最后  因为这系列文章过长  因此下次更新可能会在较长之后了（都是眼泪）；</p>
<h1 id="Bye-See-you-next-month"><a href="#Bye-See-you-next-month" class="headerlink" title="Bye~ See you next month~"></a>Bye~ See you next month~</h1><h3 id="过了这么久才来更这篇实在是因为项目工程量实在是不允许"><a href="#过了这么久才来更这篇实在是因为项目工程量实在是不允许" class="headerlink" title="过了这么久才来更这篇实在是因为项目工程量实在是不允许"></a>过了这么久才来更这篇实在是因为项目工程量实在是不允许</h3><p>首先声明我并不是专业的UI设计人员  我们所有的leap UI设计全部来源与项目需求 且因为项目不是商业项目  所以设计方法看起来有一种“邪门歪道”的既视感  但是为VR/AR环境中的交互设计提供了一种思路</p>
<blockquote>
<p>特别提示：以下内容并不是针对初学者而言的</p>
</blockquote>
<p>如果你是个unity/leap开发的双面小白  那么基本可以不用看这篇文章了</p>
<p>整个项目的效果可以去<a href="http://v.youku.com/v_show/id_XMTU2NzYyMTYyMA==.html?from=y1.7-1.2" target="_blank" rel="external">这里</a><strong>看视频</strong></p>
<h1 id="OK"><a href="#OK" class="headerlink" title="OK~"></a>OK~</h1><p>言归正传</p>
<p>我们先来看看效果：</p>
<p><img src="http://img.blog.csdn.net/20160518152045320" alt="sence2"></p>
<hr>
<p>这是一个用手势控制选择的界面选择的时候会根据手势的挥动方向来进行左右切换<br>也就是我们上一篇文章中提到的<strong>手势操作交互</strong>，这类操作不与UI元素进行交运算（触发）<br>所以设计起来相对独立  也就是说  这类UI元素的制作可以按照普通的UI制作方式来进行</p>
<p>所以  在整个软件中  这个UI显得最普通  但是就是普通依旧不是那么好做</p>
<p>想实现一个类似IPhone音乐的选择界面并不是那么容易<br>像这样</p>
<hr>
<p><img src="http://img.blog.csdn.net/20160518153740720" alt=""><br>这种动态效果通过静态图片无法很好地展示  但是想试想一个细微的效果实际上需要大量的工作</p>
<hr>
<p>这个UI整个比较复杂所以我只能不太完整的去讲解<br><img src="http://img.blog.csdn.net/20160518155344160" alt="目录"><br>这是它的目录结构  在某一个版本中  我曾经写了动态生成这些展示标记  但是由于数量变化会引起后面的缩放系数bug  我就改回了手动添加<br><img src="http://img.blog.csdn.net/20160518155625164" alt="text"><br>这是每个UI元素的组成  其中有些组件是不必要的主要是为了原先鼠标操作而设计<br>（ 后来整体取消了软件鼠标操作的功能  但保留了这些组件 比如碰撞器  对于一个手势操纵的UI类型来说完全是没必要的）</p>
<h3 id="所以"><a href="#所以" class="headerlink" title="所以"></a>所以</h3><p>针对这个UI元素来说  可讲的就只剩下  </p>
<blockquote>
<p>1.怎么细致的实现元素转动效果<br>2.怎么用手势控制旋转</p>
<hr>
</blockquote>
<p>一，转动效果  这其实很多demo里面都会出现  而这个实现的那我们来看看主要的结构<br><img src="http://img.blog.csdn.net/20160518160830061" alt="这里写图片描述"><br>命名清晰明了 enhance控制器  控制 gameobject(UItexture)<br>UItexture下放了一个canvas  然后canvas上有三个text组件放置三组文字<br> sprite是背景控制（这里的sprite其实就是截取图形的插件）<br> 有了六七列表我们就可以在控制器里通过代码来控制了</p>
<p><img src="http://img.blog.csdn.net/20160518161600190" alt="这里写图片描述"></p>
<p>有两个类一个 EnhancelScrollView一个 EnhanceItem<br>首先定义 EnhanceItem脚本附在每个UItexture上面 设置flag</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div></pre></td><td class="code"><pre><div class="line">using UnityEngine;</div><div class="line">using System.Collections;</div><div class="line"></div><div class="line">public class EnhanceItem : MonoBehaviour</div><div class="line">&#123;</div><div class="line"></div><div class="line">    // 在ScrollViewitem中的索引</div><div class="line">    internal int scrollViewItemIndex = 0;</div><div class="line"></div><div class="line">    // 夹角大小</div><div class="line">    internal float angla = 0f;</div><div class="line">    // 动画时间值</div><div class="line">    internal float dValueTime = 0f;</div><div class="line"></div><div class="line">    // 前后项</div><div class="line">    internal EnhanceItem front, back;</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">	/*</div><div class="line">	 *</div><div class="line">	 *</div><div class="line">	 *</div><div class="line">	 *</div><div class="line">	 *   internal关键字是类型和类型成员的访问修饰符。只有在同一个程序集的文件中，内部类型或者是成员才可以访问。</div><div class="line">	 * 这是msdn上对internal的描述。</div><div class="line">	 * 类型就是enum（枚举类型），class（类），interface（接口），struct（结构）等类型。</div><div class="line">	 * 类型成员如函数，成员变量等。</div><div class="line">	 *</div><div class="line">	 * 一个完整的.exe或者是.dll文件就是一个程序集，一般伴随着exe程序集产生的还有一个程序集清单</div><div class="line">	 * ，.exe.config文件。下面我就用一个例子来说明“internal关键字是类型和类型成员的访问修饰符。</div><div class="line">	 * 只有在同一个程序集的文件中，内部类型或者是成员才可以访问”。</div><div class="line">	 *</div><div class="line"></div><div class="line">	 *</div><div class="line">	 */</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">	public int flag = 777;//flag</div><div class="line"></div><div class="line"></div><div class="line">    private Vector3 targetPos = Vector3.one;</div><div class="line">    private Vector3 targetScale = Vector3.one;</div><div class="line"></div><div class="line">    private Transform mTrs;</div><div class="line">    private UITexture mTexture;</div><div class="line"></div><div class="line">    void Awake()</div><div class="line">    &#123;</div><div class="line">        mTrs = this.transform;</div><div class="line">        mTexture = this.GetComponent&lt;UITexture&gt;();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    void Start()</div><div class="line">    &#123;</div><div class="line">        UIEventListener.Get(this.gameObject).onClick = OnClickScrollViewItem;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    // 当点击Item，将该item移动到中间位置</div><div class="line">    private void OnClickScrollViewItem(GameObject obj)</div><div class="line">    &#123;</div><div class="line">        EnhancelScrollView.GetInstance().SetHorizontalTargetItemIndex(scrollViewItemIndex);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    /// &lt;summary&gt;</div><div class="line">    /// 更新该Item的缩放和位移</div><div class="line">    /// &lt;/summary&gt;</div><div class="line">    public void UpdateScrollViewItems(float xValue, float yValue, float scaleValue)</div><div class="line">    &#123;</div><div class="line">        targetPos.x = xValue;</div><div class="line">        targetPos.y = yValue;</div><div class="line">        targetScale.x = targetScale.y = scaleValue;</div><div class="line"></div><div class="line">        mTrs.localPosition = targetPos;</div><div class="line">        mTrs.localScale = targetScale;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public void SetSelectColor(bool isCenter)</div><div class="line">    &#123;</div><div class="line">        if (mTexture == null)</div><div class="line">            mTexture = this.GetComponent&lt;UITexture&gt;();</div><div class="line"></div><div class="line">        if (isCenter)</div><div class="line">            mTexture.color = Color.white;</div><div class="line">        else</div><div class="line">            mTexture.color = Color.gray;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>EnhancelScrollView脚本作为控制脚本附着在控制物体上<br>他就相当于每个物体</p>
<blockquote>
<p>那么手势控制：</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div><div class="line">257</div><div class="line">258</div><div class="line">259</div><div class="line">260</div><div class="line">261</div><div class="line">262</div><div class="line">263</div><div class="line">264</div><div class="line">265</div><div class="line">266</div><div class="line">267</div><div class="line">268</div><div class="line">269</div><div class="line">270</div><div class="line">271</div><div class="line">272</div><div class="line">273</div><div class="line">274</div><div class="line">275</div><div class="line">276</div><div class="line">277</div><div class="line">278</div><div class="line">279</div><div class="line">280</div><div class="line">281</div><div class="line">282</div><div class="line">283</div><div class="line">284</div><div class="line">285</div><div class="line">286</div><div class="line">287</div><div class="line">288</div><div class="line">289</div><div class="line">290</div><div class="line">291</div><div class="line">292</div><div class="line">293</div><div class="line">294</div><div class="line">295</div><div class="line">296</div><div class="line">297</div><div class="line">298</div><div class="line">299</div><div class="line">300</div><div class="line">301</div><div class="line">302</div><div class="line">303</div><div class="line">304</div><div class="line">305</div><div class="line">306</div><div class="line">307</div><div class="line">308</div><div class="line">309</div><div class="line">310</div><div class="line">311</div><div class="line">312</div><div class="line">313</div><div class="line">314</div><div class="line">315</div><div class="line">316</div><div class="line">317</div><div class="line">318</div><div class="line">319</div><div class="line">320</div><div class="line">321</div><div class="line">322</div><div class="line">323</div><div class="line">324</div><div class="line">325</div><div class="line">326</div><div class="line">327</div><div class="line">328</div><div class="line">329</div><div class="line">330</div><div class="line">331</div><div class="line">332</div><div class="line">333</div><div class="line">334</div><div class="line">335</div><div class="line">336</div><div class="line">337</div><div class="line">338</div><div class="line">339</div><div class="line">340</div><div class="line">341</div><div class="line">342</div><div class="line">343</div><div class="line">344</div><div class="line">345</div><div class="line">346</div><div class="line">347</div><div class="line">348</div><div class="line">349</div><div class="line">350</div><div class="line">351</div><div class="line">352</div><div class="line">353</div><div class="line">354</div><div class="line">355</div><div class="line">356</div><div class="line">357</div><div class="line">358</div><div class="line">359</div><div class="line">360</div><div class="line">361</div><div class="line">362</div><div class="line">363</div><div class="line">364</div><div class="line">365</div><div class="line">366</div><div class="line">367</div><div class="line">368</div><div class="line">369</div><div class="line">370</div><div class="line">371</div><div class="line">372</div><div class="line">373</div><div class="line">374</div><div class="line">375</div><div class="line">376</div><div class="line">377</div><div class="line">378</div><div class="line">379</div><div class="line">380</div><div class="line">381</div><div class="line">382</div><div class="line">383</div><div class="line">384</div><div class="line">385</div><div class="line">386</div><div class="line">387</div><div class="line">388</div><div class="line">389</div><div class="line">390</div><div class="line">391</div><div class="line">392</div><div class="line">393</div><div class="line">394</div><div class="line">395</div><div class="line">396</div><div class="line">397</div><div class="line">398</div><div class="line">399</div><div class="line">400</div><div class="line">401</div><div class="line">402</div><div class="line">403</div><div class="line">404</div><div class="line">405</div><div class="line">406</div><div class="line">407</div><div class="line">408</div><div class="line">409</div><div class="line">410</div><div class="line">411</div><div class="line">412</div><div class="line">413</div><div class="line">414</div><div class="line">415</div><div class="line">416</div><div class="line">417</div><div class="line">418</div><div class="line">419</div><div class="line">420</div><div class="line">421</div><div class="line">422</div><div class="line">423</div><div class="line">424</div><div class="line">425</div><div class="line">426</div><div class="line">427</div><div class="line">428</div><div class="line">429</div><div class="line">430</div><div class="line">431</div><div class="line">432</div><div class="line">433</div><div class="line">434</div><div class="line">435</div><div class="line">436</div><div class="line">437</div><div class="line">438</div><div class="line">439</div><div class="line">440</div><div class="line">441</div><div class="line">442</div><div class="line">443</div><div class="line">444</div><div class="line">445</div><div class="line">446</div><div class="line">447</div><div class="line">448</div><div class="line">449</div></pre></td><td class="code"><pre><div class="line">using UnityEngine;</div><div class="line">using System.Collections;</div><div class="line">using System.Collections.Generic;</div><div class="line">using Leap;</div><div class="line"></div><div class="line">// [ExecuteInEditMode]</div><div class="line">public class EnhancelScrollView : MonoBehaviour</div><div class="line">&#123;</div><div class="line">    // 含有滑动项目的面板</div><div class="line">    public GameObject enhanceScrollView;</div><div class="line"></div><div class="line">    // 缩放曲线</div><div class="line">    public AnimationCurve scaleCurve;</div><div class="line">    // 位移曲线</div><div class="line">    public AnimationCurve positionCurve;</div><div class="line">    // 动画时间</div><div class="line">    public float duration = 0.2f;</div><div class="line"></div><div class="line">    // 宽度</div><div class="line">    public float width = 800.0f;</div><div class="line">    // y轴坐标固定值(所有的item的y坐标一致)</div><div class="line">    public float yPositionValue = 46.0f;</div><div class="line"></div><div class="line">    // 中间显示目标时间线(0显示第一个，0.5显示中间一个)</div><div class="line">    public float horizontalTargetValue = 0.0f;</div><div class="line"></div><div class="line">    // 滑动起始力</div><div class="line">    public float touchStartPower = 0.5f;</div><div class="line">    // 滑动阻力</div><div class="line">    public int touchForce = 120;</div><div class="line"></div><div class="line">    // 目标对象列表</div><div class="line">    private List&lt;EnhanceItem&gt; scrollViewItems;</div><div class="line">    // 目标对象Widget脚本，用于depth排序</div><div class="line">    private List&lt;UITexture&gt; textureTargets;</div><div class="line"></div><div class="line">    // 开始X坐标</div><div class="line">    private float startXPos = 0f;</div><div class="line">    // 当前处于中间的item</div><div class="line">	public EnhanceItem centerItem;</div><div class="line">   // 当前出移动中，不能进行点击切换</div><div class="line">    private bool isInChange = false;   </div><div class="line"></div><div class="line">    // 位置动画的中间位置时间</div><div class="line">    private float positionCenterTime = 0.5f;</div><div class="line">    // 当前精度小数位</div><div class="line">    private int curACC = 4;</div><div class="line"></div><div class="line">    // 横向变量值</div><div class="line">    private float horizontalValue = 0.0f;</div><div class="line"></div><div class="line">    // 移动动画参数</div><div class="line">    private float originHorizontalValue = 0.0f;</div><div class="line">    private float currentDuration = 0.0f;</div><div class="line"></div><div class="line">    private static EnhancelScrollView instance;</div><div class="line">    internal static EnhancelScrollView GetInstance()</div><div class="line">    &#123;</div><div class="line">        return instance;</div><div class="line">    &#125;</div><div class="line">     //内部类型或成员才是可访问的</div><div class="line"></div><div class="line"></div><div class="line">	//__________________________________________________________</div><div class="line">//	动作识别部分定义</div><div class="line">	public HandController hc;</div><div class="line"></div><div class="line"></div><div class="line">	Hand lefthand=null;</div><div class="line">	Hand righthand = null;</div><div class="line">	Hand last_lefthand = null;</div><div class="line">	Hand last_righthand = null;</div><div class="line">	Frame currentFrame = null;//定义当前帧</div><div class="line"></div><div class="line"></div><div class="line">	bool lefthandexist = false;//判断左右手是否在场景中存在</div><div class="line">	bool righthandexist = false;</div><div class="line"></div><div class="line">	float sweptAngle = 0;//初始化角度为零</div><div class="line"></div><div class="line">	int mark=0;//标记  与下面的函数作用</div><div class="line">//	0代表不转动，-1代表向左转，1代表向右转</div><div class="line">	//____________________________________________________________</div><div class="line"></div><div class="line">	void checkmark(int sign)</div><div class="line">	&#123;</div><div class="line">		if (sign == 1) &#123;</div><div class="line">			SetHorizontalTargetItemIndex(centerItem.front.scrollViewItemIndex);</div><div class="line">		&#125;</div><div class="line">		if (sign == -1) &#123;</div><div class="line">			SetHorizontalTargetItemIndex(centerItem.back.scrollViewItemIndex);</div><div class="line">		&#125;</div><div class="line">		mark = 0;</div><div class="line">	&#125;</div><div class="line">	//执行转动的真正操作  检查标记从而确保只执行一次否则一次挥动将转动多次</div><div class="line"></div><div class="line"></div><div class="line">    void Awake()</div><div class="line">    &#123;</div><div class="line">        instance = this;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    void Start()</div><div class="line">    &#123;</div><div class="line"></div><div class="line">		hc.GetLeapController().EnableGesture(Gesture.GestureType.TYPECIRCLE);</div><div class="line">		hc.GetLeapController().EnableGesture(Gesture.GestureType.TYPESWIPE);</div><div class="line">		hc.GetLeapController().EnableGesture(Gesture.GestureType.TYPE_SCREEN_TAP);</div><div class="line">		hc.GetLeapController ().EnableGesture (Gesture.GestureType.TYPEKEYTAP);</div><div class="line">		hc.GetLeapController ().EnableGesture (Gesture.GestureType.TYPEINVALID);</div><div class="line">		//开启所有手势  其实在这个脚本中只开启typeswipe就够了</div><div class="line"></div><div class="line"></div><div class="line">//		____________________________________________</div><div class="line"></div><div class="line"></div><div class="line">        InitData();//初始化数据</div><div class="line"></div><div class="line">        // 设置第一个为选中状态</div><div class="line">        SetHorizontalTargetItemIndex(0);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    /// &lt;summary&gt;</div><div class="line">    /// 初始化数据</div><div class="line">    /// &lt;/summary&gt;</div><div class="line">    private void InitData()</div><div class="line">    &#123;</div><div class="line">        startXPos = -(width / 2);</div><div class="line"></div><div class="line">        scrollViewItems = new List&lt;EnhanceItem&gt;();</div><div class="line">        scrollViewItems.AddRange(enhanceScrollView.GetComponentsInChildren&lt;EnhanceItem&gt;());</div><div class="line"></div><div class="line">        if (textureTargets == null)</div><div class="line">            textureTargets = new List&lt;UITexture&gt;();</div><div class="line"></div><div class="line">        float anglaDValue = 360 / scrollViewItems.Count;</div><div class="line"></div><div class="line">        int centerIndex = scrollViewItems.Count / 2;</div><div class="line">        for (int i = 0; i &lt; scrollViewItems.Count; i++)</div><div class="line">        &#123;</div><div class="line">            scrollViewItems[i].scrollViewItemIndex = i;</div><div class="line">            scrollViewItems[i].angla = anglaDValue * i;</div><div class="line">            scrollViewItems[i].dValueTime = GetCurveTimePos(scrollViewItems[i].angla);</div><div class="line"></div><div class="line">            // 构造环形链</div><div class="line">            scrollViewItems[i].front = i == 0 ? scrollViewItems[scrollViewItems.Count - 1] : scrollViewItems[i - 1];</div><div class="line">            scrollViewItems[i].back = i == (scrollViewItems.Count - 1) ? scrollViewItems[0] : scrollViewItems[i + 1];</div><div class="line"></div><div class="line">            UITexture tmpTexture = scrollViewItems[i].gameObject.GetComponent&lt;UITexture&gt;();</div><div class="line">            textureTargets.Add(tmpTexture);</div><div class="line"></div><div class="line">            scrollViewItems[i].SetSelectColor(false);//设为选中状态 调用了enhanceitem中的方法将mtexture中的混合颜色设为白色以显示高亮</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">	//_____________________________________________________________________________________________</div><div class="line">    void Update()</div><div class="line">    &#123;</div><div class="line"></div><div class="line">        if (!isInChange)</div><div class="line">        &#123;</div><div class="line">            touch();</div><div class="line">            return;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        currentDuration += Time.deltaTime;</div><div class="line">        float percent = currentDuration / duration;</div><div class="line">        horizontalValue = Mathf.Lerp(originHorizontalValue, horizontalTargetValue, percent);</div><div class="line">        UpdateEnhanceScrollView(horizontalValue);</div><div class="line"></div><div class="line">        SortDepth();</div><div class="line"></div><div class="line">        if (currentDuration &gt; duration)</div><div class="line">        &#123;</div><div class="line">            centerItem = textureTargets[textureTargets.Count - 1].gameObject.GetComponent&lt;EnhanceItem&gt;();</div><div class="line">            centerItem.SetSelectColor(true);</div><div class="line">            isInChange = false;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    /// &lt;summary&gt;</div><div class="line">    /// 更新水平滚动</div><div class="line">    /// &lt;/summary&gt;</div><div class="line">    /// &lt;param name=&quot;fValue&quot;&gt;&lt;/param&gt;</div><div class="line">    private void UpdateEnhanceScrollView(float fValue)</div><div class="line">    &#123;</div><div class="line">        for (int i = 0; i &lt; scrollViewItems.Count; i++)</div><div class="line">        &#123;</div><div class="line">            EnhanceItem itemScript = scrollViewItems[i];</div><div class="line">            float xValue = GetXPosValue(fValue, itemScript.dValueTime);</div><div class="line">            float scaleValue = GetScaleValue(fValue, itemScript.dValueTime);</div><div class="line"></div><div class="line">            itemScript.UpdateScrollViewItems(xValue, yPositionValue, scaleValue);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    //滑动X轴增量位置</div><div class="line">    float xMoved;</div><div class="line">    private void touch()</div><div class="line">    &#123;</div><div class="line">        // 记录滑动位置</div><div class="line">        if (Input.touchCount == 1 &amp;&amp; Input.GetTouch(0).phase == TouchPhase.Moved)</div><div class="line">        &#123;</div><div class="line">            //获取手指自最后一帧的移动</div><div class="line">            float x = Input.GetTouch(0).deltaPosition.x;</div><div class="line">            xMoved = x;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        // 滑动结束时判断故事翻页</div><div class="line">        if (Input.touchCount == 1 &amp;&amp; Input.GetTouch(0).phase == TouchPhase.Ended)</div><div class="line">        &#123;</div><div class="line">            if (centerItem == null || Mathf.Abs(xMoved) &lt; touchStartPower)</div><div class="line">                return;</div><div class="line"></div><div class="line">            int count = (int)(Mathf.Abs(xMoved * scrollViewItems.Count/ touchForce)) + 1;   </div><div class="line">            int minHalfCount = Mathf.CeilToInt((float)scrollViewItems.Count / 2) - 1;</div><div class="line">            if (count &gt; minHalfCount)</div><div class="line">            &#123;</div><div class="line">                count = minHalfCount;</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            if(xMoved &gt; 0)</div><div class="line">            &#123;</div><div class="line">                SetHorizontalTargetItemIndex(GetMoveIndex(centerItem, -count));</div><div class="line">            &#125;</div><div class="line">            else if (xMoved &lt; 0)</div><div class="line">            &#123;</div><div class="line">                SetHorizontalTargetItemIndex(GetMoveIndex(centerItem, count));</div><div class="line">            &#125;</div><div class="line">            xMoved = 0;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    /// &lt;summary&gt;</div><div class="line">    /// 缩放曲线模拟当前缩放值</div><div class="line">    /// &lt;/summary&gt;</div><div class="line">    private float GetScaleValue(float sliderValue, float added)</div><div class="line">    &#123;</div><div class="line">        float scaleValue = scaleCurve.Evaluate(positionCenterTime + sliderValue + added);</div><div class="line">        return scaleValue;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    /// &lt;summary&gt;</div><div class="line">    /// 位置曲线模拟当前x轴位置</div><div class="line">    /// &lt;/summary&gt;</div><div class="line">    private float GetXPosValue(float sliderValue, float added)</div><div class="line">    &#123;</div><div class="line">        float evaluateValue = startXPos + positionCurve.Evaluate(positionCenterTime + sliderValue + added) * width;</div><div class="line">        return evaluateValue;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    /// &lt;summary&gt;</div><div class="line">    /// 计算位置动画中的时间点</div><div class="line">    /// &lt;/summary&gt;</div><div class="line">    /// &lt;param name=&quot;anga&quot;&gt;角度值,360度=1&lt;/param&gt;</div><div class="line">    /// &lt;returns&gt;&lt;/returns&gt;</div><div class="line">    private float GetCurveTimePos(float anga)</div><div class="line">    &#123;</div><div class="line">        // 设定0.5为位置中间</div><div class="line">        return Round(anga / 360f, curACC);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    // 获取项目A到项目B之间最小的时间差值（圆形角度计算,1=360度）</div><div class="line">    private float GetCurveTimeDValue(EnhanceItem itemA, EnhanceItem itemB)</div><div class="line">    &#123;</div><div class="line">        return Round((Mathf.DeltaAngle(itemA.angla, itemB.angla)) / 360f, curACC);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    private void SortDepth()</div><div class="line">    &#123;</div><div class="line">        textureTargets.Sort(new CompareDepthMethod());</div><div class="line">        for (int i = 0; i &lt; textureTargets.Count; i++)</div><div class="line">            textureTargets[i].depth = i;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    /// &lt;summary&gt;</div><div class="line">    /// 用于层级对比接口</div><div class="line">    /// &lt;/summary&gt;</div><div class="line">    private class CompareDepthMethod : IComparer&lt;UITexture&gt;</div><div class="line">    &#123;</div><div class="line">        public int Compare(UITexture left, UITexture right)</div><div class="line">        &#123;</div><div class="line">            if (left.transform.localScale.x &gt; right.transform.localScale.x)</div><div class="line">                return 1;</div><div class="line">            else if (left.transform.localScale.x &lt; right.transform.localScale.x)</div><div class="line">                return -1;</div><div class="line">            else</div><div class="line">                return 0;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">	//核心滚动函数</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">    /// &lt;summary&gt;</div><div class="line">    /// 设置横向轴参数，根据缩放曲线和位移曲线更新缩放和位置</div><div class="line">    /// &lt;/summary&gt;</div><div class="line"></div><div class="line">    internal void SetHorizontalTargetItemIndex(int itemIndex)</div><div class="line">    &#123;</div><div class="line">        if (isInChange)</div><div class="line">            return;</div><div class="line"></div><div class="line">        EnhanceItem item = scrollViewItems[itemIndex];//_____________新场景中根据这个来判断</div><div class="line">        if (centerItem == item)</div><div class="line">            return;</div><div class="line">		Debug.Log (&quot;item = &quot; + item.name);</div><div class="line">		if (item.name == &quot;Texture01&quot;) &#123;</div><div class="line">			//Debug.Log(&quot;YES&quot;);</div><div class="line">		&#125;</div><div class="line">//		_________________________________________________________________________________________</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">        float dvalue = centerItem == null ? 0 : GetCurveTimeDValue(centerItem, item);</div><div class="line">        // 更改target数值，平滑移动,设负数倒着转</div><div class="line">        horizontalTargetValue += -dvalue;</div><div class="line">        beginScroll(horizontalValue, horizontalTargetValue);</div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">	void FixedUpdate()</div><div class="line">	&#123;</div><div class="line">//		___________________________________________________________________________________手势swipe模块</div><div class="line">		this.currentFrame = hc.GetFrame ();</div><div class="line">		Frame frame = hc.GetFrame ();</div><div class="line">		Frame lastframe = hc.getlastframe ();</div><div class="line">		GestureList gestures = this.currentFrame.Gestures ();</div><div class="line">		Vector swipedirection=null;</div><div class="line"></div><div class="line">		foreach (Gesture g in gestures) &#123;</div><div class="line"></div><div class="line"></div><div class="line">			if(g.Type==Gesture.GestureType.TYPE_SWIPE)</div><div class="line">			&#123;</div><div class="line">				SwipeGesture swipe=new SwipeGesture(g);</div><div class="line">				swipedirection=swipe.Direction;</div><div class="line">				//Debug.Log(&quot;direction is &quot;+swipedirection);</div><div class="line"></div><div class="line">			&#125;</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">		&#125;</div><div class="line">		if (swipedirection.x &gt; 0) &#123;//判断手势向左还是向右参数向左则小于0向右则大于0</div><div class="line">			Debug.Log(&quot;right&quot;);		</div><div class="line">			mark=1;</div><div class="line">		&#125;</div><div class="line">		if (swipedirection.x &lt; 0) &#123;</div><div class="line">			Debug.Log(&quot;left&quot;);</div><div class="line">			mark=-1;</div><div class="line">		&#125;</div><div class="line"></div><div class="line"></div><div class="line">		checkmark (mark);//检查参数以完成UI的旋转</div><div class="line"></div><div class="line">//		————————————————————————————————————————————————————————————————————————————————————————————————————————————</div><div class="line">	&#125;</div><div class="line"></div><div class="line">    /// &lt;summary&gt;</div><div class="line">    /// 开始滚动</div><div class="line">    /// &lt;/summary&gt;</div><div class="line">    /// &lt;param name=&quot;startTime&quot;&gt;&lt;/param&gt;</div><div class="line">    /// &lt;param name=&quot;endTime&quot;&gt;&lt;/param&gt;</div><div class="line">    private void beginScroll(float startTime, float endTime)</div><div class="line">    &#123;</div><div class="line">        if (isInChange)</div><div class="line">            return;</div><div class="line"></div><div class="line">        foreach (EnhanceItem item in scrollViewItems)</div><div class="line">        &#123;</div><div class="line">            item.SetSelectColor(false);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        originHorizontalValue = Round(startTime, curACC);</div><div class="line">        horizontalTargetValue = Round(endTime, curACC);</div><div class="line">        currentDuration = 0.0f;</div><div class="line"></div><div class="line">        isInChange = true;</div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line">    /// &lt;summary&gt;</div><div class="line">    /// 向右选择角色按钮</div><div class="line">    /// &lt;/summary&gt;</div><div class="line">    public void OnBtnRightClick()</div><div class="line">    &#123;</div><div class="line">        if (isInChange)</div><div class="line">            return;</div><div class="line">        SetHorizontalTargetItemIndex(centerItem.back.scrollViewItemIndex);</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    /// &lt;summary&gt;</div><div class="line">    /// 向左选择按钮</div><div class="line">    /// &lt;/summary&gt;</div><div class="line">    public void OnBtnLeftClick()</div><div class="line">    &#123;</div><div class="line">        if (isInChange)</div><div class="line">            return;</div><div class="line">        SetHorizontalTargetItemIndex(centerItem.front.scrollViewItemIndex);</div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">    /// &lt;summary&gt;</div><div class="line">    /// 获取移动后的项目索引</div><div class="line">    /// &lt;/summary&gt;</div><div class="line">    /// &lt;param name=&quot;item&quot;&gt;当前项目&lt;/param&gt;</div><div class="line">    /// &lt;param name=&quot;count&quot;&gt;移动位数，负数表示倒移&lt;/param&gt;</div><div class="line">    /// &lt;returns&gt;&lt;/returns&gt;</div><div class="line">    private int GetMoveIndex(EnhanceItem item, int count)</div><div class="line">    &#123;</div><div class="line">        EnhanceItem curItem = item;</div><div class="line">        for (int i = 0; i &lt; Mathf.Abs(count); i++)</div><div class="line">        &#123;</div><div class="line">            curItem = count &gt; 0 ? curItem.back : curItem.front;</div><div class="line"></div><div class="line">        &#125;</div><div class="line"></div><div class="line">        return curItem.scrollViewItemIndex;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    /// &lt;summary&gt;</div><div class="line">    /// 按指定小数位舍入</div><div class="line">    /// &lt;/summary&gt;</div><div class="line">    /// &lt;param name=&quot;f&quot;&gt;&lt;/param&gt;</div><div class="line">    /// &lt;param name=&quot;acc&quot;&gt;&lt;/param&gt;</div><div class="line">    /// &lt;returns&gt;&lt;/returns&gt;</div><div class="line">    private float Round(float f, int acc)</div><div class="line">    &#123;</div><div class="line">        float temp = f * Mathf.Pow(10, acc);</div><div class="line">        return Mathf.Round(temp) / Mathf.Pow(10, acc);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    /// &lt;summary&gt;</div><div class="line">    /// 截取小数</div><div class="line">    /// &lt;/summary&gt;</div><div class="line">    /// &lt;param name=&quot;f&quot;&gt;&lt;/param&gt;</div><div class="line">    /// &lt;returns&gt;&lt;/returns&gt;</div><div class="line">    private float CutDecimal(float f) &#123;</div><div class="line">        return f - (int)f;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>以缩放曲线来决定  元素在位置发生转动后 大小的变化规则<br>以位移曲线来规定 元素的运动位置轨迹<br>两条曲线分别为：<br><img src="http://img.blog.csdn.net/20160518164452635" alt="scale"><img src="http://img.blog.csdn.net/20160518164514982" alt="position"></p>
<p>可见一个小功能的实现竟然用了500+line<br>虽然不难  但是这个排除bug  保证逻辑正确的过程是在太令人头疼  构造环形链的代码也比较抽象</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">scrollViewItems = new List&lt;EnhanceItem&gt;();</div><div class="line">scrollViewItems.AddRange(enhanceScrollView.GetComponentsInChildren&lt;EnhanceItem&gt;());</div></pre></td></tr></table></figure>
<p>而之后的代码将手势识别的代码也包括进去了  主要思路就是判断挥动手势的方向  根据这个参数来确定UItexture整体转动的方向  </p>
<p>至此我们的这个类型的UI代码讲解也结束了<br>总结一下手势控制类UI：</p>
<blockquote>
<p>1，此类UI构建方式和普通UI区别较小（几乎没区别）无论是平面，立体。<br>2，此类UI的控制方式最好生成一个统一的操作函数例如turnleft(),turnright();之后直接用手势触发就好<br>3，如果使用单一手势触发的话最好设置一定的时延  否则 误操作将会非常多</p>
</blockquote>
<h1 id="最后"><a href="#最后" class="headerlink" title="最后"></a>最后</h1><p>也就是这个系列的最后一些内容<br>我来讲讲印射式UI（或者说印射操作）</p>
<p>这里用到的就是</p>
<h3 id="射线"><a href="#射线" class="headerlink" title="射线"></a>射线</h3><p>leap和射线可以说是非常蛋疼的组合  我本身对这个功能的探索时间长达一个月<br>我就细细说一下这个奇葩的功能的由来：</p>
<h4 id="首先"><a href="#首先" class="headerlink" title="首先"></a>首先</h4><p>面对一个模型我们想把它散开  再在每个子物体上加上盒触发器  这种算法在unity里简直好像一坨屎<br>结果就如下图：<br><img src="http://img.blog.csdn.net/20160518171954133" alt="这里写图片描述"><br>boxcollider不能很好的契合模型<br>Meshcollider又因为面数限制而不能使用<br>那只能用box凑活了  这就导致一个问题用手来触发这一坨屎一样的东西自然是很不精确的<br>并且一旦触及百万面的工业模型  性能就迅速下降到崩溃边缘：</p>
<hr>
<p><img src="http://img.blog.csdn.net/20160518172424139" alt="这里写图片描述"></p>
<hr>
<p>像这样  于是我们怎么才能解决这个精确触发的问题呢？这是问题一</p>
<h1 id="其二"><a href="#其二" class="headerlink" title="其二"></a><strong>其二</strong></h1><p>leapmotion的手的大小和识别区域是绑定的  所以放大识别区域的结果是必然要放大手的模型<br>比如我想增大在空间内控制器的操作范围就会产生这种画面<br><img src="http://img.blog.csdn.net/20160518172803520" alt="hand"></p>
<hr>
<p>手的模型变大严重阻碍了软件的使用，所以又要保证手的大小适中作指示<br>而手的操作范围被限制在控制器识别范围之内。这就诞生了一个设计上的矛盾。<br>画面上要求手变小  操作范围上要求手变大。<br>于是<br>就有了<strong>射线</strong></p>
<p>初次写射线功能其实和leap并不能很好的一起工作，因为有太多的隐含参数数值需要去探索</p>
<p><img src="http://img.blog.csdn.net/20160518173715723" alt="ray"></p>
<hr>
<p>用这种方法可以进行精确化的触发，选择。在这个基础上进行设计可以很多leap官方demo完成不了的操作<br>那下面我们先来看看代码  这个脚本挂camera上</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div></pre></td><td class="code"><pre><div class="line">using UnityEngine;</div><div class="line">using System.Collections;</div><div class="line">using Leap;</div><div class="line">public class ray : MonoBehaviour &#123;</div><div class="line">	public hand_script2 control_script;//控制脚本定义</div><div class="line">	public HandController hc=null;</div><div class="line">	public RaycastHit hit;</div><div class="line">	public Vector3 handdir;</div><div class="line">	public Vector3 handpos;</div><div class="line">	//public GameObject cube = null;</div><div class="line">	public GameObject highlight=null;</div><div class="line"></div><div class="line">	float hx, hy, hz=0;</div><div class="line">	float dx, dy, dz = 0;</div><div class="line">	public GameObject particle_light=null;</div><div class="line">	float xr,yr,zr;</div><div class="line">	private float index=0;</div><div class="line">	Hand lefthand=null;</div><div class="line">	Hand righthand=null;</div><div class="line"></div><div class="line"></div><div class="line">	public GameObject color_apply=null;</div><div class="line"></div><div class="line">	Color origin=Color.black;</div><div class="line">	public Color apply_color;</div><div class="line"></div><div class="line"></div><div class="line">//	______________________________________________________________</div><div class="line">	bool squize(float radius)//判断手势是否为握持  阀值为35</div><div class="line">	&#123;</div><div class="line">		if (radius &lt; 37)</div><div class="line">			return true;</div><div class="line">		else</div><div class="line">			return false;</div><div class="line">	&#125;</div><div class="line">//	---------------------------------------------------------------------------</div><div class="line">	private bool IsHand(Collider collider)</div><div class="line">	&#123;</div><div class="line">		return collider.transform.parent &amp;&amp; collider.transform.parent.parent &amp;&amp; collider.transform.parent.parent.GetComponent&lt;HandModel&gt;();</div><div class="line">	&#125;//判断触发器是否是手</div><div class="line"></div><div class="line"></div><div class="line">	void Awake()</div><div class="line">	&#123;</div><div class="line"></div><div class="line">	&#125;</div><div class="line"></div><div class="line"></div><div class="line">	// Use this for initialization</div><div class="line">	void Start () &#123;</div><div class="line">		Debug.Log (&quot;Start&quot;);</div><div class="line">		//空间两点距离计算：sqrt(pow(x1-x2，2)+pow(y1-y2，2)+pow(z1-z2，2))</div><div class="line"></div><div class="line">		index = hc.transform.localScale.x / 1000;//计算后面的缩放指数</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">	&#125;</div><div class="line"></div><div class="line">	// Update is called once per frame</div><div class="line">	void Update () &#123;</div><div class="line">		bool lefthandexit = false;</div><div class="line">		bool righthandexit = false;</div><div class="line">		//Debug.Log (&quot;Update&quot;);</div><div class="line">		//Vector3 fwd = new Vector3 (0, 0,10 );</div><div class="line">		Frame frame = hc.GetFrame ();</div><div class="line">		Frame lastframe = hc.getlastframe ();</div><div class="line">	    apply_color = color_apply.gameObject.GetComponent&lt;RGB&gt; ().rgb;//获取color混合界面的颜色值可去掉</div><div class="line"></div><div class="line"></div><div class="line">		foreach (Hand hand in frame.Hands) &#123;</div><div class="line">			if (hand.IsLeft) &#123;</div><div class="line">				lefthandexit = true;</div><div class="line">				lefthand = hand;</div><div class="line">			&#125;</div><div class="line"></div><div class="line">			if (hand.IsRight) &#123;</div><div class="line">				righthandexit = true;</div><div class="line">				righthand = hand;</div><div class="line"></div><div class="line"></div><div class="line">				foreach (Finger finger in righthand.Fingers) &#123;</div><div class="line">					Finger.FingerType type=finger.Type();</div><div class="line">					if (type == Finger.FingerType.TYPE_INDEX) &#123;</div><div class="line">						dx = finger.Direction.x;</div><div class="line">						dy = finger.Direction.y;</div><div class="line">						dz = finger.Direction.z;</div><div class="line">						hx = finger.TipPosition.x;</div><div class="line">						hy = finger.TipPosition.y;</div><div class="line">						hz = finger.TipPosition.z;</div><div class="line">					&#125;</div><div class="line">                  //获取中指的信息finger_INDEX</div><div class="line">				&#125;</div><div class="line">				//dx = hand.Direction.x;</div><div class="line">				//dy = hand.Direction.y;</div><div class="line">				//dz = hand.Direction.z;</div><div class="line">				handdir = new Vector3 (dx*index,dy*index,-dz*index);//必须乘指数</div><div class="line"></div><div class="line">				//				----------------------------------------------------------------------</div><div class="line"></div><div class="line"></div><div class="line">				//hx = hand.PalmPosition.x;</div><div class="line">				//hy = hand.PalmPosition.y;</div><div class="line">				//hz = hand.PalmPosition.z;</div><div class="line">				handpos = new Vector3 (hx*index, hy*index,-hz*index);//同样乘指数</div><div class="line"></div><div class="line">				//				----------------------------------------------------------</div><div class="line">				//Debug.Log (&quot;righthand_position is &quot; + handpos + &quot;righthand dir is &quot; + handdir);</div><div class="line">				//Debug.Log (&quot;reall date is&quot; + hand.PalmPosition + &quot; /// &quot; + hand.Direction);</div><div class="line">				xr = hand.RotationAngle (lastframe, Vector.XAxis);</div><div class="line">				yr = hand.RotationAngle (lastframe, Vector.YAxis);</div><div class="line">				zr = hand.RotationAngle (lastframe, Vector.ZAxis);</div><div class="line"></div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">		//cube.transform.Rotate (new Vector3(xr*index,yr*index,-zr*index),Space.World);</div><div class="line"></div><div class="line">        //原先用cube表示手的信息与射线做对照</div><div class="line">		/*</div><div class="line">		float x = this.transform.rotation.x;</div><div class="line">		float y = this.transform.rotation.y;</div><div class="line">		float z = this.transform.rotation.z;</div><div class="line">		Vector3 rota = new Vector3 (x, y, z);</div><div class="line">		Debug.Log (&quot;this.position=&quot; + this.transform.position);</div><div class="line">		dx = this.transform.position.x;</div><div class="line">		dy = this.transform.position.y;</div><div class="line">		dz = this.transform.position.z;</div><div class="line">		Vector3 position = new Vector3 (dx,dy+100,dz);</div><div class="line"></div><div class="line">   */</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">		if (squize(lefthand.SphereRadius) &amp;&amp; (!squize (righthand.SphereRadius))) &#123;</div><div class="line">		//如果左手握持且右手不握持</div><div class="line">		//bool Physics.Raycast(Ray ray, Vector3 direction, RaycastHit out hit, float distance, int layerMask)</div><div class="line">		if (Physics.Raycast(handpos,handdir,out hit,10000,1)) &#123;</div><div class="line">         //(Physics.Raycast(射出点,射出方向向量,输出触发信息存储点,长度,1))</div><div class="line">			particle_light.transform.position =new Vector3(hit.point.x,hit.point.y,hit.point.z-2);//此处为粒子系统  用粒子系统跟随触发点以显示触发位置</div><div class="line"></div><div class="line"></div><div class="line">				if ((highlight.gameObject.name.ToString() != hit.collider.gameObject.name.ToString()) &amp;&amp;</div><div class="line">					origin == Color.black&amp;&amp;</div><div class="line">					(!IsHand(hit.collider))&amp;&amp;</div><div class="line">					(hit.collider.gameObject.GetComponent&lt;Renderer&gt;()!=null)) &#123;</div><div class="line">              //判断是否第一次触发</div><div class="line"></div><div class="line">				Debug.Log (&quot;first&quot;);</div><div class="line">				highlight = hit.collider.gameObject;</div><div class="line">				control_script.main_son = hit.collider.gameObject;</div><div class="line"></div><div class="line">				origin = highlight.gameObject.GetComponent&lt;Renderer&gt; ().material.color;</div><div class="line">				highlight.gameObject.GetComponent&lt;Renderer&gt; ().material.color = Color.gray;</div><div class="line"></div><div class="line"></div><div class="line">				&#125;</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">				if ((highlight.gameObject.name.ToString () != hit.collider.gameObject.name.ToString ()) &amp;&amp;</div><div class="line">					origin != Color.black&amp;&amp;</div><div class="line">					(!IsHand(hit.collider))&amp;&amp;</div><div class="line">					((hit.collider.gameObject.GetComponent&lt;Renderer&gt;()!=null)))	&#123;</div><div class="line">					//判断是否变更触发物体</div><div class="line">				Debug.Log (&quot;change&quot;);</div><div class="line">				control_script.main_son = hit.collider.gameObject;</div><div class="line"></div><div class="line">				highlight.gameObject.GetComponent&lt;Renderer&gt; ().material.color = origin;</div><div class="line">				highlight = hit.collider.gameObject;</div><div class="line">				origin = highlight.gameObject.GetComponent&lt;Renderer&gt; ().material.color;</div><div class="line">				highlight.gameObject.GetComponent&lt;Renderer&gt; ().material.color = Color.gray;</div><div class="line">			&#125;</div><div class="line"></div><div class="line">//以上用来交换信息  坐到触发高亮</div><div class="line"></div><div class="line">			/*</div><div class="line">			if((highlight.gameObject.name.ToString()==hit.collider.gameObject.name.ToString())&amp;&amp;origin!=Color.black)</div><div class="line">			&#123;</div><div class="line">				highlight = hit.collider.gameObject;</div><div class="line">				highlight.gameObject.GetComponent&lt;Renderer&gt; ().material.color = Color.red;</div><div class="line">			&#125;</div><div class="line">			*/</div><div class="line"></div><div class="line"></div><div class="line">			//hit.collider.gameObject.GetComponent&lt;Renderer&gt; ().material.color = Color.red;</div><div class="line">			Debug.Log (&quot;OBJ-name is &quot; + hit.collider.gameObject);</div><div class="line">			//Debug.Log (&quot;hit point is &quot; + hit.point + &quot; distance = &quot; + hit.distance);</div><div class="line">			//Debug.Log (&quot;Success&quot;);</div><div class="line">			Debug.DrawLine (handpos, hit.point, Color.red);</div><div class="line">			//在sence中显示射线并设置为红色</div><div class="line">				//Debug.Break ();</div><div class="line"></div><div class="line">		&#125;</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">		if (lefthandexit==true) &#123;</div><div class="line">			Debug.Log (&quot;________________&quot;);</div><div class="line">			//Debug.Break();</div><div class="line">		&#125;</div><div class="line"></div><div class="line">	&#125;</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">	//射线脚本bug汇总：</div><div class="line">	/*</div><div class="line">	 * 1.发射点以世界坐标为准则：</div><div class="line">	 * 如handcontroller的放大倍率为100则数乘index指数为0.1</div><div class="line">	 * 2.必须将控制器的位置考虑进去</div><div class="line">	 * 3.射线距离尽可能大</div><div class="line">	 */</div></pre></td></tr></table></figure>
<p>脚本毕来说一些特殊的地方<br>那些隐含的值最后确定为</p>
<blockquote>
<p>index = hc.transform.localScale.x / 1000;//计算后面的缩放指数</p>
</blockquote>
<p>而以上都基于 控制器在原点也就是（0，0，0）<br>而针对 非原点的情况  </p>
<h2 id="要把控制器的坐标也算进去才能保证你的射线是从指尖发出去的"><a href="#要把控制器的坐标也算进去才能保证你的射线是从指尖发出去的" class="headerlink" title="要把控制器的坐标也算进去才能保证你的射线是从指尖发出去的"></a>要把控制器的坐标也算进去才能保证你的射线是从指尖发出去的</h2><p>如果想更改射线发射的位置  那么判断进其他的手指类型就好了  代码里面非常清楚</p>
<p>同时  在射线的位置用一个粒子特效做一个触发位置提示  效果像这样</p>
<hr>
<p><img src="http://img.blog.csdn.net/20160518181646115" alt="light"></p>
<hr>
<p>在这个体系之下  你就可以把手指当做一个三维环境里的鼠标  对任意一个点进行触发操作以进一步的执行其他部分</p>
<p>所以我们的触发UI可以不用再设计在控制器的范围之内  我们可以用射线功能触发几乎无限远的元素</p>
<p>比如在一个环境中我们通过一定映射关系去触发区域之外的按钮<br>    <img src="http://img.blog.csdn.net/20160518182537164" alt="不同"><br>如图所示</p>
<hr>
<h1 id="至此-1"><a href="#至此-1" class="headerlink" title="至此"></a>至此</h1><p>所有LeapUI设计专题所有内容都讲完了<br>洋洋洒洒的九万多字<br>再次：</p>
<blockquote>
<p>本人水平有限,有错误请联系qq：785929784<br>也欢迎有兴趣的开发者加入qq群：343074971<br>共同交流共同进步。</p>
</blockquote>
<p>感谢群友对本博客的支持</p>
<p>后续将更新</p>
<p>欢迎支持</p>

      
    </div>
    <footer class="article-footer">
      
      
        
	<div id="comment">
		<!-- 来必力City版安装代码 -->
		<div id="lv-container" data-id="city" data-uid="MTAyMC8yOTQ4MS82MDQ5">
		<script type="text/javascript">
		   (function(d, s) {
		       var j, e = d.getElementsByTagName(s)[0];

		       if (typeof LivereTower === 'function') { return; }

		       j = d.createElement(s);
		       j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
		       j.async = true;

		       e.parentNode.insertBefore(j, e);
		   })(document, 'script');
		</script>
		<noscript>为正常使用来必力评论功能请激活JavaScript</noscript>
		</div>
		<!-- City版安装代码已完成 -->
	</div>



      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Gesture-tracking/">Gesture tracking</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2017/05/06/Video/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">上一篇</strong>
      <div class="article-nav-title">
        
          Media Support
        
      </div>
    </a>
  
  
    <a href="/2017/05/06/《Unity Shader 与 计算机图形学》第一章/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">下一篇</strong>
      <div class="article-nav-title">unity &amp; Computer graphics Chapter(1)</div>
    </a>
  
</nav>

  
</article>

<!-- Table of Contents -->

  <aside id="toc-sidebar">
    <div id="toc" class="toc-article">
    <strong class="toc-title">文章目录</strong>
    
        <ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#本系列文章将会从一个初学者的脚步去讲解unity和leapmotion协同开发的一系列问题："><span class="nav-number">1.</span> <span class="nav-text">本系列文章将会从一个初学者的脚步去讲解unity和leapmotion协同开发的一系列问题：</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#第一部分基-基础"><span class="nav-number"></span> <span class="nav-text">第一部分基-基础</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#first-基础"><span class="nav-number"></span> <span class="nav-text">first  基础</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Now，just-do-it"><span class="nav-number"></span> <span class="nav-text">Now，just do it.</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#第二部分：环境搭建"><span class="nav-number">1.</span> <span class="nav-text">第二部分：环境搭建</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#1，核心组件的使用。"><span class="nav-number"></span> <span class="nav-text">1，核心组件的使用。</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#（1）-handcontroller（以下简化为hc）"><span class="nav-number"></span> <span class="nav-text">（1）.handcontroller（以下简化为hc）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#（2）-SCENCE"><span class="nav-number"></span> <span class="nav-text">（2）.SCENCE</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#本周着重开始讲解leap开发中的实际问题"><span class="nav-number">1.</span> <span class="nav-text">本周着重开始讲解leap开发中的实际问题</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#（其中值得注意的是：-swipe-和keytap这两个手势互相干扰非常严重-所以我们需要注意-这两个预制手势的共同使用是相当糟糕的）"><span class="nav-number">1.1.</span> <span class="nav-text">（其中值得注意的是：  swipe 和keytap这两个手势互相干扰非常严重  所以我们需要注意  这两个预制手势的共同使用是相当糟糕的）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#本周-我们着重将讲解代码的优化问题"><span class="nav-number">1.2.</span> <span class="nav-text">本周  我们着重将讲解代码的优化问题</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#第一点："><span class="nav-number">2.</span> <span class="nav-text">第一点：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#第二点："><span class="nav-number">3.</span> <span class="nav-text">第二点：</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#awake"><span class="nav-number">3.1.</span> <span class="nav-text">awake</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#第三点-："><span class="nav-number">4.</span> <span class="nav-text">第三点 ：</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#触发网格"><span class="nav-number">4.1.</span> <span class="nav-text">触发网格</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#第三点："><span class="nav-number">5.</span> <span class="nav-text">第三点：</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#UI"><span class="nav-number">5.1.</span> <span class="nav-text">UI</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#第四点："><span class="nav-number">6.</span> <span class="nav-text">第四点：</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#缩放手势"><span class="nav-number">6.1.</span> <span class="nav-text">缩放手势</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#最后："><span class="nav-number"></span> <span class="nav-text">最后：</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#很"><span class="nav-number"></span> <span class="nav-text">很</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1，触发式操作"><span class="nav-number">1.</span> <span class="nav-text">1，触发式操作</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2，手势操作（下一期）"><span class="nav-number">2.</span> <span class="nav-text">2，手势操作（下一期）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3，映射性操作（下一期）"><span class="nav-number">3.</span> <span class="nav-text">3，映射性操作（下一期）</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#预警：这篇文章very-very-long"><span class="nav-number"></span> <span class="nav-text">预警：这篇文章very very long~~</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#入门："><span class="nav-number"></span> <span class="nav-text">入门：</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#SENCES"><span class="nav-number"></span> <span class="nav-text">SENCES</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#当我们把这四种prefab拖入场景加以调整"><span class="nav-number">1.</span> <span class="nav-text">当我们把这四种prefab拖入场景加以调整</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-最简单的scrolltext-可滑动的字体"><span class="nav-number">2.</span> <span class="nav-text">1.最简单的scrolltext\可滑动的字体</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#2-按钮"><span class="nav-number"></span> <span class="nav-text">2.按钮</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#自定义按钮样式替换元素-gt-继承以重用脚本设计-gt-自定义触发操作-gt-完成"><span class="nav-number">1.</span> <span class="nav-text">自定义按钮样式替换元素 ->继承以重用脚本设计->自定义触发操作->完成</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#总结："><span class="nav-number"></span> <span class="nav-text">总结：</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#3-滑动条（slider）"><span class="nav-number"></span> <span class="nav-text">3.滑动条（slider）</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#滚轮-表盘（Dial）"><span class="nav-number"></span> <span class="nav-text">滚轮/表盘（Dial）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#从这开始就开始有意思了起来"><span class="nav-number">1.</span> <span class="nav-text">从这开始就开始有意思了起来</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#比较有趣"><span class="nav-number">1.1.</span> <span class="nav-text">比较有趣</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#至此"><span class="nav-number"></span> <span class="nav-text">至此</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Bye-See-you-next-month"><span class="nav-number"></span> <span class="nav-text">Bye~ See you next month~</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#过了这么久才来更这篇实在是因为项目工程量实在是不允许"><span class="nav-number">1.</span> <span class="nav-text">过了这么久才来更这篇实在是因为项目工程量实在是不允许</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#OK"><span class="nav-number"></span> <span class="nav-text">OK~</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#所以"><span class="nav-number">1.</span> <span class="nav-text">所以</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#最后"><span class="nav-number"></span> <span class="nav-text">最后</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#射线"><span class="nav-number">1.</span> <span class="nav-text">射线</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#首先"><span class="nav-number">1.1.</span> <span class="nav-text">首先</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#其二"><span class="nav-number"></span> <span class="nav-text">其二</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#要把控制器的坐标也算进去才能保证你的射线是从指尖发出去的"><span class="nav-number"></span> <span class="nav-text">要把控制器的坐标也算进去才能保证你的射线是从指尖发出去的</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#至此-1"><span class="nav-number"></span> <span class="nav-text">至此</span></a>
    
    </div>
  </aside>
</section>
        
      </div>
      
      <footer id="footer">
  

  <div class="container">
      	<div class="row">
	      <p> Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/iTimeTraveler/hexo-theme-hiker" target="_blank">Hexo-theme-hiker</a> </p>
	      <p id="copyRightEn">Copyright &copy; 2013 - 2017 Winshare All Rights Reserved.</p>
	      
	      
    		<p class="busuanzi_uv">
				访客数 : <span id="busuanzi_value_site_uv"></span> |  
				访问量 : <span id="busuanzi_value_site_pv"></span>
		    </p>
  		   
		</div>

		
  </div>
</footer>


<!-- min height -->

<script>
    var wrapdiv = document.getElementById("wrap");
    var contentdiv = document.getElementById("content");
    var allheader = document.getElementById("allheader");

    wrapdiv.style.minHeight = document.body.offsetHeight + "px";
    if (allheader != null) {
      contentdiv.style.minHeight = document.body.offsetHeight - allheader.offsetHeight - document.getElementById("footer").offsetHeight + "px";
    } else {
      contentdiv.style.minHeight = document.body.offsetHeight - document.getElementById("footer").offsetHeight + "px";
    }
</script>
    </div>
    <!-- <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/categories" class="mobile-nav-link">Categories</a>
  
    <a href="/tags" class="mobile-nav-link">Tags</a>
  
    <a href="/about" class="mobile-nav-link">About</a>
  
</nav> -->
    

<!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/scripts.js"></script>




  <script src="/js/dialog.js"></script>



<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', '98667296', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->







	<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
	</script>






  </div>

  <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display: none;">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h2 class="modal-title" id="myModalLabel">设置</h2>
      </div>
      <hr style="margin-top:0px; margin-bottom:0px; width:80%; border-top: 3px solid #000;">
      <hr style="margin-top:2px; margin-bottom:0px; width:80%; border-top: 1px solid #000;">


      <div class="modal-body">
          <div style="margin:6px;">
            <a data-toggle="collapse" data-parent="#accordion" href="#collapseOne" onclick="javascript:setFontSize();" aria-expanded="true" aria-controls="collapseOne">
              正文字号大小
            </a>
          </div>
          <div id="collapseOne" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingOne">
          <div class="panel-body">
            您已调整页面字体大小
          </div>
        </div>
      


          <div style="margin:6px;">
            <a data-toggle="collapse" data-parent="#accordion" href="#collapseTwo" onclick="javascript:setBackground();" aria-expanded="true" aria-controls="collapseTwo">
              夜间护眼模式
            </a>
        </div>
          <div id="collapseTwo" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingTwo">
          <div class="panel-body">
            夜间模式已经开启，再次单击按钮即可关闭 
          </div>
        </div>

        <div>
            <a data-toggle="collapse" data-parent="#accordion" href="#collapseThree" aria-expanded="true" aria-controls="collapseThree">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;关 于&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</a>
        </div>
         <div id="collapseThree" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingThree">
          <div class="panel-body">
            Winshare
          </div>
          <div class="panel-body">
            Copyright © 2017 Tom winshare All Rights Reserved.
          </div>
        </div>
      </div>


      <hr style="margin-top:0px; margin-bottom:0px; width:80%; border-top: 1px solid #000;">
      <hr style="margin-top:2px; margin-bottom:0px; width:80%; border-top: 3px solid #000;">
      <div class="modal-footer">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
      </div>
    </div>
  </div>
</div>
  
  <a id="rocket" href="#top" class=""></a>
  <script type="text/javascript" src="/js/totop.js?v=1.0.0" async=""></script>
  
    <a id="menu-switch"><i class="fa fa-bars fa-lg"></i></a>
  
</body>
</html>